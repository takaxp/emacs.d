<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2018-09-10 Mon 15:04 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Configurations for GNU Emacs</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Takaaki Ishikawa" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Configurations for GNU Emacs</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org4b055bf">1. はじめに</a></li>
<li><a href="#org9c3a72a">2. 基本設定</a>
<ul>
<li><a href="#orgb6abcb0">2.1. init.el のヘッダ</a></li>
<li><a href="#org695db2c">2.2. init ファイルの読み込み時間計測</a>
<ul>
<li><a href="#org64ded1d">2.2.1. Emacs 起動時の呼び出し順</a></li>
</ul>
</li>
<li><a href="#orgf844d32">2.3. 起動時間の計測</a></li>
<li><a href="#org0265e3f">2.4. GCサイズの最適化</a></li>
<li><a href="#org649eb81">2.5. [exec-path-from-shell] PATH設定をシェルから継承する</a></li>
<li><a href="#org9e2440a">2.6. cl を使う</a></li>
<li><a href="#org98718f9">2.7. [load-package-p] 設定の読み込みフラグを確認する</a></li>
<li><a href="#org98d66f7">2.8. リストで関数を渡す autoload-if-found を使う</a></li>
<li><a href="#orgae52377">2.9. [eval-after-autoload-if-found] 複数関数を対象とする遅延読み込み</a>
<ul>
<li><a href="#orgdd2c070">2.9.1. 関数版</a></li>
<li><a href="#orgb968401">2.9.2. マクロ版</a></li>
</ul>
</li>
<li><a href="#org169e34f">2.10. [library-p] load-path にライブラリがあるかを判定</a></li>
<li><a href="#orgcd69966">2.11. [passed-clock-p] 指定時刻が本日の未来の時刻かを判定</a></li>
<li><a href="#org81ab464">2.12. [input-focus-p] フォーカス判定</a></li>
<li><a href="#org3979ddd">2.13. 警告の抑制</a></li>
<li><a href="#org733621f">2.14. エラー表示の抑制</a></li>
<li><a href="#org0108e96">2.15. compilation buffer でのデータ表示で自動するスクロールする</a></li>
<li><a href="#org884a11e">2.16. C-x C-c で容易にEmacsを終了させないように質問する</a></li>
<li><a href="#org77b0b47">2.17. [shut-up.el] Messages 出力を封じる（制御する）</a></li>
<li><a href="#orga6e655b">2.18. エンターキーの挙動</a></li>
<li><a href="#org5969dae">2.19. コマンド入力中に入力過程をミニバッファに反映する</a></li>
</ul>
</li>
<li><a href="#orga43d888">3. コア設定</a>
<ul>
<li><a href="#org4ed8d78">3.1. 言語／文字コード</a></li>
<li><a href="#org00714c5">3.2. 日本語入力</a></li>
<li><a href="#org9f59eb1">3.3. [ag.el] 検索</a></li>
<li><a href="#orgd39b233">3.4. 基本キーバインド</a></li>
<li><a href="#orgcd3600b">3.5. ナローイングするか</a></li>
<li><a href="#org1a6a047">3.6. バッファの終わりでのnewlineを禁止する</a></li>
<li><a href="#org7e8d1b9">3.7. 常に最終行に一行追加する</a></li>
<li><a href="#org423af91">3.8. 長い文章を右端で常に折り返す</a></li>
<li><a href="#org53b71e7">3.9. バッファが外部から編集された場合に自動で再読み込みする</a></li>
<li><a href="#org31e91fd">3.10. [uniquify.el] 同じバッファ名が開かれた場合に区別する</a></li>
<li><a href="#org0d44efe">3.11. マウスで選択した領域を自動コピー</a></li>
<li><a href="#org901ec2d">3.12. マウススクロールをピクセル単位にする</a></li>
<li><a href="#orgca5dbb8">3.13. パッケージ管理</a>
<ul>
<li><a href="#org983ddba">3.13.1. [cask-mode.el] モード設定</a></li>
<li><a href="#org2906581">3.13.2. Cask のセットアップ</a></li>
<li><a href="#org4e5abdf">3.13.3. load-path を一箇所にして起動を高速化</a></li>
<li><a href="#orgb6bdc16">3.13.4. [paradox.el] パッケージ選択画面の改善</a></li>
</ul>
</li>
<li><a href="#org207097e">3.14. インデント</a></li>
<li><a href="#org14c7a16">3.15. [aggressive-indent] 即時バッファ整形</a></li>
<li><a href="#orgbd41594">3.16. [ws-butler.el] 不要なスペースを自動除去</a></li>
<li><a href="#org0f62eb7">3.17. ファイルリンクを辿る時に確認のメッセージを出さない</a></li>
<li><a href="#org3567b01">3.18. EMPビルド用設定</a></li>
<li><a href="#orgfcf9121">3.19. NSビルド用設定&#xa0;&#xa0;&#xa0;<span class="tag"><span class="Mac">Mac</span></span></a></li>
</ul>
</li>
<li><a href="#orgbadb001">4. カーソル移動</a>
<ul>
<li><a href="#orgfcf90ff">4.1. バッファ内のカーソル移動</a></li>
<li><a href="#org0a95286">4.2. バッファ間のカーソル移動</a></li>
<li><a href="#org528d9de">4.3. スクロールを制御</a></li>
<li><a href="#org58508dd">4.4. スクロールで表示を重複させる行数</a></li>
<li><a href="#org0c14277">4.5. [SmoothScroll.el] カーソル固定でスクロールする</a></li>
<li><a href="#org14d485f">4.6. [smooth-scroll.el] 滑らかなスクロール</a></li>
<li><a href="#orgb84d59c">4.7. [point-undo.el] カーソル位置を簡単にたどる</a></li>
<li><a href="#org4f7e2ae">4.8. [cycle-buffer.el] カレントバッファの表示切り替え</a></li>
<li><a href="#org6b9d866">4.9. [bm.el] カーソル位置をブックマークして追う</a></li>
<li><a href="#org7746526">4.10. [centered-cursor-mode.el] カーソル位置をバッファ中央に固定</a></li>
<li><a href="#org2e7c704">4.11. [back-button] マークをたどる</a></li>
<li><a href="#orgcc64545">4.12. [smart-mark] C-g後に元の場所へカーソルを戻す</a></li>
<li><a href="#org19cf18b">4.13. [syntax-subword.el] M-f で移動する位置をより密にする</a></li>
<li><a href="#org4f4b19c">4.14. [goto-chg.el] 編集箇所を簡単に辿る</a></li>
</ul>
</li>
<li><a href="#orga08af59">5. 編集サポート</a>
<ul>
<li><a href="#org9d80f0d">5.1. 矩形編集／連番入力</a></li>
<li><a href="#org562364b">5.2. Yank時に装飾を取る</a></li>
<li><a href="#orge739644">5.3. ファイル保存時に時間を記録する</a></li>
<li><a href="#org9dda8b5">5.4. 選択リージョンを使って検索</a></li>
<li><a href="#org08725ca">5.5. ChangeLog モード</a></li>
<li><a href="#org108b026">5.6. テキストモード</a></li>
<li><a href="#orgc4984a3">5.7. C/C++モード</a></li>
<li><a href="#org2fa9fa0">5.8. C#モード</a></li>
<li><a href="#org3201727">5.9. Infoモード</a></li>
<li><a href="#orgbe24559">5.10. Rモード</a></li>
<li><a href="#orgf407d0d">5.11. nXMLモード</a></li>
<li><a href="#orga4894bc">5.12. yamlモード</a></li>
<li><a href="#orgf1bdc3d">5.13. jsonモード</a></li>
<li><a href="#orgd754418">5.14. javascriptモード</a></li>
<li><a href="#org7ce57cd">5.15. csvモード</a></li>
<li><a href="#org5b030fb">5.16. asciiモード</a></li>
<li><a href="#orga86b1a2">5.17. javaモード</a></li>
<li><a href="#org1007c12">5.18. esモード</a></li>
<li><a href="#org4f03e24">5.19. gnuplotモード</a></li>
<li><a href="#orgce7822c">5.20. markdown-mode</a></li>
<li><a href="#org3b44f3b">5.21. cmakeモード</a></li>
<li><a href="#orgbee5598">5.22. スペルチェック</a></li>
<li><a href="#org73daad0">5.23. リアルタイムスペルチェック</a></li>
<li><a href="#org82c41b1">5.24. [latex-math-preview.el] TeX数式をプレビュー</a></li>
<li><a href="#orgafef3d3">5.25. [po-mode.el] 翻訳ファイルの編集</a></li>
<li><a href="#org64120a0">5.26. [word-count.el] リージョン内の文字をカウントする</a></li>
<li><a href="#orga1cafe7">5.27. [yatex.el] YaTeXモード</a></li>
<li><a href="#org98c7e9e">5.28. [auxtex.el] AUCTEXモード</a></li>
<li><a href="#orga36f537">5.29. [display-time-world-mode] 世界時計</a></li>
<li><a href="#orgc244b8b">5.30. [yasnippet.el] Emacs用のテンプレートシステム</a></li>
<li><a href="#orgf2688a1">5.31. [sdic.el] 英辞郎で英単語を調べる</a></li>
<li><a href="#org039db45">5.32. [osx-dictionary.el] MacOSのdictionary.appで辞書をひく</a>
<ul>
<li><a href="#org62e7526">5.32.1. MacOSのdictionary.appでCOBUILD5の辞書をひく（旧）</a></li>
</ul>
</li>
<li><a href="#org1fd59fb">5.33. [lookup.el] 辞書</a></li>
<li><a href="#org549c0f1">5.34. [cacoo] Cacoo で描く</a></li>
<li><a href="#org8fd4b2b">5.35. [iedit] バッファ内の同じ文字列を一度に編集する</a></li>
<li><a href="#org1f7ac0d">5.36. [web-mode] HTML編集</a></li>
<li><a href="#org1bf9410">5.37. [emmet-mode] zencoding の後継</a></li>
<li><a href="#org3ccce95">5.38. [zencoding-mode] HTML編集の高速化（旧）</a></li>
<li><a href="#org54fa465">5.39. [describe-number] 16進数などを確認</a></li>
<li><a href="#orgfb25de2">5.40. [web-beautify.el] ソースコード整形</a></li>
<li><a href="#orgd0956dd">5.41. [smartparens.el] 対応するカッコの挿入をアシスト</a></li>
<li><a href="#org7fd606d">5.42. <span class="todo TODO">TODO</span> [isolate.el] ブラケット等の入力をアシスト</a></li>
<li><a href="#org96b0073">5.43. [replace-from-region.el] 選択領域を別の文字列に置き換える</a></li>
<li><a href="#org8e1b3ca">5.44. [selected.el] リージョン選択時のアクションを制御&#xa0;&#xa0;&#xa0;<span class="tag"><span class="Doing">Doing</span></span></a></li>
<li><a href="#org9c30a84">5.45. [helm-selected.el] selecte.el のアクション候補を絞り込み</a></li>
<li><a href="#orgaba6d27">5.46. <span class="todo TODO">TODO</span> [git-complete.el] GIT grep を使う補完エンジン</a></li>
<li><a href="#org2314d1c">5.47. <span class="todo TODO">TODO</span> [tiny.el] 連番入力をサポート</a></li>
<li><a href="#orgb14aa66">5.48. <span class="todo TODO">TODO</span> [bratex] LaTeX 数式のブラケット入力をサポート</a></li>
</ul>
</li>
<li><a href="#org70bc6ef">6. 表示サポート</a>
<ul>
<li><a href="#org046ddbf">6.1. モードラインのモード名を短くする</a></li>
<li><a href="#org8b96965">6.2. 続・モードラインのモード名を短縮する</a></li>
<li><a href="#orgf00da0e">6.3. モードラインのNarrowを短くする</a></li>
<li><a href="#org2f03356">6.4. モードラインの節約（VC-mode編）</a></li>
<li><a href="#orgccf4699">6.5. モードラインの色をカスタマイズする</a>
<ul>
<li><a href="#org4ae6d73">6.5.1. 色セット例</a></li>
</ul>
</li>
<li><a href="#orge185df5">6.6. 行番号の表示制限を拡張する</a></li>
<li><a href="#org31fade7">6.7. visible-bell のカスタマイズ</a></li>
<li><a href="#org348285d">6.8. 常に <b>scratch</b> を表示して起動する</a></li>
<li><a href="#orgcb6d79e">6.9. バッテリー情報をモードラインに表示する</a></li>
<li><a href="#org540188f">6.10. スクロールバーを非表示にする</a></li>
<li><a href="#org608d9ce">6.11. [yascroll] フリンジにスクロールバーを出す</a></li>
<li><a href="#org88e1dcc">6.12. ツールバーを非表示にする</a></li>
<li><a href="#org9ae099e">6.13. 起動時のスプラッシュ画面を表示しない</a></li>
<li><a href="#org79d3f1f">6.14. カーソル行の行数をモードラインに表示する</a></li>
<li><a href="#orgad3bb54">6.15. カーソル行の関数名をモードラインに表示する</a></li>
<li><a href="#orgd7f93cb">6.16. 時刻をモードラインに表示する</a></li>
<li><a href="#org6253397">6.17. 対応するカッコをハイライトする</a></li>
<li><a href="#org84f51a2">6.18. 全角スペースと行末タブ／半角スペースを強調表示する</a></li>
<li><a href="#org73eddf9">6.19. バッファの終わりをフリンジで明示</a></li>
<li><a href="#orgde8f962">6.20. 行番号をバッファに表示する</a></li>
<li><a href="#orga44b979">6.21. [migemo.el] ローマ字入力で日本語を検索する</a></li>
<li><a href="#orgab26950">6.22. [anything.el] 何でも絞り込みインターフェイス（旧）</a></li>
<li><a href="#org1c6baae">6.23. [helm.el] 続・何でも絞り込みインターフェイス</a></li>
<li><a href="#orgcdfcc64">6.24. [stripe-buffer.el] テーブルの色をストライプにする</a></li>
<li><a href="#org8da000e">6.25. [rainbow-delimiters] 対応するカッコに色を付ける</a></li>
<li><a href="#org32a5448">6.26. [git-gutter-fringe] 編集差分をフレーム端で視覚化</a></li>
<li><a href="#orgefca6e0">6.27. [zlc.el] find-file バッファを zsh ライクにする</a></li>
<li><a href="#org0dbdac1">6.28. [japanese-holidays] カレンダーをカラフルにする</a></li>
<li><a href="#orgb44976a">6.29. [calendar.el] カレンダーで週番号を表示する</a></li>
<li><a href="#org8ae0f4b">6.30. [guide-key] キーバインドの選択肢をポップアップする</a></li>
<li><a href="#org5a0682a">6.31. [which-key] キーバインドの選択肢をポップアップする</a></li>
<li><a href="#org0d12aea">6.32. [stock-ticker] 株価をモードラインに表示</a></li>
<li><a href="#orgb6eee68">6.33. [mode-icons] 使用中のモード表示をアイコンで代替</a></li>
<li><a href="#org49d8d29">6.34. [highlight-symbol] 同じ名前のシンボルをハイライトする</a></li>
<li><a href="#orgff88de6">6.35. [all-the-icons-dired] フォントを使ったアイコンを表示</a></li>
<li><a href="#org7cddb58">6.36. [eldoc.el] コンテクストに応じてヘルプを表示</a></li>
<li><a href="#org32c2fa7">6.37. [keycast.el] 入力しているキーとコマンドをモードラインに表示</a></li>
<li><a href="#org5f61302">6.38. <span class="todo TODO">TODO</span> [dimmer.el] 現在のバッファ以外の輝度を落とす</a></li>
</ul>
</li>
<li><a href="#orgcb202fa">7. メディアサポート</a>
<ul>
<li><a href="#org2a29974">7.1. [bongo.el] Emacsのバッファで音楽ライブラリを管理する</a></li>
<li><a href="#org3da11c2">7.2. [emms.el] メディアプレーヤー</a></li>
<li><a href="#org108ee70">7.3. [GoogleMaps.el] GoogleMaps を Emacs 内で使う</a></li>
<li><a href="#org8d397db">7.4. [org-google-weather.el] org-agenda に天気を表示する</a></li>
<li><a href="#org6434a83">7.5. [japanlaw.el] Emacs 電子六法</a></li>
<li><a href="#org6e01579">7.6. [sunshine.el] 天気を知る</a></li>
</ul>
</li>
<li><a href="#org8d85e91">8. 履歴／ファイル管理</a>
<ul>
<li><a href="#org41de425">8.1. [dired] ファイラのサポートツール</a></li>
<li><a href="#orgb9f8364">8.2. <span class="todo TODO">TODO</span> [dired-x] dired 拡張設定</a></li>
<li><a href="#org31bb8f0">8.3. <span class="todo TODO">TODO</span> [dired-recent] 訪問したディレクトリの履歴を取る</a></li>
<li><a href="#org66d0bfd">8.4. Undoバッファを無限に取る</a></li>
<li><a href="#orgb9a1b72">8.5. [undo-tree] 編集履歴をわかりやすくたどる</a></li>
<li><a href="#org3520dda">8.6. バッファ保存時にバックアップファイルを生成する</a></li>
<li><a href="#org42c9180">8.7. バッファ保存時にバックアップを生成させない</a></li>
<li><a href="#org8a7c193">8.8. ミニバッファの履歴を保存しリストアする</a></li>
<li><a href="#org2df90cc">8.9. 履歴サイズを大きくする</a></li>
<li><a href="#orgcd2dd89">8.10. Emacs終了時に開いていたバッファを起動時に復元する</a></li>
<li><a href="#org427227f">8.11. 最近開いたファイルリストを保持</a></li>
<li><a href="#orgc0b79e1">8.12. 深夜にバッファを自動整理する</a></li>
<li><a href="#orge2b36e6">8.13. [auto-save-buffers.el] 一定間隔でバッファを保存する</a></li>
<li><a href="#org63d994b">8.14. [backup-dir.el] バックアップファイルを一箇所に集める</a></li>
<li><a href="#org0c2013e">8.15. [backup-each-save] クラッシュに備える</a></li>
<li><a href="#org7650226">8.16. 特定のファイルを Dropbox 以下にバックアップする</a></li>
<li><a href="#org004ef2b">8.17. [session.el] 様々な履歴を保存し復元に利用する</a></li>
<li><a href="#org00948d2">8.18. [wakatime-mode.el] WakaTime を利用して作業記録する</a></li>
<li><a href="#org6ed28d7">8.19. [neotree.el] ディレクトリ情報をツリー表示</a></li>
<li><a href="#orge5e5150">8.20. [osx-trash] system-move-file-to-trash を有効にする</a></li>
<li><a href="#orgd1156cd">8.21. [helpful.el] リッチなヘルプページ</a></li>
<li><a href="#org05536d8">8.22. [keyfreq.el] コマンドログ</a></li>
</ul>
</li>
<li><a href="#org2fef066">9. 開発サポート</a>
<ul>
<li><a href="#orgac548d2">9.1. 便利キーバインド</a></li>
<li><a href="#org3728fb1">9.2. [gist.el] Gist インターフェイス</a></li>
<li><a href="#orgb9f7ee2">9.3. [doxymacs.el] Doxygen のコメントを簡単に入力する</a></li>
<li><a href="#orgce46084">9.4. [matlab.el] Matlab用の設定&#xa0;&#xa0;&#xa0;<span class="tag"><span class="Mac">Mac</span></span></a></li>
<li><a href="#orgf8e440c">9.5. [flycheck.el] 構文エラー表示</a></li>
<li><a href="#org323998b">9.6. [auto-complete.el] 自動補完機能</a></li>
<li><a href="#org5eeafdf">9.7. [auto-complete-clang.el] オムニ補完</a>
<ul>
<li><a href="#org99c466d">9.7.1. References</a></li>
</ul>
</li>
<li><a href="#org1488cec">9.8. [hideshowvis.el] 関数の表示／非表示</a></li>
<li><a href="#org1da8027">9.9. [origami.el] 関数の折りたたみ</a></li>
<li><a href="#org5692731">9.10. [quickrun.el] お手軽ビルド</a></li>
<li><a href="#org0c7b453">9.11. [ggtags.el] タグジャンプ</a></li>
<li><a href="#orgbf8af0d">9.12. [0xc] N進数変換</a></li>
<li><a href="#org7d3424e">9.13. <span class="todo TODO">TODO</span> [EditorConfig] コードスタイルの強制</a></li>
<li><a href="#orga87c1c2">9.14. [uuid.el] UUID の生成</a></li>
<li><a href="#orgbd7da30">9.15. [hexl.el] バイナリファイルを開く</a></li>
<li><a href="#org0246b99">9.16. [package-lint.el] MEPLA登録用Lint</a></li>
<li><a href="#org2b9fc39">9.17. <span class="todo TODO">TODO</span> [cov] カバレッジの状態をフリンジで確認</a></li>
<li><a href="#orgd3c7d93">9.18. <span class="todo TODO">TODO</span> [projectile.el] ディレクトリ単位でファイル群をプロジェクト扱いする</a></li>
<li><a href="#org2206b51">9.19. <span class="todo TODO">TODO</span> [magit.el] Gitクライアント</a></li>
<li><a href="#org7f080d4">9.20. <span class="todo TODO">TODO</span> [format-all.el] コード整形</a></li>
</ul>
</li>
<li><a href="#org2fca60c">10. Org Mode</a>
<ul>
<li><a href="#org065390f">10.1. 基本設定</a></li>
<li><a href="#org0b8263d">10.2. contribution を使う</a></li>
<li><a href="#orgb63a2d2">10.3. iCal との連携</a></li>
<li><a href="#orga382265">10.4. スピードコマンド</a></li>
<li><a href="#orgef5f93e">10.5. face 関連</a></li>
<li><a href="#orga6f468b">10.6. TODOキーワードのカスタマイズ</a></li>
<li><a href="#org087df16">10.7. ImageMagick を使って様々な画像をインライン表示する</a></li>
<li><a href="#org7c47f48">10.8. [org-agenda] タスク／予定管理</a></li>
<li><a href="#orgf9053c5">10.9. <span class="todo TODO">TODO</span> [orgbox.el] スケジュール追加のわかりやすい入力</a></li>
<li><a href="#org87c9b3f">10.10. <span class="todo TODO">TODO</span> [org-review.el] レビューフローのサポート</a></li>
<li><a href="#org24ce624">10.11. [appt.el] アラーム設定</a></li>
<li><a href="#org827379e">10.12. [org-capture] 高速にメモを取る</a></li>
<li><a href="#org0d105a9">10.13. [org-refile] orgツリーの高速移動</a></li>
<li><a href="#org731e369">10.14. [org-babel] 基本設定</a></li>
<li><a href="#org86adf84">10.15. [org-babel] ソースブロックの入力キーをカスタマイズ</a></li>
<li><a href="#org14348b9">10.16. [MobileOrg] iOS との連携</a></li>
<li><a href="#orgd72b299">10.17. [org-tree-slide] Org Modeでプレゼンテーション</a></li>
<li><a href="#org580b52c">10.18. [org-tree-slide] クロックインとアウトを自動化する</a></li>
<li><a href="#orga5b1ada">10.19. [org-tree-slide] 特定のツリーをプロポーショナルフォントで表示する</a></li>
<li><a href="#orga94947a">10.20. [org-tree-slide] ヘッドラインをリッチにする</a></li>
<li><a href="#orge7c2545">10.21. <span class="todo TODO">TODO</span> [org-tree-slide] BEGIN_SRCとEND_SRCを消して背景色を変える</a></li>
<li><a href="#org3b4eb8e">10.22. <span class="todo TODO">TODO</span> [org-fstree] ディレクトリ構造を読み取る</a></li>
<li><a href="#org80c8e1d">10.23. [calfw-org] calfw に org の予定を表示する</a></li>
<li><a href="#org617be4f">10.24. [org-export-generic] エクスポート機能を拡張する</a></li>
<li><a href="#org4b08bea">10.25. <span class="todo TODO">TODO</span> [ox] 出力形式の拡張</a></li>
<li><a href="#org2484037">10.26. [org-odt] ODT形式に出力</a></li>
<li><a href="#org43b04fd">10.27. [ox-twbs] Twitter Bootstrap 互換のHTML出力</a></li>
<li><a href="#orgabe413a">10.28. [org-crypt] ツリーを暗号化する</a></li>
<li><a href="#org41f2bc1">10.29. [org-mac-link] 外部アプリから情報を取る</a></li>
<li><a href="#orga21b4c9">10.30. <span class="todo TODO">TODO</span> Parers3.app からリンクを取得する</a></li>
<li><a href="#org8ce50e4">10.31. <span class="todo TODO">TODO</span> Papers3.app のリンクを開けるようにする</a></li>
<li><a href="#org3d43c2f">10.32. <span class="todo TODO">TODO</span> [org-attach] 外部ファイルを紐付ける</a></li>
<li><a href="#orgad5a5d2">10.33. <span class="todo REV2">REV2</span> [org-screenshot] スクリーンショットを貼り付ける</a></li>
<li><a href="#orge2012c2">10.34. [org-download] org バッファにD&amp;Dでファイルを保存</a></li>
<li><a href="#org4a2fbc5">10.35. [alerter] イベント通知</a></li>
<li><a href="#orgd9a75ac">10.36. [org-grep] org ファイルを grep する</a></li>
<li><a href="#org930ec66">10.37. [ox-reveal] ナイスなHTML5プレゼンテーション出力</a></li>
<li><a href="#orgbf32a55">10.38. README を常に org-mode で開く</a></li>
<li><a href="#org2442ee1">10.39. org-mode でアラーム管理</a></li>
<li><a href="#org95433c7">10.40. org-mode の latex エクスポート関数をオーバーライド</a></li>
<li><a href="#org1139fac">10.41. [org-autolist] ブリッツの入力を簡単に</a></li>
<li><a href="#org21f10e8">10.42. [org-dashboard] 進捗をプログレスバーで確認</a></li>
<li><a href="#org7df96b9">10.43. [org-clock-today] 今日の総作業時間をモードラインに表示</a></li>
<li><a href="#orgccc5422">10.44. <span class="todo TODO">TODO</span> [org-recent-headings] 訪問したツリーを記録し簡単に再訪問可能にする</a></li>
<li><a href="#orge9dabd6">10.45. <span class="todo TODO">TODO</span> [orgnav] ツリーの検索インタフェース</a></li>
<li><a href="#org08c00a6">10.46. [org-random-todo] ランダムにタスクを選ぶ</a></li>
<li><a href="#orga83ebe8">10.47. <span class="todo TODO">TODO</span> [toc-org] 目次の挿入</a></li>
<li><a href="#org93fa23b">10.48. [ox-hugo] OrgファイルからHogoの記事をエクスポートする</a></li>
</ul>
</li>
<li><a href="#org51c0da7">11. フレーム／ウィンドウ制御</a>
<ul>
<li><a href="#org719e535">11.1. 起動時の設定</a></li>
<li><a href="#orga2df16e">11.2. 複数フレーム対応</a></li>
<li><a href="#orgbc06ee7">11.3. [e2wm.el] 二画面表示</a></li>
<li><a href="#org76f74dd">11.4. [moom.el] キーボードでフレームの場所を移す</a>
<ul>
<li><a href="#orge0c880d">11.4.1. 最大化時にモードラインを消す</a></li>
</ul>
</li>
<li><a href="#org738af7b">11.5. [popwin.el] ポップアップウィンドウの制御</a></li>
<li><a href="#orgb8f4604">11.6. <span class="todo TODO">TODO</span> [shackle.el] ポップアップウィンドウの制御</a>
<ul>
<li><a href="#orgea53efa">11.6.1. checkdoc.el 用の追加設定</a></li>
</ul>
</li>
<li><a href="#org3b21898">11.7. [elscreen.el] Emacs バッファをタブ化</a></li>
<li><a href="#orga786523">11.8. [tabbar-ruler] バッファをタブ切り替え可能に</a></li>
<li><a href="#org4c854c4">11.9. [winner-undo.el] ウィンドウ構成の履歴を辿る</a></li>
</ul>
</li>
<li><a href="#org07bf46f">12. フォント／配色関連</a>
<ul>
<li><a href="#org413709a">12.1. 正規表現を見やすくする</a></li>
<li><a href="#org26b9bed">12.2. 設定ファイルを見やすくする</a></li>
<li><a href="#org6740cb2">12.3. カーソル行に色をつける</a></li>
<li><a href="#org4cae7bb">12.4. カーソルを点滅させない</a></li>
<li><a href="#orge4f9f45">12.5. カーソル位置のフォントを確認</a></li>
<li><a href="#orga507036">12.6. フォント設定</a>
<ul>
<li><a href="#orgbda836d">12.6.1. フォントのインストール方法</a></li>
<li><a href="#orgacaa2a7">12.6.2. フォントチェック用コード</a></li>
</ul>
</li>
<li><a href="#org1ff449a">12.7. 行間を制御する</a></li>
<li><a href="#org5a1542f">12.8. パッチをカラフルに表示する</a></li>
<li><a href="#orgde4e254">12.9. 背景を黒系色にする</a></li>
<li><a href="#org4ff5374">12.10. 日中と夜中でテーマを切り替える</a></li>
<li><a href="#orge12a95b">12.11. 時間帯を指定して起動時にテーマを切り替える</a></li>
<li><a href="#orgdfff5ac">12.12. [rainbow-mode.el] 配色のリアルタイム確認</a>
<ul>
<li><a href="#org0ff3e2b">12.12.1. 色一覧</a></li>
</ul>
</li>
<li><a href="#orgf826d5b">12.13. [volatile-highlights] コピペした領域を強調</a></li>
<li><a href="#org555cc70">12.14. [edit-color-stamp] Qt経由でカラーピッカーを使う</a></li>
</ul>
</li>
<li><a href="#org1501fe8">13. ユーティリティ関数</a>
<ul>
<li><a href="#org368ecca">13.1. [pomodoro.el] ポモドーロの実践</a></li>
<li><a href="#orgf17469f">13.2. [pomodoro.el] 続・ポモドーロの実践</a></li>
<li><a href="#org6b90b6a">13.3. [google-this.el] 単語をグーグル検索</a></li>
<li><a href="#org2b2ebe4">13.4. [lingr.el] チャットルームに参加</a></li>
<li><a href="#org447a237">13.5. [osx-lib.el] OSX用ユーティリティ&#xa0;&#xa0;&#xa0;<span class="tag"><span class="Mac">Mac</span></span></a></li>
<li><a href="#orgff6915d">13.6. <span class="todo TODO">TODO</span> [password-store.el] パスワード管理</a></li>
<li><a href="#org1f55dae">13.7. [multi-term.el] ターミナル</a></li>
<li><a href="#org5ac32ea">13.8. iterm2 を Emacs から呼び出したい&#xa0;&#xa0;&#xa0;<span class="tag"><span class="Mac">Mac</span></span></a></li>
<li><a href="#orga211889">13.9. カレントバッファのあるディレクトリをターミナルで表示</a></li>
<li><a href="#orgee33500">13.10. [postpone.el] Emacs起動してから使い始めるタイミングで実行する</a></li>
<li><a href="#orgc1446e5">13.11. <span class="todo TODO">TODO</span> [network-watch.el] ネットワークインターフェイスの状態を監視</a></li>
<li><a href="#org5baab2b">13.12. [gif-screencast.el] ユーザアクションのたびにスクショを取る</a></li>
<li><a href="#orgeee9330">13.13. <span class="todo TODO">TODO</span> [manage-minor-mode.el] マイナーモードの視覚的な管理</a></li>
<li><a href="#orgf6662c5">13.14. [utility.el] 自作してテスト中の便利関数群</a></li>
</ul>
</li>
<li><a href="#org8bf3075">14. おわりに</a></li>
</ul>
</div>
</div>

<div id="outline-container-org4b055bf" class="outline-2">
<h2 id="org4b055bf"><span class="section-number-2">1</span> はじめに</h2>
<div class="outline-text-2" id="text-1">
<ul class="org-ul">
<li><a href="https://github.com/takaxp/emacs.d/blob/master/init.org">init.org</a> から <a href="https://github.com/takaxp/emacs.d/blob/master/init.el">init.el</a>，<a href="https://github.com/takaxp/emacs.d/raw/master/init.pdf">init.pdf</a>，<a href="https://github.com/takaxp/emacs.d/raw/master/init.odt">init.odt</a>，<a href="https://pxaka.tokyo/wiki/doku.php?id=emacs:init.el">wiki</a> を生成しています．<br />
<ul class="org-ul">
<li>wiki への出力は，<a href="https://gist.github.com/1369417">org2dokuwiki.pl</a>を使って生成しています．<br /></li>
</ul></li>
<li>一部の関数定義を <a href="https://pxaka.tokyo/wiki/doku.php?id=emacs:utility.el">utility.el</a> に分離しています．<br /></li>
<li><a href="https://github.com/takaxp/emacs.d/blob/master/init.el">init.el</a> 本体は，<a href="https://github.com/takaxp/emacs.d/">github</a> に公開しています．<br /></li>
<li>コピペだけで動かなかった場合は，ページ最下部のコメント欄にご意見をどうぞ．<br />
<ul class="org-ul">
<li>github.io 以下で閲覧する場合は，コメント欄が表示されません．<br /></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org9c3a72a" class="outline-2">
<h2 id="org9c3a72a"><span class="section-number-2">2</span> 基本設定</h2>
<div class="outline-text-2" id="text-2">
<p>
この設定群を利用するために設定です．一部の関数は記述しておかないと動かない可能性があります．<br />
</p>
</div>

<div id="outline-container-orgb6abcb0" class="outline-3">
<h3 id="orgb6abcb0"><span class="section-number-3">2.1</span> init.el のヘッダ</h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">-*- lexical-binding: t -*-</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">Configurations for Emacs</span>
<span style="color: #b22222;">;;                                         </span><span style="color: #b22222;">Takaaki ISHIKAWA  <a href="mailto:takaxp%40ieee.org">&lt;takaxp@ieee.org&gt;</a></span>
</pre>
</div>

<ul class="org-ul">
<li>.emacs のカスタマイズを本格化し始めた頃に<a href="http://www.mygooglest.com/fni/dot-emacs.html">参照した情報</a><br /></li>
</ul>
</div>
</div>

<div id="outline-container-org695db2c" class="outline-3">
<h3 id="org695db2c"><span class="section-number-3">2.2</span> init ファイルの読み込み時間計測</h3>
<div class="outline-text-3" id="text-2-2">
<p>
次の関数を <code>init.el</code> の最初に記載して，オプション付きで <code>after-init-hook</code> に乗っければ，initファイルの読み込み時間を計測できます（GUIのフレーム生成を含まない）．これ以降に設定する <code>emacs-init-time</code> の派生関数と違い， <code>after-init-hook</code> で実行される処理の時間もわかります（ほかの処理も微妙に入るので，あくまで目安です）．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">before-load-init-time</span> (current-time)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">moved to init-env.el</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-load-init-time</span> ()
  <span style="color: #8b2252;">"Loading time of user init files including time for `</span><span style="color: #008b8b;">after-init-hook</span><span style="color: #8b2252;">'."</span>
  (<span style="color: #a020f0;">let</span> ((time1 (float-time
                (time-subtract after-init-time before-load-init-time)))
        (time2 (float-time
                (time-subtract (current-time) before-load-init-time))))
    (message (concat <span style="color: #8b2252;">"Loading init files: %.0f [msec], "</span>
                     <span style="color: #8b2252;">"of which %.f [msec] for `</span><span style="color: #008b8b;">after-init-hook</span><span style="color: #8b2252;">'."</span>)
             (* 1000 time1) (* 1000 (- time2 time1)))))
(add-hook 'after-init-hook #'my-load-init-time t)
</pre>
</div>

<p>
<code>after-init-hook</code> の値をチェックして， <code>my-load-init-time</code> が最後に配置されていることに留意します．以下は， <code>after-init-hook</code> の例です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(session-initialize recentf-mode my-emacs-init-time my-load-init-time)
</pre>
</div>
</div>

<div id="outline-container-org64ded1d" class="outline-4">
<h4 id="org64ded1d"><span class="section-number-4">2.2.1</span> Emacs 起動時の呼び出し順</h4>
<div class="outline-text-4" id="text-2-2-1">
<ol class="org-ol">
<li>Set before-init-time = (current-time) and Set after-init-time = nil<br /></li>
<li>Initializes the window<br /></li>
<li>Run before-init-hook<br /></li>
<li>Set before-load-init-time = (current-time) =&gt; 独自変数で計測<br /></li>
<li>Load user's init files<br /></li>
<li>Set after-init-time = (current-time)<br /></li>
<li>Run after-init-hook<br /></li>
<li>Run emacs-startup-hook<br /></li>
</ol>

<p>
<code>emacs-init-time</code> は，GUI生成と，GUI関連elの読み込み， <code>before-init-hook</code> で実行する関数の実行時間，およびユーザ定義のinitファイル群の読み込み時間の合計値となる．<br />
</p>

<p>
すでに <code>after-init-time</code> で時間計測が完了しているので，その後に続く <code>after-init-hook</code> と <code>emacs-startup-hook</code> に登録された関数の実行時間は <code>emacs-init-time</code> の値に含まれない．<br />
</p>

<p>
より端的に言えば， <code>emacs-init-time</code> = <code>before-init-time</code> - <code>after-init-time</code> である．<br />
</p>

<p>
一方， <code>before-load-init-time</code> と <code>after-init-time</code> を使って計算する算出する起動時間には，GUI生成とGUI関連elの読み込み，before-init-hook にある関数の実行が含まれていない．<br />
</p>

<p>
see also <a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Startup-Summary.html">Startup Summary - GNU Emacs Lisp Reference Manual</a><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgf844d32" class="outline-3">
<h3 id="orgf844d32"><span class="section-number-3">2.3</span> 起動時間の計測</h3>
<div class="outline-text-3" id="text-2-3">
<p>
<code>M-x emacs-init-time</code> を実行すると，Emacsの起動にかかった時間が表示されます．個人的にはミリ秒表示が好きなので，手を加えます．元ネタは<a href="http://d.hatena.ne.jp/sugyan/20120120/1327037494">すぎゃーんメモ</a>からです．感謝．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-emacs-init-time</span> ()
  (message <span style="color: #8b2252;">"Emacs booting time: %.0f [msec] from `</span><span style="color: #008b8b;">emacs-init-time</span><span style="color: #8b2252;">'."</span>
           (* 1000
              (float-time (time-subtract
                           after-init-time
                           before-init-time)))))
(add-hook 'after-init-hook #'my-emacs-init-time)
</pre>
</div>
</div>
</div>

<div id="outline-container-org0265e3f" class="outline-3">
<h3 id="org0265e3f"><span class="section-number-3">2.4</span> GCサイズの最適化</h3>
<div class="outline-text-3" id="text-2-4">
<p>
起動時に発生するガベージコレクトを防きます．起動後に使用しているメモリサイズを超えていれば良さ気． <code>garbage-collection-messages</code> を設定しておくと，ガベージコレクトが生じる時にメッセージが出るようになります．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> gc-cons-threshold 134217728) <span style="color: #b22222;">;; </span><span style="color: #b22222;">128MB</span>
(<span style="color: #a020f0;">setq</span> garbage-collection-messages t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org649eb81" class="outline-3">
<h3 id="org649eb81"><span class="section-number-3">2.5</span> [exec-path-from-shell] PATH設定をシェルから継承する</h3>
<div class="outline-text-3" id="text-2-5">
<p>
外部プログラムのサポートを得て動くパッケージは，設定の過程でプログラムが見つからないと怒られることがしばしばあります． <code>exec-path-from-shell</code> は，シェルに設定した <code>PATH</code> の情報を継承して <code>exec-path</code> や <code>PATH</code> を設定してくれます．私は起動時に環境を切り替えることがあるので使ってませんが，使われている方は多いようです．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">exec-path-from-shell</span> nil t)
           (memq window-system '(mac ns)))
  (exec-path-from-shell-initialize))
</pre>
</div>
</div>
</div>

<div id="outline-container-org9e2440a" class="outline-3">
<h3 id="org9e2440a"><span class="section-number-3">2.6</span> cl を使う</h3>
<div class="outline-text-3" id="text-2-6">
<ul class="org-ul">
<li><a href="http://lisperblog.blogspot.com/2008/12/blog-post_18.html">http://lisperblog.blogspot.com/2008/12/blog-post_18.html</a><br /></li>
</ul>

<p>
同時にバイトパイル時の警告を回避するために，いくつかのパッケージを <code>eval-when-compile</code> の中に記述します． <code>init.el</code> 全体で対象パッケージが増えたので，別ファイルに括りだしました．バイトコンパイルするときだけ， <code>init-eval.el</code> を読み込みます．<br />
</p>

<p>
例えば， <code>init.el</code> のコンパイルを次のようにします．<br />
</p>

<div class="org-src-container">
<pre class="src src-sh">/Applications/Emacs.app/Contents/MacOS/Emacs -l ~/.emacs -l ~/Dropbox/emacs.d/config/init-eval.el -batch -f batch-byte-compile-if-not-done ~/Dropbox/emacs.d/config/init.el
</pre>
</div>

<p>
これなら <code>init.el</code> に <code>eval-when-compile</code> が書いてあっても同じに見えますが，バイトコンパイルしない状態で <code>init.el</code> を読み込むと， <code>eval-when-compile</code> の中身がすべて実行されてしまうので，起動が重くなってしまいます．そうであれば，そもそもバイトコンパイルする時に必要なパッケージ群をロードすれば良いよね，という上記のアプローチに落ち着きました．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">eval-when-compile</span>
  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">init-eval</span> nil t))
</pre>
</div>
</div>
</div>

<div id="outline-container-org98718f9" class="outline-3">
<h3 id="org98718f9"><span class="section-number-3">2.7</span> [load-package-p] 設定の読み込みフラグを確認する</h3>
<div class="outline-text-3" id="text-2-7">
<p>
<code>loading-packages</code> 変数に，設定を無視するパッケージを記述しておくと， <code>autoload-if-found</code> 内でそれらを読み込まないようにします．読み込まなかったパッケージは，Messages バッファにそのことを報告します． <code>autoload-if-found</code> は本来の実装ではなく，=loading-packages= を参照するように手を加えています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">load-package-p</span> (file)
  (<span style="color: #a020f0;">let</span> ((enabled t))
    (<span style="color: #a020f0;">when</span> (boundp 'loading-packages)
      (<span style="color: #a020f0;">dolist</span> (package loading-packages)
        (<span style="color: #a020f0;">let</span> ((name (car package))
              (flag (cdr package)))
          (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (stringp name)
                     (equal file name)
                     (not flag))
            (<span style="color: #a020f0;">setq</span> enabled nil)
            (message <span style="color: #8b2252;">"--- `</span><span style="color: #008b8b;">%s</span><span style="color: #8b2252;">' was NOT loaded intentionally"</span> name)))))
    enabled))
</pre>
</div>
</div>
</div>

<div id="outline-container-org98d66f7" class="outline-3">
<h3 id="org98d66f7"><span class="section-number-3">2.8</span> リストで関数を渡す autoload-if-found を使う</h3>
<div class="outline-text-3" id="text-2-8">
<ul class="org-ul">
<li><p>
<a href="http://d.hatena.ne.jp/jimo1001/20090921/1253525484">http://d.hatena.ne.jp/jimo1001/20090921/1253525484</a><br />
</p>

<p>
eval-after-load とのペアでマクロ化したバージョンもあります（次章参照）．ただ，生成されるバイトコードに問題がありそうなので，最近は <code>autoload-if-found</code> と <code>with-eval-after-load</code> の組み合わせに戻しています．最初に <code>when</code> 判定をすることで，パッケージが未インストールの状態に各種設定をスキップするので安全です．<br />
</p></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(f1 f2) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#38306;&#25968;&#12522;&#12473;&#12488;&#65294;&#35201;&#32032;&#12398;&#38306;&#25968;&#12434;&#21628;&#12406;&#26178;&#12395;&#65292;&#12497;&#12483;&#12465;&#12540;&#12472;&#12364;&#35501;&#12415;&#36796;&#12414;&#12428;&#12427;</span>
       <span style="color: #8b2252;">"package-name"</span> nil t) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#31532;4&#24341;&#25968;&#12414;&#12391;&#25351;&#23450;&#12377;&#12427;&#12392;&#65292;M-x &#12391;&#35036;&#23436;&#23550;&#35937;&#12395;&#12394;&#12427;&#65294;</span>

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(0) &#12496;&#12452;&#12488;&#12467;&#12531;&#12497;&#12452;&#12523;&#26178;&#12395;&#35686;&#21578;&#12364;&#12391;&#12383;&#12425;&#65292;&#23550;&#24540;&#12377;&#12427;&#12497;&#12483;&#12465;&#12540;&#12472;&#12434;&#35352;&#36617;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#29694;&#22312;&#12399;&#65292;&#12496;&#12452;&#12488;&#12467;&#12531;&#12497;&#12452;&#12523;&#26178;&#12384;&#12369;&#65292;&#24517;&#35201;&#12394;&#12497;&#12483;&#12465;&#12540;&#12472;&#12398; require &#12434;&#20840;&#12390;&#35352;&#36617;&#12375;&#12383;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">init-eval.el &#12434;&#35501;&#12415;&#36796;&#12416;&#26041;&#24335;&#12395;&#22793;&#26356;&#65294; eval-when-compile &#12434;&#20351;&#12431;&#12394;&#12356;&#65294;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(eval-when-compile</span>
  <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(require 'package-name nil t))</span>

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(1) &#12497;&#12483;&#12465;&#12540;&#12472;&#12364;&#23384;&#22312;&#12377;&#12428;&#12400;&#65292; Emacs &#36215;&#21205;&#26178;&#12395;&#35501;&#12415;&#36796;&#12416;&#35373;&#23450;&#32676;</span>
  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.hoge$"</span> . package-name-mode) auto-mode-alist)
  (add-hook 'after-init-hook 'f1)
  (global-set-key (kbd <span style="color: #8b2252;">"r"</span>) 'f2)

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(2) &#36933;&#24310;&#35501;&#12415;&#36796;&#12415;&#12377;&#12427;&#35373;&#23450;&#32676;</span>
  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"package-name"</span>
    (<span style="color: #a020f0;">setq</span> v1 t)
    (<span style="color: #a020f0;">setq</span> v2 nil)
    (define-key package-name-map (kbd <span style="color: #8b2252;">"q"</span>) 'f1))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"package-name2"</span>
    (<span style="color: #a020f0;">setq</span> v3 t)
    (<span style="color: #a020f0;">setq</span> v4 nil)))
</pre>
</div>

<ul class="org-ul">
<li><a href="http://www.sodan.org/~knagano/emacs/dotemacs.html%EF%BC%88%E3%82%AA%E3%83%AA%E3%82%B8%E3%83%8A%E3%83%AB">http://www.sodan.org/~knagano/emacs/dotemacs.html（オリジナル</a>）<br /></li>
</ul>

<p>
次のカスタマイズされた <code>autoload-if-found</code> は引数にリストのみを受け付けます．欠点は，リスト内の全て関数に個別の <code>docstring</code> を設定できないため，ヘルプ画面で何の関数なのかの情報があまり表示されないことです．ただ， <code>require</code> でパッケージを読み込んでしまえば，本来の <code>docstring</code> の内容が正しく反映されるので，すべての情報を確認できるようになります．また， <code>interactive</code> を <code>t</code> にすれば， <code>M-x</code> で当該関数がリストアップされるようになります．したがって， <code>(docstring interactive) = (nil t)</code> をデフォルトで指定すればOKです． <code>type</code> には， <code>macro</code> や <code>keymap</code> を指定して，関数以外の情報をオートロード対象にします．<br />
</p>

<p>
コンパイル時に <code>Warning: the function ‘google-this’ is not known to be defined.</code> のようなメッセージが出る時に， <code>autoload-if-found</code> の <code>functions</code> に当該関数を追加すると，警告されなくなります． <code>declare-function</code> を追記せずに済みます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">autoload-if-found</span> (functions file <span style="color: #228b22;">&amp;optional</span> docstring interactive type)
  <span style="color: #8b2252;">"set autoload iff. FILE has found."</span>
  (<span style="color: #a020f0;">and</span> (load-package-p file)
       (locate-library file)
       (<span style="color: #a020f0;">progn</span>
         (<span style="color: #a020f0;">dolist</span> (f functions)
           (autoload f file docstring interactive type))
         t)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgae52377" class="outline-3">
<h3 id="orgae52377"><span class="section-number-3">2.9</span> [eval-after-autoload-if-found] 複数関数を対象とする遅延読み込み</h3>
<div class="outline-text-3" id="text-2-9">
<p>
Twitterでぼやいていたら <a href="https://twitter.com/cvmat">@cvmat</a>さんが降臨して次のマクロを作ってくださいました．感謝感謝．<br />
</p>

<ul class="org-ul">
<li><a href="https://gist.github.com/3513287">https://gist.github.com/3513287</a><br /></li>
</ul>

<p>
autoload-if-found で遅延読み込みすると，eval-after-load と組み合わせるので，どうしてもインデントが増えてしまうのが欠点です．<br />
</p>

<p>
例えば，cycle-buffer を遅延読み込みしたい場合， <code>setq</code> で変数を書き換えするために随分とインデントが進んでいます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(cycle-buffer cycle-buffer-backward) <span style="color: #8b2252;">"cycle-buffer"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"cycle-buffer"</span>
    (<span style="color: #a020f0;">setq</span> cycle-buffer-allow-visible t)
    (<span style="color: #a020f0;">setq</span> cycle-buffer-show-length 12)
    (<span style="color: #a020f0;">setq</span> cycle-buffer-show-format '(<span style="color: #8b2252;">" [ %s ]"</span> . <span style="color: #8b2252;">" %s"</span>))))
</pre>
</div>

<p>
これをスッキリさせるために <code>eval-after-autoload-func</code> を使います．記述がシンプルになり，行数も桁数もスッキリです．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(eval-after-autoload-if-found
 '(cycle-buffer cycle-buffer-backward) <span style="color: #b22222;">;; </span><span style="color: #b22222;">autoload &#12391;&#21453;&#24540;&#12373;&#12379;&#12427;&#38306;&#25968;</span>
 <span style="color: #8b2252;">"cycle-buffer"</span> nil t nil      <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21453;&#24540;&#12373;&#12379;&#12383;&#38306;&#25968;&#12398;&#12467;&#12540;&#12523;&#12391;&#35501;&#12416;&#12497;&#12483;&#12465;&#12540;&#12472;&#25351;&#23450;</span>
 '(<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12497;&#12483;&#12465;&#12540;&#12472;&#35501;&#12415;&#36796;&#12415;&#24460;&#12398;&#35373;&#23450;</span>
   (<span style="color: #a020f0;">setq</span> cycle-buffer-allow-visible t)
   (<span style="color: #a020f0;">setq</span> cycle-buffer-show-length 12)
   (<span style="color: #a020f0;">setq</span> cycle-buffer-show-format '(<span style="color: #8b2252;">" &lt; %s &gt;"</span> . <span style="color: #8b2252;">" %s"</span>))))
</pre>
</div>

<p>
さらに戻り値を判定して，グローバルなキーアサインもできます．存在しないパッケージの関数呼び出しを明示的に防ぐために有効です． <code>hook</code> 系の登録も同様です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (eval-after-autoload-if-found
       '(cycle-buffer cycle-buffer-backward) <span style="color: #8b2252;">"cycle-buffer"</span> nil t nil
       '((<span style="color: #a020f0;">setq</span> cycle-buffer-allow-visible t)
         (<span style="color: #a020f0;">setq</span> cycle-buffer-show-length 12)
         (<span style="color: #a020f0;">setq</span> cycle-buffer-show-format '(<span style="color: #8b2252;">" &lt; %s &gt;"</span> . <span style="color: #8b2252;">" %s"</span>))
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12497;&#12483;&#12465;&#12540;&#12472;&#12398;&#12461;&#12540;&#12450;&#12469;&#12452;&#12531;&#12399;&#12371;&#12385;&#12425;</span>
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">(define-key xxx-map (kbd "q") 'hoge)</span>
         ))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12464;&#12525;&#12540;&#12496;&#12523;&#12399;&#12371;&#12385;&#12425;</span>
  (global-set-key (kbd <span style="color: #8b2252;">"M-]"</span>) 'cycle-buffer)
  (global-set-key (kbd <span style="color: #8b2252;">"M-["</span>) 'cycle-buffer-backward)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12497;&#12483;&#12465;&#12540;&#12472;&#12395;&#32016;&#20184;&#12356;&#12383;&#12501;&#12483;&#12463;&#12399;&#12371;&#12385;&#12425;&#12408;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-hook 'xxx-hook 'hogehoge)</span>
  <span style="color: #b22222;">;;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12499;&#12523;&#12489;&#12452;&#12531;&#12391;&#12399;&#12394;&#12356;mode&#12398; auto-mode-alist &#35373;&#23450;&#12418;&#24517;&#35201;&#12394;&#12425;&#12371;&#12385;&#12395;&#35352;&#36848;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(push '("\\.hoge$" . hoge-mode) auto-mode-alist)</span>
  )
</pre>
</div>

<p>
なお，第四引数 <code>(functions file docstring interactive)</code> まで指定すれば， <code>M-x</code> の呼び出し候補に functions で指定した関数が補完表示されます．<br />
</p>
</div>

<div id="outline-container-orgdd2c070" class="outline-4">
<h4 id="orgdd2c070"><span class="section-number-4">2.9.1</span> 関数版</h4>
<div class="outline-text-4" id="text-2-9-1">
<p>
関数版にリスト <code>loading-packages</code> を追加しました．このリストに事前に Lisp ファイル名を入れておくと，一切の設定をスキップするものです． <code>eval-after-atoload-if-found</code> を定義する前に次のような変数を設定しておきます．バイトコンパイルしていないファイルに書いておけば，パッケージのON/OFFを簡単に制御できます．<br />
</p>

<p>
ただ問題点として，最後の引数に入れる関数がバイトコンパイル時に展開されないようで，出来上がったバイトコードが高速化に寄与しているのか不明です．簡易的な実験ではだいぶ差があるようで，最近は <code>autoload-if-found</code> ， <code>with-eval-after-load</code> ， <code>eval-when-compile</code> の組み合わせで，設定を書いて，遅延ロードと高速読み込みを実現しています． <code>loading-packages</code> は <code>autoload-if-found</code> に組み込みました．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> loading-packages <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#36861;&#21152;&#12373;&#12428;&#12390;&#12356;&#12394;&#12356;&#22580;&#21512;&#12399;&#27161;&#28310;&#12391;&#35501;&#12415;&#36796;&#12416;</span>
      '((<span style="color: #8b2252;">"web-mode"</span> . nil) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35501;&#12415;&#36796;&#12414;&#12394;&#12356;</span>
        (<span style="color: #8b2252;">"org"</span> . t))) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35501;&#12415;&#36796;&#12416;</span>
</pre>
</div>

<p>
<a href="https://gist.github.com/3513287">https://gist.github.com/3513287</a><br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">https://github.com/zk-phi/setup</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(when (require 'setup nil t)</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(setup-initialize))</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">eval-after-autoload-if-found</span>
    (functions file <span style="color: #228b22;">&amp;optional</span> docstring interactive type after-body)
  <span style="color: #8b2252;">"Set up autoload and eval-after-load for FUNCTIONS iff. FILE has found."</span>
  (<span style="color: #a020f0;">let</span> ((enabled t)
        (package nil))
    (message <span style="color: #8b2252;">"--- %s"</span> file)
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (boundp 'loading-packages) loading-packages)
      (<span style="color: #a020f0;">dolist</span> (package loading-packages)
        (<span style="color: #a020f0;">let</span> ((name (car package))
              (flag (cdr package)))
          (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (stringp name) (equal file name))
            (<span style="color: #a020f0;">unless</span> flag
              (<span style="color: #a020f0;">setq</span> enabled nil)
              (message <span style="color: #8b2252;">"--- A setting for `</span><span style="color: #008b8b;">%s</span><span style="color: #8b2252;">' was NOT loaded explicitly"</span>
                       name))))))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">if disabled then return nil.</span>
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> enabled (locate-library file))
      (mapc (<span style="color: #a020f0;">lambda</span> (func)
              (autoload func file docstring interactive type))
            (<span style="color: #a020f0;">if</span> (listp functions)
                functions
              (list functions)))
      (<span style="color: #a020f0;">when</span> after-body
        (eval-after-load file `(<span style="color: #a020f0;">progn</span> ,@after-body)))
      t)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb968401" class="outline-4">
<h4 id="orgb968401"><span class="section-number-4">2.9.2</span> マクロ版</h4>
<div class="outline-text-4" id="text-2-9-2">
<p>
以下はマクロ版です．引数の渡し方が関数と少し違うので要注意です．<br />
</p>

<p>
<a href="https://gist.github.com/3499459">https://gist.github.com/3499459</a><br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defmacro</span> <span style="color: #0000ff;">eval-after-autoload-if-found</span>
    (functions file <span style="color: #228b22;">&amp;optional</span> docstring interactive type <span style="color: #228b22;">&amp;rest</span> after-body)
  <span style="color: #8b2252;">"Set up autoload and eval-after-load for FUNCTIONS iff. FILE has found."</span>
  `(<span style="color: #a020f0;">let*</span> ((functions ,functions)
          (docstring ,docstring)
          (<span style="color: #a020f0;">interactive</span> ,interactive)
          (type ,type)
          (file ,file))
     (<span style="color: #a020f0;">when</span> (locate-library file)
       (mapc (<span style="color: #a020f0;">lambda</span> (func)
               (autoload func file docstring interactive type))
             (<span style="color: #a020f0;">if</span> (listp functions)
                 functions
               (list functions)))
       ,@(<span style="color: #a020f0;">when</span> after-body
           `((eval-after-load file '(<span style="color: #a020f0;">progn</span> ,@after-body))))
       t)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org169e34f" class="outline-3">
<h3 id="org169e34f"><span class="section-number-3">2.10</span> [library-p] load-path にライブラリがあるかを判定</h3>
<div class="outline-text-3" id="text-2-10">
<p>
パッケージが load-path に存在していて使える状態にあるかを調べます．もし存在しなければ，メッセージバッファに [NOT FOUND] を刻みます．<br />
</p>

<p>
<code>libraries</code> には複数を指定でき，すべてが使える状態の場合のみ <code>t</code> が返ります．<br />
</p>

<p>
<code>"org"</code> を渡したり， <code>'("org" "helm")</code> を渡したりできます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">library-p</span> (libraries)
  <span style="color: #8b2252;">"Return `t' when every specified library can be located. "</span>
  (<span style="color: #a020f0;">let</span> ((result t))
    (mapc (<span style="color: #a020f0;">lambda</span> (library)
            (<span style="color: #a020f0;">unless</span> (locate-library library)
              (message <span style="color: #8b2252;">"--- NOT FOUND: %s"</span> library)
              (<span style="color: #a020f0;">setq</span> result nil)))
          (<span style="color: #a020f0;">if</span> (listp libraries)
              libraries
            (list libraries)))
    result))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcd69966" class="outline-3">
<h3 id="orgcd69966"><span class="section-number-3">2.11</span> [passed-clock-p] 指定時刻が本日の未来の時刻かを判定</h3>
<div class="outline-text-3" id="text-2-11">
<p>
今日の時刻に限定して，指定時刻が過去の時間かどうかを判定します． <code>run-at-time</code> が想定通りに動かず，起動時に対象の関数が走ってしまうので，この判定が <code>nil</code> の時だけタイマー登録します． <code>target</code> を HH:MM の書式で与えます．現在時刻を与えた場合は，過ぎ去っていないので <code>nil</code> を返します．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">passed-clock-p</span> (target)
  (<span style="color: #a020f0;">let</span>
      ((hour nil)
       (min nil)
       (current-hour nil)
       (current-min nil))
    (<span style="color: #a020f0;">when</span> (string-match <span style="color: #8b2252;">"</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">(</span><span style="color: #8b2252;">[0-2]?[0-9]</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">)</span><span style="color: #8b2252;">:</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">(</span><span style="color: #8b2252;">[0-5][0-9]</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">)</span><span style="color: #8b2252;">"</span> target)
      (<span style="color: #a020f0;">setq</span> hour (substring target (match-beginning 1) (match-end 1)))
      (<span style="color: #a020f0;">setq</span> min (substring target (match-beginning 2) (match-end 2)))
      (<span style="color: #a020f0;">setq</span> current-hour (format-time-string <span style="color: #8b2252;">"%H"</span> (current-time)))
      (<span style="color: #a020f0;">setq</span> current-min (format-time-string <span style="color: #8b2252;">"%M"</span> (current-time)))
      (&lt; (+ (* (string-to-number hour) 60)
            (string-to-number min))
         (+ (* (string-to-number current-hour) 60)
            (string-to-number current-min))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org81ab464" class="outline-3">
<h3 id="org81ab464"><span class="section-number-3">2.12</span> [input-focus-p] フォーカス判定</h3>
<div class="outline-text-3" id="text-2-12">
<p>
フォーカスが当たっているのかを判定するための関数です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">window-focus-p</span> t)
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">window-focus-p</span> ()
  (<span style="color: #a020f0;">if</span> window-focus-p t nil))
(add-hook 'focus-in-hook #'(lambda () (<span style="color: #a020f0;">setq</span> window-focus-p t)))
(add-hook 'focus-out-hook #'(lambda () (<span style="color: #a020f0;">setq</span> window-focus-p nil)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3979ddd" class="outline-3">
<h3 id="org3979ddd"><span class="section-number-3">2.13</span> 警告の抑制</h3>
<div class="outline-text-3" id="text-2-13">
<p>
起動時に警告が出てうっとうしい場合に使います．起動直後に呼ばれるように， <code>.emacs</code> の上の方に書いておくとよいと思います．<br />
</p>

<ul class="org-ul">
<li><a href="http://d.hatena.ne.jp/kitokitoki/20100425/p1">http://d.hatena.ne.jp/kitokitoki/20100425/p1</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> byte-compile-warnings
      '(free-vars unresolved callargs redefine obsolete noruntime
                  cl-functions interactive-only make-local))
(<span style="color: #a020f0;">setq</span> ad-redefinition-action 'accept)
</pre>
</div>
</div>
</div>

<div id="outline-container-org733621f" class="outline-3">
<h3 id="org733621f"><span class="section-number-3">2.14</span> エラー表示の抑制</h3>
<div class="outline-text-3" id="text-2-14">
<p>
普段使いでは要らないので抑制します．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> debug-on-error nil)
</pre>
</div>
</div>
</div>

<div id="outline-container-org0108e96" class="outline-3">
<h3 id="org0108e96"><span class="section-number-3">2.15</span> compilation buffer でのデータ表示で自動するスクロールする</h3>
<div class="outline-text-3" id="text-2-15">
<p>
<code>nil</code> のままだと，出力が続いてもスクロールされないので，自動的にスクロールされるように設定．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> compilation-scroll-output t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org884a11e" class="outline-3">
<h3 id="org884a11e"><span class="section-number-3">2.16</span> C-x C-c で容易にEmacsを終了させないように質問する</h3>
<div class="outline-text-3" id="text-2-16">
<p>
<code>y-or-n-p</code> もしくは <code>yes-or-no-p</code> を指定するだけです．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> confirm-kill-emacs 'yes-or-no-p)
</pre>
</div>

<p>
以前は， <code>C-x C-c</code> を以下の関数に割り当てて，任意の質問文で入力を求めていました．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;; </span><span style="color: #b22222;">Cite: http://flex.ee.uec.ac.jp/texi/emacs-jp/emacs-jp_12.html</span>
<span style="color: #b22222;">;;; </span><span style="color: #b22222;">Cite: http://d.hatena.ne.jp/Ubuntu/20090417/1239934416</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">A simple solution is (setq confirm-kill-emacs 'y-or-n-p).</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">confirm-save-buffers-kill-emacs</span> (<span style="color: #228b22;">&amp;optional</span> arg)
  <span style="color: #8b2252;">"Show yes or no when you try to kill Emacs"</span>
  (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"P"</span>)
  (<span style="color: #a020f0;">cond</span> (arg (save-buffers-kill-emacs))
        (t
         (<span style="color: #a020f0;">when</span> (yes-or-no-p <span style="color: #8b2252;">"Are you sure to quit Emacs now? "</span>)
           (save-buffers-kill-emacs)))))
(global-set-key (kbd <span style="color: #8b2252;">"C-x C-c"</span>) 'confirm-save-buffers-kill-emacs)
</pre>
</div>
</div>
</div>

<div id="outline-container-org77b0b47" class="outline-3">
<h3 id="org77b0b47"><span class="section-number-3">2.17</span> [shut-up.el] Messages 出力を封じる（制御する）</h3>
<div class="outline-text-3" id="text-2-17">
<p>
<code>shut-up.el</code> というマクロがあり，現在はそちらを使っています．非常に強力です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">shutup-p</span> (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">shut-up</span> nil t) t))
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">hoge</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">if</span> shut-up-p
      (<span style="color: #a020f0;">shut-up</span> (recentf-save-list))
    (recentf-save-list)))
</pre>
</div>

<p>
以下はそれ以前のアプローチ． <code>recentf-save-list</code> を <code>find-file-hook</code> にぶら下げていますが，そのままだと <code>org-agenda</code> の初回実行時にたくさんのメッセージが出てしまうところ，このマクロを介すだけで抑制可能です． <code>message-log-max</code> で制御できるのがすごい．<br />
</p>

<ul class="org-ul">
<li><a href="http://qiita.com/itiut@github/items/d917eafd6ab255629346">Emacs - エコーエリアや <b>Messages</b> バッファにメッセージを表示させたくない - Qiita</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12513;&#12483;&#12475;&#12540;&#12472;&#12496;&#12483;&#12501;&#12449;&#12398;&#38263;&#12373;</span>
(<span style="color: #a020f0;">setq</span> message-log-max 5000)

(<span style="color: #a020f0;">defmacro</span> <span style="color: #0000ff;">with-suppressed-message</span> (<span style="color: #228b22;">&amp;rest</span> body)
  <span style="color: #8b2252;">"Suppress new messages temporarily in the echo area and the `</span><span style="color: #008b8b;">*Messages*</span><span style="color: #8b2252;">' buffer while BODY is evaluated."</span>
  (<span style="color: #a020f0;">declare</span> (indent 0))
  (<span style="color: #a020f0;">let</span> ((message-log-max nil))
    `(<span style="color: #a020f0;">with-temp-message</span> (<span style="color: #a020f0;">or</span> (current-message) <span style="color: #8b2252;">""</span>) ,@body)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga6e655b" class="outline-3">
<h3 id="orga6e655b"><span class="section-number-3">2.18</span> エンターキーの挙動</h3>
<div class="outline-text-3" id="text-2-18">
<p>
好みの問題ですかね．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (global-set-key (kbd <span style="color: #8b2252;">"RET"</span>) 'electric-newline-and-maybe-indent))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5969dae" class="outline-3">
<h3 id="org5969dae"><span class="section-number-3">2.19</span> コマンド入力中に入力過程をミニバッファに反映する</h3>
<div class="outline-text-3" id="text-2-19">
<p>
標準値は <code>1</code> です．例えば， <code>C-c f r</code> で発動する関数があるとき， <code>C-c</code> を入力するとその直後にはミニバッファに何も表示されませんが， <code>echo-keystrokes</code> だけ経過すると， <code>C-c</code> が表示されます． <code>0</code> に設定すると，いくら経過しても何も表示しません．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> echo-keystrokes 0.5)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orga43d888" class="outline-2">
<h2 id="orga43d888"><span class="section-number-2">3</span> コア設定</h2>
<div class="outline-text-2" id="text-3">
<p>
Emacs を操作して文書編集する上で欠かせない設定です．<br />
</p>
</div>

<div id="outline-container-org4ed8d78" class="outline-3">
<h3 id="org4ed8d78"><span class="section-number-3">3.1</span> 言語／文字コード</h3>
<div class="outline-text-3" id="text-3-1">
<p>
徹底的にUTF-8に合わせます．<br />
</p>

<p>
<code>save-buffer-coding-system</code> を設定すると， <code>buffer-file-coding-system</code> の値を無視して，指定した <code>save-buffer-coding-system</code> の値でバッファを保存する．つまり， <code>buffer-file-coding-system</code> に統一するなら設定不要．<br />
</p>

<p>
<code>set-default-coding-systems</code> か <code>prefer-coding-system</code> を設定すると，同時に <code>file-name-coding-system=，=set-terminal-coding-system=，=set-keyboard-coding-system</code> も同時に設定される．=prefer-coding-system= は，文字コード自動判定の最上位判定項目を設定する．<br />
</p>

<p>
<code>set-buffer-file-coding-system</code> は，Xとのデータやりとりを設定する．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(prefer-coding-system 'utf-8-unix)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(set-language-environment "Japanese") ;; will take 20-30[ms]</span>
(set-locale-environment <span style="color: #8b2252;">"en_US.UTF-8"</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">"ja_JP.UTF-8"</span>
(set-default-coding-systems 'utf-8-unix)
(set-selection-coding-system 'utf-8-unix)
(set-buffer-file-coding-system 'utf-8-unix)
</pre>
</div>
</div>
</div>

<div id="outline-container-org00714c5" class="outline-3">
<h3 id="org00714c5"><span class="section-number-3">3.2</span> 日本語入力</h3>
<div class="outline-text-3" id="text-3-2">
<p>
NSビルド用のインラインパッチを適用している場合に使います．Lion でも使える自分用にカスタマイズした <a href="https://gist.github.com/1532344">inline-patch</a> を使っています．<br />
</p>

<ul class="org-ul">
<li>Emacs24用には，Mavericks対応した<a href="https://gist.github.com/takaxp/9658281">パッチ</a>を使っています．<br /></li>
<li>Emacs24.5用は<a href="https://gist.github.com/takaxp/1d91107b311b63b57529">こちら</a>．<br /></li>
<li>Emacs25.2用は<a href="https://gist.github.com/takaxp/3314a153f6d02d82ef1833638d338ecf">こちら</a>．<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (fboundp 'mac-add-key-passed-to-system)
  (<span style="color: #a020f0;">setq</span> default-input-method <span style="color: #8b2252;">"MacOSX"</span>)
  (mac-add-key-passed-to-system 'shift))

(<span style="color: #a020f0;">when</span> (eq system-type 'gnu/linux)
  (global-set-key (kbd <span style="color: #8b2252;">"&lt;hiragana-katakana&gt;"</span>) 'toggle-input-method)
  (<span style="color: #a020f0;">push</span> <span style="color: #8b2252;">"/usr/share/emacs/site-lisp/anthy"</span> load-path)
  (<span style="color: #a020f0;">push</span> <span style="color: #8b2252;">"/usr/share/emacs/site-lisp/emacs-mozc"</span> load-path)
  (set-language-environment <span style="color: #8b2252;">"Japanese"</span>)

  (<span style="color: #a020f0;">if</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">mozc</span> nil t)
      (<span style="color: #a020f0;">progn</span>
        (<span style="color: #a020f0;">setq</span> default-input-method <span style="color: #8b2252;">"japanese-mozc"</span>)
        (custom-set-variables
         '(mozc-candidate-style 'overlay)))

    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">anthy</span> nil t) <span style="color: #b22222;">;; </span><span style="color: #b22222;">sudo yum install emacs-anthy-el</span>
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">if get error</span>
      (load-file <span style="color: #8b2252;">"/usr/share/emacs/site-lisp/anthy/leim-list.el"</span>)
      (<span style="color: #a020f0;">setq</span> default-input-method 'japanese-anthy))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org9f59eb1" class="outline-3">
<h3 id="org9f59eb1"><span class="section-number-3">3.3</span> [ag.el] 検索</h3>
<div class="outline-text-3" id="text-3-3">
<p>
検索には <code>The Silver Searcher</code> を使います．あらかじめインストールしておく必要があります．MacPorts の場合，the_silver_searcher の名称で頒布されています． <code>exec-path</code> に <code>/opt/local/bin</code> が含まれていることを確認してください．<br />
</p>

<div class="org-src-container">
<pre class="src src-sh">the_silver_searcher @0.18.1 (textproc)
 A code-searching tool similar to ack, but faster.
</pre>
</div>


<p>
カスタマイズした関数を <code>C-M-f</code> にぶら下げています．helm インタフェースを使う <code>helm-ag</code> もあります．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (executable-find <span style="color: #8b2252;">"ag"</span>)
           (autoload-if-found
            '(my-ag ag)
            <span style="color: #8b2252;">"ag"</span> nil t))

  (autoload-if-found '(helm-ag) <span style="color: #8b2252;">"helm-ag"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-M-f"</span>) 'my-ag))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"ag"</span>
    (custom-set-variables
     '(ag-highlight-search t)
     '(ag-reuse-buffers t)    <span style="color: #b22222;">;; </span><span style="color: #b22222;">nil: &#21029;&#12454;&#12451;&#12531;&#12489;&#12454;&#12364;&#38283;&#12367;</span>
     '(ag-reuse-window nil))  <span style="color: #b22222;">;; </span><span style="color: #b22222;">nil: &#32080;&#26524;&#12434;&#36984;&#25246;&#26178;&#12395;&#21029;&#12454;&#12451;&#12531;&#12489;&#12454;&#12395;&#32080;&#26524;&#12434;&#20986;&#12377;</span>

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">q &#12391;&#12454;&#12451;&#12531;&#12489;&#12454;&#12434;&#25244;&#12369;&#12427;</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(define-key ag-mode-map (kbd "q") 'delete-window)</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-ag</span> ()
      <span style="color: #8b2252;">"&#33258;&#21205;&#30340;&#12395;&#20986;&#21147;&#12496;&#12483;&#12501;&#12449;&#12395;&#31227;&#21205;"</span>
      (<span style="color: #a020f0;">interactive</span>)
      (call-interactively 'ag)
      (switch-to-buffer-other-frame <span style="color: #8b2252;">"*ag search*"</span>))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd39b233" class="outline-3">
<h3 id="orgd39b233"><span class="section-number-3">3.4</span> 基本キーバインド</h3>
<div class="outline-text-3" id="text-3-4">
<p>
次の機能にキーバインドを設定する．<br />
</p>

<ul class="org-ul">
<li>Cmd+V でペースト（Mac用）<br /></li>
<li>Cmd と Option を逆にする（Mac用）<br /></li>
<li>削除<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">when</span> (memq window-system '(mac ns))
    (global-set-key (kbd <span style="color: #8b2252;">"M-v"</span>) 'yank)
    (<span style="color: #a020f0;">when</span> (boundp 'ns-command-modifier)
      (<span style="color: #a020f0;">setq</span> ns-command-modifier 'meta))
    (<span style="color: #a020f0;">when</span> (boundp 'ns-alternate-modifier)
      (<span style="color: #a020f0;">setq</span> ns-alternate-modifier 'super))
    (<span style="color: #a020f0;">when</span> (boundp 'ns-pop-up-frames)
      (<span style="color: #a020f0;">setq</span> ns-pop-up-frames nil))
    (global-set-key [ns-drag-file] 'ns-find-file)) <span style="color: #b22222;">; </span><span style="color: #b22222;">D&amp;D for Emacs23</span>

  (global-set-key [delete] 'delete-char)
  (global-set-key [kp-delete] 'delete-char))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcd3600b" class="outline-3">
<h3 id="orgcd3600b"><span class="section-number-3">3.5</span> ナローイングするか</h3>
<div class="outline-text-3" id="text-3-5">
<p>
ナローイングを有効にします．ナローイングを知らないユーザが「データが消えた！」と勘違いしないように，デフォルトでは無効になっています．<br />
</p>

<p>
Org Mode でナローイングを使う場合は，特に設定しなくてもOKです．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(put 'narrow-to-region 'disabled nil)
</pre>
</div>

<p>
<code>fancy-narrow</code> を使うと，通常のナローイングではバッファ上で表示しなくなる領域を目立たないように残すことができます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(autoload-if-found
 '(fancy-narrow-to-region
   fancy-widen
   org-fancy-narrow-to-block
   org-fancy-narrow-to-element
   org-fancy-narrow-to-subtree)
 <span style="color: #8b2252;">"fancy-narrow"</span> nil t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org1a6a047" class="outline-3">
<h3 id="org1a6a047"><span class="section-number-3">3.6</span> バッファの終わりでのnewlineを禁止する</h3>
<div class="outline-text-3" id="text-3-6">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Avoid adding a new line at the end of buffer</span>
(<span style="color: #a020f0;">setq</span> next-line-add-newlines nil)
</pre>
</div>
</div>
</div>

<div id="outline-container-org7e8d1b9" class="outline-3">
<h3 id="org7e8d1b9"><span class="section-number-3">3.7</span> 常に最終行に一行追加する</h3>
<div class="outline-text-3" id="text-3-7">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Limit the final word to a line break code (automatically correct)</span>
(<span style="color: #a020f0;">setq</span> require-final-newline t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org423af91" class="outline-3">
<h3 id="org423af91"><span class="section-number-3">3.8</span> 長い文章を右端で常に折り返す</h3>
<div class="outline-text-3" id="text-3-8">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> truncate-lines nil)
(<span style="color: #a020f0;">setq</span> truncate-partial-width-windows nil)
</pre>
</div>
</div>
</div>

<div id="outline-container-org53b71e7" class="outline-3">
<h3 id="org53b71e7"><span class="section-number-3">3.9</span> バッファが外部から編集された場合に自動で再読み込みする</h3>
<div class="outline-text-3" id="text-3-9">
<p>
<code>auto-save-buffers</code> を使っていれば，バッファは常に保存された状態になるため， revert が即座に反映されます．適宜バックアップツールと組み合わせないと，バッファが自動更新されてしまうので不安かもしれません．<br />
</p>

<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">unless</span> batch-build
    (postpone-message <span style="color: #8b2252;">"global-auto-revert-mode"</span>)
    (global-auto-revert-mode 1)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org31e91fd" class="outline-3">
<h3 id="org31e91fd"><span class="section-number-3">3.10</span> [uniquify.el] 同じバッファ名が開かれた場合に区別する</h3>
<div class="outline-text-3" id="text-3-10">
<p>
ビルトインの <code>uniquify</code> を使います．モードラインの表示が変わります．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> uniquify-buffer-name-style 'post-forward-angle-brackets)
</pre>
</div>
</div>
</div>

<div id="outline-container-org0d44efe" class="outline-3">
<h3 id="org0d44efe"><span class="section-number-3">3.11</span> マウスで選択した領域を自動コピー</h3>
<div class="outline-text-3" id="text-3-11">
<p>
マウスで選択すると，勝手にペーストボードにデータが流れます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> mouse-drag-copy-region t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org901ec2d" class="outline-3">
<h3 id="org901ec2d"><span class="section-number-3">3.12</span> マウススクロールをピクセル単位にする</h3>
<div class="outline-text-3" id="text-3-12">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">when</span> (fboundp 'pixel-scroll-mode)
    (pixel-scroll-mode 1))) <span style="color: #b22222;">;; </span><span style="color: #b22222;">26.1</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgca5dbb8" class="outline-3">
<h3 id="orgca5dbb8"><span class="section-number-3">3.13</span> パッケージ管理</h3>
<div class="outline-text-3" id="text-3-13">
<p>
<a href="https://github.com/cask/cask">Cask</a>+Palletの環境を採用しました．それまでは，特定のディレクトリに必要な elisp をダウンロードしておいたり，git から取り寄せて，それらをload-pathに設定するスクリプトを準備するなど，個人的なルールで運用してきましたが，希望の機能をCaskが提供しているので，Emacs24.4になるタイミングで移行しました．<br />
</p>

<p>
ただし，頒布元が危ういようなファイルはやはり個人で管理しておきたいので，Caskで管理する対象は，MEPLA経由で入手可能なメンテナンスが行き届いたパッケージに限定しています．また，普通の使い方（casl.elを読み込んで初期化）をしていると，起動時に少し時間を要するので，所定のディレクトリにCaskで取り寄せたすべてのファイルをコピーして，そのディレクトリだけをload-pathで指定するという使い方もしています．今のところ大きな問題は生じていません．<br />
</p>
</div>

<div id="outline-container-org983ddba" class="outline-4">
<h4 id="org983ddba"><span class="section-number-4">3.13.1</span> [cask-mode.el] モード設定</h4>
<div class="outline-text-4" id="text-3-13-1">
<ul class="org-ul">
<li><a href="https://github.com/Wilfred/cask-mode">Wilfred/cask-mode: Major mode for editing Cask files</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found '(cask-mode) <span style="color: #8b2252;">"cask-mode"</span> nil t)
  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"/Cask\\'"</span> . cask-mode) auto-mode-alist))
</pre>
</div>
</div>
</div>

<div id="outline-container-org2906581" class="outline-4">
<h4 id="org2906581"><span class="section-number-4">3.13.2</span> Cask のセットアップ</h4>
<div class="outline-text-4" id="text-3-13-2">
<p>
以下は自分用のメモです．<br />
</p>

<ol class="org-ol">
<li>curl -fsSkL <a href="https://raw.github.com/cask/cask/master/go">https://raw.github.com/cask/cask/master/go</a> | python<br /></li>
<li>~/.cask/bin に PATH を通す (see .zshenv, export PATH="${HOME}/.cask/bin:{$PATH}")<br /></li>
<li>cask upgrade<br /></li>
<li>cd ~/.emacs.d<br /></li>
<li>cask init            ;; ~/.emacs.d/Cask が存在しない場合だけ実行<br /></li>
<li>cask install<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org4e5abdf" class="outline-4">
<h4 id="org4e5abdf"><span class="section-number-4">3.13.3</span> load-path を一箇所にして起動を高速化</h4>
<div class="outline-text-4" id="text-3-13-3">
<p>
Caskを使うと，個々のパッケージが独立にload-pathに設定されます．これにより依存関係がスッキリするわけですが，数が増えると起動時間が遅くなります．重いです．自分の例では，800[ms]のオーバーヘッドでした．これを避けるには，load-pathを一箇所に集約することが効きます．オーバーヘッドは約100[ms]まで削減できました．場合によっては依存関係に問題が生じる可能性がありますが，今のところは問題になっていません．<br />
</p>

<ol class="org-ol">
<li><code>~/.emacs.d/.cask/package/&lt;emacs-version&gt;</code> なるフォルダを作る<br /></li>
<li><code>~/.emacs.d/.cask/24.4.1/elpa/*/*</code> と <code>~/.emacs.d/.cask/24.4.1/elpa/*/lisp/*</code> をすべて上記フォルダにコピー<br /></li>
<li><code>~/.emacs</code> で， <code>~/.emacs.d/.cask/package/&lt;emacs-version&gt;</code> を load-path に設定し，Caskは読み込まない<br /></li>
</ol>

<p>
<code>M-x lis-packges</code> を使って新しいパッケージをインストールする時だけ，以下のフラグを nil に書き換えてEmacsを起動します． <code>load-path-setter</code> は独自関数です（普通に <code>add-to-list</code> で追加するのと同じです）<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">cask-package-dir</span>
  (format <span style="color: #8b2252;">"~/.emacs.d/.cask/package/%s"</span> emacs-version))
(<span style="color: #a020f0;">if</span> t
    (load-path-setter `(,cask-package-dir) 'load-path)
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">or</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">cask</span> <span style="color: #8b2252;">"~/.cask/cask.el"</span> t)
            (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">cask</span> <span style="color: #8b2252;">"/usr/local/opt/cask/cask.el"</span> t)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">Homebrew</span>
    (<span style="color: #a020f0;">when</span> (fboundp 'cask-initialize) (cask-initialize))) <span style="color: #b22222;">;; </span><span style="color: #b22222;">800[ms]</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">pallet</span> nil t)
    (<span style="color: #a020f0;">when</span> (fboundp 'pallet-mode) (pallet-mode t))))
</pre>
</div>

<p>
Cask で新しいパッケージを導入したり，既存のパッケージを更新したら，その都度，package ディレクトリにコピーします．手動でやると面倒なので，次のようなスクリプトで対処します．アルファリリースなどに対応するときなど，少し調整が必要です．<br />
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #b22222;">#</span><span style="color: #b22222;">!/bin/</span><span style="color: #a020f0;">sh</span>

<span style="color: #b22222;"># </span><span style="color: #b22222;">Required setting: alias emacs='/Applications/Emacs.app/Contents/MacOS/Emacs'</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">exec cd ~/.emacs.d &amp;&amp; cask upgrade-cask if you upgrade cask itself.</span>

<span style="color: #a0522d;">CASKPATH</span>=~/.emacs.d/.cask
<span style="color: #b22222;">#</span><span style="color: #b22222;">VERSION=24.5.1</span>
<span style="color: #b22222;">#</span><span style="color: #b22222;">VERSION=25.0.95.1</span>
<span style="color: #a0522d;">VERSION</span>=25.2
<span style="color: #b22222;">#</span><span style="color: #b22222;">VERSION=25.1.90.1</span>
<span style="color: #a0522d;">SUBDIR</span>=package/$<span style="color: #a0522d;">VERSION</span>
<span style="color: #a0522d;">BACKUPDIR</span>=~/Dropbox/backup
<span style="color: #a0522d;">EMACS</span>=<span style="color: #ff00ff;">`which emacs`</span>
<span style="color: #a020f0;">if</span> [ $<span style="color: #a0522d;">HOSTTYPE</span> = <span style="color: #8b2252;">"intel-mac"</span> ]; <span style="color: #a020f0;">then</span>
<span style="color: #a0522d;">EMACS</span>=/Applications/Emacs.app/Contents/MacOS/Emacs
<span style="color: #a020f0;">fi</span>
<span style="color: #b22222;"># </span><span style="color: #b22222;">COMMAND="$EMACS -batch -q -l ~/.emacs -f batch-byte-compile";</span>
<span style="color: #a020f0;">if</span> [ -d <span style="color: #8b2252;">"$CASKPATH/$SUBDIR"</span> ]; <span style="color: #a020f0;">then</span>
    <span style="color: #483d8b;">echo</span> <span style="color: #8b2252;">"--- Removing $CASKPATH/$SUBDIR"</span>
    rm -r <span style="color: #8b2252;">"$CASKPATH/$SUBDIR"</span>
<span style="color: #a020f0;">else</span>
    <span style="color: #483d8b;">echo</span> <span style="color: #8b2252;">"--- Target dir does NOT exist ($CASKPATH/$SUBDIR)."</span>
    <span style="color: #a020f0;">exit</span>
<span style="color: #a020f0;">fi</span>
mkdir -p $<span style="color: #a0522d;">CASKPATH</span>/$<span style="color: #a0522d;">SUBDIR</span>

<span style="color: #483d8b;">cd</span> ~/.emacs.d
<span style="color: #483d8b;">echo</span> <span style="color: #8b2252;">"--- Cask install"</span>
<span style="color: #a0522d;">EMACS</span>=<span style="color: #8b2252;">"/Applications/Emacs.app/Contents/MacOS/Emacs"</span> cask install

<span style="color: #483d8b;">echo</span> <span style="color: #8b2252;">"--- Cask update"</span>
<span style="color: #a0522d;">EMACS</span>=<span style="color: #8b2252;">"/Applications/Emacs.app/Contents/MacOS/Emacs"</span> cask update

<span style="color: #b22222;"># </span><span style="color: #b22222;">echo "--- Removing org-mode installed by Cask unexpectedly"</span>
/bin/rm -rf ~/.emacs.d/.cask/$<span style="color: #a0522d;">VERSION</span>/elpa/org-20*

<span style="color: #483d8b;">echo</span> <span style="color: #8b2252;">"--- Copying elisp files"</span>
/bin/cp -rf ~/.emacs.d/.cask/$<span style="color: #a0522d;">VERSION</span>/elpa/*/* $<span style="color: #a0522d;">CASKPATH</span>/$<span style="color: #a0522d;">SUBDIR</span>
/bin/cp -rf ~/.emacs.d/.cask/$<span style="color: #a0522d;">VERSION</span>/elpa/*/lisp/* $<span style="color: #a0522d;">CASKPATH</span>/$<span style="color: #a0522d;">SUBDIR</span>
<span style="color: #483d8b;">cd</span> $<span style="color: #a0522d;">CASKPATH</span>/$<span style="color: #a0522d;">SUBDIR</span>
rm -rf ./*~

<span style="color: #483d8b;">echo</span> <span style="color: #8b2252;">"--- Done"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb6bdc16" class="outline-4">
<h4 id="orgb6bdc16"><span class="section-number-4">3.13.4</span> [paradox.el] パッケージ選択画面の改善</h4>
<div class="outline-text-4" id="text-3-13-4">
<p>
パッケージインストール用のバッファが多機能になります．スターが表示されたり，ミニバッファには様々な情報が表示されるようになります．基本の操作系は同じで，拡張部分は <code>h</code> を押すとミニバッファにディスパッチャが表示されます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(paradox-list-packages my-list-packages my-setup-cask)
       <span style="color: #8b2252;">"paradox"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"paradox"</span>
    (custom-set-variables
     '(paradox-github-token t))
    (<span style="color: #a020f0;">when</span> (fboundp 'paradox-enable)
      (paradox-enable))))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org207097e" class="outline-3">
<h3 id="org207097e"><span class="section-number-3">3.14</span> インデント</h3>
<div class="outline-text-3" id="text-3-14">
<p>
オープンソース等で他の人のコードを修正する場合は，以下のような設定は良くないかもしれません．例えば差分を取ると見た目は変わらないのに，タブとスペースの違いから差分ありと判定されてしまい，意図しない編集履歴が残ることがあります．ただこの問題は，修正対象のファイルが限定されているならば， <code>M-x tabify</code> や <code>M-x untabify</code> で回避できそうです．<br />
</p>

<p>
一方， <code>org-mode</code> のソースブロックは半角スペース統一されているため，この設定のほうが都合が良いです．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq-default</span> tab-width 2)
(<span style="color: #a020f0;">setq-default</span> indent-tabs-mode nil)
(<span style="color: #a020f0;">setq</span> indent-line-function 'insert-tab)

<span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-hook 'emacs-lisp-mode-hook</span>
<span style="color: #b22222;">;;           </span><span style="color: #b22222;">'(lambda ()</span>
<span style="color: #b22222;">;;              </span><span style="color: #b22222;">(setq indent-tabs-mode t)</span>
<span style="color: #b22222;">;;              </span><span style="color: #b22222;">(setq tab-width 8)</span>
<span style="color: #b22222;">;;              </span><span style="color: #b22222;">(setq indent-line-function 'lisp-indent-line)))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org14c7a16" class="outline-3">
<h3 id="org14c7a16"><span class="section-number-3">3.15</span> [aggressive-indent] 即時バッファ整形</h3>
<div class="outline-text-3" id="text-3-15">
<p>
特定のメジャーモードで，とにかく整形しまくります． <code>python-mode</code> では意図しないインデントになったりします． <code>web-mode</code> だと異常に重かったりします．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(aggressive-indent-mode)
       <span style="color: #8b2252;">"aggressive-indent"</span> nil t)

  (<span style="color: #a020f0;">dolist</span>
      (hook
       '(<span style="color: #b22222;">;; </span><span style="color: #b22222;">python-mode-hook</span>
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">nxml-mode-hook</span>
         <span style="color: #b22222;">;; </span><span style="color: #b22222;">web-mode-hook</span>
         emacs-lisp-mode-hook
         lisp-mode-hook perl-mode-hook c-mode-common-hook))
    (add-hook hook #'aggressive-indent-mode)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbd41594" class="outline-3">
<h3 id="orgbd41594"><span class="section-number-3">3.16</span> [ws-butler.el] 不要なスペースを自動除去</h3>
<div class="outline-text-3" id="text-3-16">
<p>
行末のスペース等が不要に残るのを回避できます．バッファ保存時の自動処理です．<br />
</p>

<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(ws-butler-mode ws-butler-global-mode)
       <span style="color: #8b2252;">"ws-butler"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"ws-butler"</span>
    (custom-set-variables
     '(ws-butler-global-exempt-modes
       (append '(org-mode empty-booting-mode)
               ws-butler-global-exempt-modes))))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"ws-butler-global-mode"</span>)
      (ws-butler-global-mode))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0f62eb7" class="outline-3">
<h3 id="org0f62eb7"><span class="section-number-3">3.17</span> ファイルリンクを辿る時に確認のメッセージを出さない</h3>
<div class="outline-text-3" id="text-3-17">
<p>
そのまま辿ってファイルオープンします．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> vc-follow-symlinks t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org3567b01" class="outline-3">
<h3 id="org3567b01"><span class="section-number-3">3.18</span> EMPビルド用設定</h3>
<div class="outline-text-3" id="text-3-18">
<p>
NSビルド版で生じた日本語入力時のチラつきを避けるために，EMP版ビルドに(一時期)浮気しました．以下はその時にNSビルドの振る舞いに近づけるためにがんばった設定です．詳細な情報は，リンク先の記事にあります．<br />
</p>

<ul class="org-ul">
<li><a href="http://qiita.com/takaxp/items/a86ee2aacb27c7c3a902">Emacs 25.1/25.2 を EMP版で快適に使う - Qiita</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (eq window-system 'mac)
  (mac-auto-ascii-mode 1)

  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">mac-win-last-ime-status</span> 'off) <span style="color: #b22222;">;; </span><span style="color: #b22222;">{'off|'on}</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">mac-win-save-last-ime-status</span> ()
    (<span style="color: #a020f0;">setq</span> mac-win-last-ime-status
          (<span style="color: #a020f0;">if</span> (string-match <span style="color: #8b2252;">"\\.</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">(</span><span style="color: #8b2252;">Roman</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">|</span><span style="color: #8b2252;">US</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">)</span><span style="color: #8b2252;">$"</span> (mac-input-source))
              'off 'on)))
  (mac-win-save-last-ime-status) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21021;&#26399;&#21270;</span>

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">mac-win-restore-ime</span> ()
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> mac-auto-ascii-mode
               (eq mac-win-last-ime-status 'on))
      (mac-select-input-source
       <span style="color: #8b2252;">"com.google.inputmethod.Japanese.base"</span>)))

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:mac-auto-ascii-setup-input-source</span> (<span style="color: #228b22;">&amp;optional</span> _prompt)
    <span style="color: #8b2252;">"Extension to store IME status"</span>
    (mac-win-save-last-ime-status))
  (advice-add 'mac-auto-ascii-setup-input-source <span style="color: #483d8b;">:before</span>
              #'advice:mac-auto-ascii-setup-input-source)

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">mac-win-restore-ime-target-commands</span> ()
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> mac-auto-ascii-mode
               (eq mac-win-last-ime-status 'on))
      (mapc (<span style="color: #a020f0;">lambda</span> (command)
              (<span style="color: #a020f0;">when</span> (string-match
                     (format <span style="color: #8b2252;">"^%s"</span> command) (format <span style="color: #8b2252;">"%s"</span> this-command))
                (mac-select-input-source
                 <span style="color: #8b2252;">"com.google.inputmethod.Japanese.base"</span>)))
            mac-win-target-commands)))

  (add-hook 'pre-command-hook #'mac-win-restore-ime-target-commands)

  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">mac-win-target-commands</span>
    '(find-file save-buffer other-window delete-window split-window))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12496;&#12483;&#12501;&#12449;&#12522;&#12473;&#12488;&#12434;&#35211;&#12427;&#12392;&#12365;</span>
  (add-to-list 'mac-win-target-commands 'helm-buffers-list)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">ChangeLog&#12395;&#34892;&#12367;&#12392;&#12365;</span>
  (add-to-list 'mac-win-target-commands 'add-change-log-entry-other-window)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20491;&#20154;&#29992;&#12398;&#38306;&#25968;&#12434;&#20351;&#12358;&#12392;&#12365;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-to-list 'mac-win-target-commands 'my-)</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#33258;&#20998;&#12391;&#20316;&#12387;&#12383;&#12497;&#12483;&#12465;&#12540;&#12472;&#32676;&#12398;&#38306;&#25968;&#12434;&#20351;&#12358;&#12392;&#12365;</span>
  (add-to-list 'mac-win-target-commands 'change-frame)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">org-mode &#12391;&#32224;&#12417;&#20999;&#12426;&#12434;&#35373;&#23450;&#12377;&#12427;&#12392;&#12365;&#65294;</span>
  (add-to-list 'mac-win-target-commands 'org-deadline)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">org-mode &#12391;&#32224;&#12417;&#20999;&#12426;&#12434;&#35373;&#23450;&#12377;&#12427;&#12392;&#12365;&#65294;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-to-list 'mac-win-target-commands 'org-capture)</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">query-replace &#12391;&#22793;&#25563;&#12377;&#12427;&#12392;&#12365;</span>
  (add-to-list 'mac-win-target-commands 'query-replace)

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12511;&#12491;&#12496;&#12483;&#12501;&#12449;&#21033;&#29992;&#24460;&#12395;IME&#12434;&#25147;&#12377;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x &#12391;&#12398;&#12467;&#12510;&#12531;&#12489;&#36984;&#25246;&#12391;IME&#12434;&#25147;&#12379;&#12427;&#65294;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12371;&#12428;&#31227;&#21205;&#20808;&#12391; q &#12364;&#21177;&#12363;&#12394;&#12356;&#12371;&#12392;&#12364;&#12354;&#12427;</span>
  (add-hook 'minibuffer-setup-hook #'mac-win-save-last-ime-status)
  (add-hook 'minibuffer-exit-hook #'mac-win-restore-ime)

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12479;&#12452;&#12488;&#12523;&#12496;&#12540;&#12398;&#25391;&#12427;&#33310;&#12356;&#12434; NS&#29256;&#12395;&#21512;&#12431;&#12379;&#12427;&#65294;</span>
  (<span style="color: #a020f0;">setq</span> frame-title-format (format (<span style="color: #a020f0;">if</span> (buffer-file-name) <span style="color: #8b2252;">"%%f"</span> <span style="color: #8b2252;">"%%b"</span>)))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12394;&#12362;&#12486;&#12540;&#12510;&#12434;&#20999;&#12426;&#26367;&#12360;&#12383;&#12425;&#65292;face &#12398;&#35373;&#23450;&#12434;&#12522;&#12525;&#12540;&#12489;&#12375;&#12394;&#12356;&#12392;&#26399;&#24453;&#36890;&#12426;&#12395;&#12394;&#12425;&#12394;&#12356;</span>
  (custom-set-faces
   <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22793;&#25563;&#21069;&#20837;&#21147;&#26178;&#12398;&#25991;&#23383;&#21015;&#29992; face</span>
   `(mac-ts-converted-text
     ((((background dark)) <span style="color: #483d8b;">:underline</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #ffa500;">orange</span><span style="color: #8b2252;">"</span>
       <span style="color: #483d8b;">:background</span> ,(face-attribute 'hl-line <span style="color: #483d8b;">:background</span>))
      (t (<span style="color: #483d8b;">:underline</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #ffa500;">orange</span><span style="color: #8b2252;">"</span>
                     <span style="color: #483d8b;">:background</span> ,(face-attribute 'hl-line <span style="color: #483d8b;">:background</span>)))))
   <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#22793;&#25563;&#23550;&#35937;&#12398;&#25991;&#23383;&#21015;&#29992; face</span>
   `(mac-ts-selected-converted-text
     ((((background dark)) <span style="color: #483d8b;">:underline</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #ffa500;">orange</span><span style="color: #8b2252;">"</span>
       <span style="color: #483d8b;">:background</span> ,(face-attribute 'hl-line <span style="color: #483d8b;">:background</span>))
      (t (<span style="color: #483d8b;">:underline</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #ffa500;">orange</span><span style="color: #8b2252;">"</span>
                     <span style="color: #483d8b;">:background</span> ,(face-attribute 'hl-line <span style="color: #483d8b;">:background</span>))))))

  (<span style="color: #a020f0;">when</span> (fboundp 'mac-input-source)
    (run-with-idle-timer 3 t 'my-mac-keyboard-input-source))


  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12354;&#12414;&#12426;&#12424;&#12356;&#12450;&#12503;&#12525;&#12540;&#12481;&#12391;&#12399;&#28961;&#12356;&#27671;&#12364;&#12377;&#12427;&#12369;&#12393;&#65292;org-heading &#19978;&#12392;agenda&#12391;&#12399;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">1&#31186;&#12450;&#12452;&#12489;&#12523;&#12377;&#12427;&#12392;&#65292;&#33258;&#21205;&#30340;&#12395; IME &#12434; OFF &#12395;&#12377;&#12427;</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-mac-win-org-heading-auto-ascii</span> ()
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (eq major-mode 'org-mode)
               (<span style="color: #a020f0;">or</span> (looking-at org-heading-regexp)
                   (equal (buffer-name) org-agenda-buffer-name)))
      (<span style="color: #a020f0;">setq</span> mac-win-last-ime-status 'off)
      (mac-auto-ascii-select-input-source)))
  (<span style="color: #a020f0;">when</span> (fboundp 'mac-auto-ascii-select-input-source)
    (run-with-idle-timer 1 t 'my-mac-win-org-heading-auto-ascii))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">EMP&#29256;Emacs&#12398;&#37326;&#33391;&#12499;&#12523;&#12489;&#29992;&#29420;&#33258;&#35373;&#23450;&#32676;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">IME toggle&#12434; Emacs&#20869;&#12391;&#26377;&#21177;&#12395;&#12377;&#12427;</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">mac-win-ime-toggle</span> ()
    (<span style="color: #a020f0;">interactive</span>)
    (<span style="color: #a020f0;">when</span> (fboundp 'mac-input-source)
      (mac-select-input-source
       (concat <span style="color: #8b2252;">"com.google.inputmethod.Japanese"</span>
               (<span style="color: #a020f0;">if</span> (string-match <span style="color: #8b2252;">"\\.base$"</span> (mac-input-source))
                   <span style="color: #8b2252;">".Roman"</span> <span style="color: #8b2252;">".base"</span>)))))
  (global-set-key (kbd <span style="color: #8b2252;">"M-SPC"</span>) 'mac-win-ime-toggle)
  (global-set-key (kbd <span style="color: #8b2252;">"S-SPC"</span>) 'mac-win-ime-toggle)

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">isearch &#20013;&#12395;IME&#12434;&#20999;&#12426;&#26367;&#12360;&#12427;&#12392;&#65292;[I-Search] &#12398;&#34920;&#31034;&#12364;&#28040;&#12360;&#12427;&#65294;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(define-key isearch-mode-map (kbd "M-SPC") 'mac-win-ime-toggle)</span>
  (define-key isearch-mode-map (kbd <span style="color: #8b2252;">"S-SPC"</span>) 'mac-win-ime-toggle)

  (<span style="color: #a020f0;">setq</span> mac-win-ime-cursor-type my-cursor-type-ime-on)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">minibuffer &#12391;&#12399;&#8593;&#12398;&#32972;&#26223;&#33394;&#12434;&#28961;&#21177;&#12395;&#12377;&#12427;</span>
  (<span style="color: #a020f0;">when</span> (fboundp 'mac-min--minibuffer-setup)
    (add-hook 'minibuffer-setup-hook #'mac-min--minibuffer-setup))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">echo-area &#12391;&#12418;&#32972;&#26223;&#33394;&#12434;&#28961;&#21177;&#12395;&#12377;&#12427;</span>
  (<span style="color: #a020f0;">setq</span> mac-win-default-background-echo-area t) <span style="color: #b22222;">;; </span><span style="color: #b22222;">*-text &#12398; background &#12434;&#28961;&#35222;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12487;&#12496;&#12483;&#12464;&#29992;</span>
  (<span style="color: #a020f0;">setq</span> mac-win-debug-log nil)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Testing...</span>
  (<span style="color: #a020f0;">setq</span> mac-win-apply-org-heading-face t))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfcf9121" class="outline-3">
<h3 id="orgfcf9121"><span class="section-number-3">3.19</span> NSビルド用設定&#xa0;&#xa0;&#xa0;<span class="tag"><span class="Mac">Mac</span></span></h3>
<div class="outline-text-3" id="text-3-19">
<p>
インラインパッチの適用が前提の設定です． <code>M-SPC/S-SPC</code> で日本語IMEのON/OFFができるようになります．インラインパッチの情報はリンク先にあります．<br />
</p>

<ul class="org-ul">
<li><a href="http://qiita.com/takaxp/items/e07bb286d80fa9dd8e05">emacs-25.2 をインラインパッチをあてて使う（OSX） - Qiita</a><br /></li>
<li><a href="https://gist.github.com/takaxp/3314a153f6d02d82ef1833638d338ecf">An inline-patch for Emacs-25.2</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">or</span> (eq window-system 'ns)
            (fboundp 'mac-get-current-input-source))
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">ns-org-heading-auto-ascii</span> ()
      (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> window-focus-p
                 (eq major-mode 'org-mode)
                 (<span style="color: #a020f0;">or</span> (looking-at org-heading-regexp)
                     (equal (buffer-name) org-agenda-buffer-name)))
        (my-ime-off)))

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">ns-ime-toggle</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">when</span> (fboundp 'mac-get-current-input-source)
        (<span style="color: #a020f0;">if</span> (my-ime-active-p) (my-ime-off) (my-ime-on))))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(when (fboundp 'mac-get-current-input-source)</span>
    <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(declare-function ns-ime-auto-correct "init" nil)</span>
    <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(defun ns-ime-auto-correct ()</span>
    <span style="color: #b22222;">;;     </span><span style="color: #b22222;">(interactive)</span>
    <span style="color: #b22222;">;;     </span><span style="color: #b22222;">(if (my-ime-active-p)</span>
    <span style="color: #b22222;">;;         </span><span style="color: #b22222;">(unless (mac-toggle-input-method nil)</span>
    <span style="color: #b22222;">;;           </span><span style="color: #b22222;">(my-ime-on))</span>
    <span style="color: #b22222;">;;       </span><span style="color: #b22222;">(when (mac-toggle-input-method t)</span>
    <span style="color: #b22222;">;;         </span><span style="color: #b22222;">(my-ime-off))))</span>
    <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(add-hook 'focus-in-hook #'ns-ime-auto-correct))</span>

    (global-set-key (kbd <span style="color: #8b2252;">"M-SPC"</span>) 'ns-ime-toggle) <span style="color: #b22222;">;; </span><span style="color: #b22222;">toggle-input-method</span>
    (global-set-key (kbd <span style="color: #8b2252;">"S-SPC"</span>) 'ns-ime-toggle) <span style="color: #b22222;">;; </span><span style="color: #b22222;">toggle-input-method</span>
    (define-key isearch-mode-map (kbd <span style="color: #8b2252;">"M-SPC"</span>) 'ns-ime-toggle)
    (define-key isearch-mode-map (kbd <span style="color: #8b2252;">"S-SPC"</span>) 'ns-ime-toggle)

    (<span style="color: #a020f0;">when</span> (fboundp 'mac-toggle-input-method)
      (run-with-idle-timer 1 t 'ns-org-heading-auto-ascii))))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgbadb001" class="outline-2">
<h2 id="orgbadb001"><span class="section-number-2">4</span> カーソル移動</h2>
<div class="outline-text-2" id="text-4">
<p>
カーソルの移動は，次のポリシーに従っています．デフォルトでは <code>C-v/M-v</code> で上下移動になっていますが， <code>M-v</code> は windows のペーストに対応するので混乱を招くので使っていません．ページスクロールは標準の <code>cua-base.el</code> に記載されています．<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">行移動</td>
<td class="org-left">C-n/C-p</td>
</tr>

<tr>
<td class="org-left">ページ移動（スクロール）</td>
<td class="org-left">M-n/M-p</td>
</tr>

<tr>
<td class="org-left">ウィンドウ移動</td>
<td class="org-left">C-M-n/C-M-p</td>
</tr>

<tr>
<td class="org-left">バッファ切り替え</td>
<td class="org-left">M-]/M-[</td>
</tr>

<tr>
<td class="org-left">バッファ先頭・末尾</td>
<td class="org-left">C-M-t/C-M-b</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-orgfcf90ff" class="outline-3">
<h3 id="orgfcf90ff"><span class="section-number-3">4.1</span> バッファ内のカーソル移動</h3>
<div class="outline-text-3" id="text-4-1">
<p>
先頭に移動，最終行に移動，ページ単位の進む，ページ単位の戻る，行数を指定して移動．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (global-set-key (kbd <span style="color: #8b2252;">"C-M-t"</span>) 'beginning-of-buffer)
  (global-set-key (kbd <span style="color: #8b2252;">"C-M-b"</span>) 'end-of-buffer)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Backward page scrolling instead of M-v</span>
  (global-set-key (kbd <span style="color: #8b2252;">"M-p"</span>) 'scroll-down)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Frontward page scrolling instead of C-v</span>
  (global-set-key (kbd <span style="color: #8b2252;">"M-n"</span>) 'scroll-up)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Move cursor to a specific line</span>
  (global-set-key (kbd <span style="color: #8b2252;">"C-c g"</span>) 'goto-line))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0a95286" class="outline-3">
<h3 id="org0a95286"><span class="section-number-3">4.2</span> バッファ間のカーソル移動</h3>
<div class="outline-text-3" id="text-4-2">
<p>
<code>C-c o</code> でもいいですが，ワンアクションで移動できるようが楽です．次のように双方向で使えるように設定しています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (global-set-key (kbd <span style="color: #8b2252;">"C-M-p"</span>) #'(lambda () (<span style="color: #a020f0;">interactive</span>) (other-window -1)))
  (global-set-key (kbd <span style="color: #8b2252;">"C-M-n"</span>) #'(lambda () (<span style="color: #a020f0;">interactive</span>) (other-window 1))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org528d9de" class="outline-3">
<h3 id="org528d9de"><span class="section-number-3">4.3</span> スクロールを制御</h3>
<div class="outline-text-3" id="text-4-3">
<p>
一行づつスクロールさせます．デフォルトではバッファの端でスクロールすると，半画面移動します．また，上下の端にカーソルがどのくらい近づいたらスクロールとみなすかも指定できます．<br />
</p>

<ul class="org-ul">
<li><a href="http://marigold.sakura.ne.jp/devel/emacs/scroll/index.html">http://marigold.sakura.ne.jp/devel/emacs/scroll/index.html</a><br /></li>
</ul>

<p>
非ASCII文字を扱っているときに一行づつスクロールしない場合は，scroll-conservatively の値を1ではなく大きい数字にすると直るかもしれません．<br />
</p>

<ul class="org-ul">
<li><a href="http://www.emacswiki.org/emacs/SmoothScrolling">http://www.emacswiki.org/emacs/SmoothScrolling</a><br /></li>
</ul>

<p>
scroll-margin を指定すると，カーソルがウィンドウの端から離れた状態でスクロールされます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Scroll window on a line-by-line basis</span>
(<span style="color: #a020f0;">setq</span> scroll-conservatively 1000)
(<span style="color: #a020f0;">setq</span> scroll-step 1)
<span style="color: #b22222;">;;  </span><span style="color: #b22222;">(setq scroll-margin 0) ; default=0</span>
</pre>
</div>

<p>
スクロール時のジャンプが気になる場合は次のパッケージを使うとよいです．<br />
</p>

<ul class="org-ul">
<li><a href="http://adamspiers.org/computing/elisp/smooth-scrolling.el">http://adamspiers.org/computing/elisp/smooth-scrolling.el</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">smooth-scrolling</span> nil t)
  (<span style="color: #a020f0;">setq</span> smooth-scroll-margin 1))
</pre>
</div>
</div>
</div>

<div id="outline-container-org58508dd" class="outline-3">
<h3 id="org58508dd"><span class="section-number-3">4.4</span> スクロールで表示を重複させる行数</h3>
<div class="outline-text-3" id="text-4-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Scroll window on a page-by-pabe basis with N line overlapping</span>
(<span style="color: #a020f0;">setq</span> next-screen-context-lines 1)
</pre>
</div>
</div>
</div>

<div id="outline-container-org0c14277" class="outline-3">
<h3 id="org0c14277"><span class="section-number-3">4.5</span> [SmoothScroll.el] カーソル固定でスクロールする</h3>
<div class="outline-text-3" id="text-4-5">
<p>
<a href="https://raw.github.com/takaxp/EmacsScripts/master/SmoothScroll.el">https://raw.github.com/takaxp/EmacsScripts/master/SmoothScroll.el</a><br />
<a href="https://github.com/pglotov/EmacsScripts/blob/master/SmoothScroll.el">https://github.com/pglotov/EmacsScripts/blob/master/SmoothScroll.el</a><br />
</p>

<p>
カーソル位置と行を固定してバッファを背景スクロールできます．<br />
</p>

<p>
オリジナルのままだとコンパイル時に警告がでるので， <code>line-move-visual</code> で書き換えています．残念ながら最近は使っていません．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(scroll-one-up scroll-one-down)
       <span style="color: #8b2252;">"smoothscroll"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"s-&lt;up&gt;"</span>) 'scroll-one-down)
    (global-set-key (kbd <span style="color: #8b2252;">"s-&lt;down&gt;"</span>) 'scroll-one-up)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org14d485f" class="outline-3">
<h3 id="org14d485f"><span class="section-number-3">4.6</span> [smooth-scroll.el] 滑らかなスクロール</h3>
<div class="outline-text-3" id="text-4-6">
<p>
良い感じです．スススっとスクロールします．最初にスクロールする時にパッケージを読み込みます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found '(smooth-scroll-mode) <span style="color: #8b2252;">"smooth-scroll"</span> nil t)

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">smooth-scroll-mode-kicker</span> ()
    <span style="color: #8b2252;">"Load `</span><span style="color: #008b8b;">smooth-scroll.el</span><span style="color: #8b2252;">' and remove-hook"</span>
    (<span style="color: #a020f0;">when</span> (memq this-command '(scroll-up scroll-down scroll-up-command))
      (smooth-scroll-mode t)
      (remove-hook 'pre-command-hook #'smooth-scroll-mode-kicker)))
  (add-hook 'pre-command-hook #'smooth-scroll-mode-kicker)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"smooth-scroll"</span>
    (custom-set-variables
     '(smooth-scroll/vscroll-step-size 6)
     '(smooth-scroll/hscroll-step-size 6))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb84d59c" class="outline-3">
<h3 id="orgb84d59c"><span class="section-number-3">4.7</span> [point-undo.el] カーソル位置を簡単にたどる</h3>
<div class="outline-text-3" id="text-4-7">
<p>
autoload や autoload-if-found で定義すると，使いたい時に履歴が取れていないのでよろしくないです．起動時に有効化します． bm.el で明示的にマーカーを残して履歴をたどる方が気に入っているので，最近は point-undo を使っていません．シングルキーを割り当てておくと使いやすいです．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">point-undo</span> nil t)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">[point-undo.el] Move the cursor to the previous position</span>
  (global-set-key (kbd <span style="color: #8b2252;">"&lt;f7&gt;"</span>) 'point-undo)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">[point-undo.el] Redo of point-undo</span>
  (global-set-key (kbd <span style="color: #8b2252;">"S-&lt;f7&gt;"</span>) 'point-redo))
</pre>
</div>
</div>
</div>

<div id="outline-container-org4f7e2ae" class="outline-3">
<h3 id="org4f7e2ae"><span class="section-number-3">4.8</span> [cycle-buffer.el] カレントバッファの表示切り替え</h3>
<div class="outline-text-3" id="text-4-8">
<p>
<a href="http://www.emacswiki.org/emacs/download/cycle-buffer.el">http://www.emacswiki.org/emacs/download/cycle-buffer.el</a><br />
</p>

<p>
cycle-buffer を使うと，バッファの履歴をスライドショーのようにたどれます．ミニバッファに前後の履歴が表示されるので，何回キーを押せばいいかの目安になります．それを超える場合には，おとなしくバッファリストを使います．直近数件のバッファをたどるのに便利です． <code>cycle-buffer</code> は古めですが，個人的には気に入っています．<br />
</p>

<p>
なおビルトインに同様の機能を提供する <code>bs.el</code> があり， <code>bs-cycle-next</code> あるいは <code>bs-cycle-previous</code> でバッファを切り替えられます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(cycle-buffer cycle-buffer-backward)
       <span style="color: #8b2252;">"cycle-buffer"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"M-]"</span>) 'cycle-buffer)
    (global-set-key (kbd <span style="color: #8b2252;">"M-["</span>) 'cycle-buffer-backward))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"cycle-buffer"</span>
    (custom-set-variables
     '(cycle-buffer-allow-visible t)
     '(1cycle-buffer-show-length 12)
     '(cycle-buffer-show-format '(<span style="color: #8b2252;">" &lt; %s &gt;"</span> . <span style="color: #8b2252;">" %s"</span>)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org6b9d866" class="outline-3">
<h3 id="org6b9d866"><span class="section-number-3">4.9</span> [bm.el] カーソル位置をブックマークして追う</h3>
<div class="outline-text-3" id="text-4-9">
<p>
<a href="https://github.com/joodland/bm">bm.el</a>は，カーソル位置をブックマークしておくためのツールです． <code>point-undo</code> と比較して，ユーザが明示的に位置を保存でき，見た目にも使いやすいです．以下の例では， <code>org-mode</code> のツリー内にブックマークがある時にも，上手い具合に表示ができるように調整してあります．カーソル移動は，順方向（ <code>bm-next</code> ）にだけ使っています．<br />
</p>

<p>
org-mode との連携には， <a href="https://github.com/alphapapa/org-bookmark-heading">org-bookmark-heading</a> があります．ただ，私は下記の設定だけでそれほど不自由していません．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(my-bm-toggle
         my-bm-next bm-buffer-save bm-buffer-restore bm-buffer-save-all
         bm-repository-save bm-repository-load bm-load-and-restore)
       <span style="color: #8b2252;">"bm"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12501;&#12449;&#12452;&#12523;&#12458;&#12540;&#12503;&#12531;&#26178;&#12395;&#12502;&#12483;&#12463;&#12510;&#12540;&#12463;&#12434;&#24489;&#24112;</span>
    (add-hook 'find-file-hook #'bm-buffer-restore)
    (global-set-key (kbd <span style="color: #8b2252;">"&lt;f10&gt;"</span>) 'my-bm-toggle)
    (global-set-key (kbd <span style="color: #8b2252;">"&lt;C-f10&gt;"</span>) 'my-bm-next))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"bm"</span>
    (<span style="color: #a020f0;">setq-default</span> bm-buffer-persistence t)
    (<span style="color: #a020f0;">setq</span> bm-cycle-all-buffers t)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq bm-toggle-buffer-persistence t)</span>
    (<span style="color: #a020f0;">setq</span> bm-repository-file <span style="color: #8b2252;">"~/Dropbox/emacs.d/.bookmark"</span>)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">autoload &#12392;&#12398;&#32068;&#12415;&#21512;&#12431;&#12379;&#12391;&#12399;&#28961;&#24847;&#21619;</span>
    <span style="color: #b22222;">;;</span><span style="color: #b22222;">&#65288;after-init-hook &#12434;&#21033;&#29992;&#12379;&#12424;&#65289;</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq bm-restore-repository-on-load t)</span>
    (<span style="color: #a020f0;">setq</span> bm-buffer-persistence t)
    (<span style="color: #a020f0;">setq</span> bm-persistent-face 'bm-face)
    (<span style="color: #a020f0;">setq</span> bm-repository-file
          (expand-file-name <span style="color: #8b2252;">"~/Dropbox/emacs.d/.bm-repository"</span>))
    (bm-repository-load)

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-bm-toggle</span> ()
      <span style="color: #8b2252;">"bm-toggle with updating history"</span>
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">let</span> ((bm (concat
                 (buffer-name) <span style="color: #8b2252;">"::"</span>
                 (<span style="color: #a020f0;">if</span> (<span style="color: #a020f0;">and</span> (equal major-mode 'org-mode)
                          (not (org-before-first-heading-p)))
                     (nth 4 (org-heading-components))
                   (format <span style="color: #8b2252;">"%s"</span> (line-number-at-pos))))))
        (<span style="color: #a020f0;">if</span> (bm-bookmark-at (point))
            (bookmark-delete bm)
          (bookmark-set bm)))
      (bm-toggle)
      (bm-save))

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-bm-next</span> ()
      <span style="color: #8b2252;">"bm-next with org-mode"</span>
      (<span style="color: #a020f0;">interactive</span>)
      (bm-next)
      (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (equal major-mode 'org-mode)
                 (not (org-before-first-heading-p)))
        (widen)
        (org-overview)
        (org-reveal)
        (org-cycle-hide-drawers 'all)
        (org-show-entry)
        (show-children)
        (org-show-siblings)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7746526" class="outline-3">
<h3 id="org7746526"><span class="section-number-3">4.10</span> [centered-cursor-mode.el] カーソル位置をバッファ中央に固定</h3>
<div class="outline-text-3" id="text-4-10">
<p>
<code>isearch-mode</code> の時だけ有効にしています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(centered-cursor-mode)
       <span style="color: #8b2252;">"centered-cursor-mode"</span> nil t)

  (add-hook 'isearch-mode-hook
            #'(lambda () (centered-cursor-mode 1)))
  (add-hook 'isearch-mode-end-hook
            #'(lambda () (centered-cursor-mode -1))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org2e7c704" class="outline-3">
<h3 id="org2e7c704"><span class="section-number-3">4.11</span> [back-button] マークをたどる</h3>
<div class="outline-text-3" id="text-4-11">
<p>
現在のバッファと開いている全てのバッファのマークを辿ることができます．いま注目している位置が，マーク全体でどのあたりに位置するのかをミニバッファに表示してくれます．ツールバーを表示している場合は，マークを付けたり辿る用のボタンが追加されます． <code>global-mark-ring-max</code> を設定して，辿れるマークの数を拡張しておきます．<br />
</p>

<p>
ただ <code>C-x &lt;SPC&gt;</code> が潰れるので要注意です．矩形選択で用いる <code>rectangle-mark-mode</code> に当てられているキーバインドです．<br />
</p>

<ul class="org-ul">
<li><a href="https://github.com/rolandwalker/back-button">rolandwalker/back-button: Visual navigation through mark rings in Emacs 🔊</a><br /></li>
</ul>

<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(back-button-mode
         back-button-local-forward back-button-global-forward)
       <span style="color: #8b2252;">"back-button"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"back-button"</span>
    (<span style="color: #a020f0;">setq</span> global-mark-ring-max 64)
    (<span style="color: #a020f0;">setq</span> back-button-local-forward-keystrokes '(<span style="color: #8b2252;">"&lt;f10&gt;"</span>))
    (<span style="color: #a020f0;">setq</span> back-button-global-forward-keystrokes '(<span style="color: #8b2252;">"C-&lt;f10&gt;"</span>))
    (define-key back-button-mode-map
      (kbd (car back-button-local-forward-keystrokes))
      'back-button-local-forward)
    (define-key back-button-mode-map
      (kbd (car back-button-global-forward-keystrokes))
      'back-button-global-forward)
    (<span style="color: #a020f0;">setq</span> back-button-mode-lighter nil)
    (<span style="color: #a020f0;">setq</span> back-button-index-timeout 0)))

(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">unless</span> batch-build
    (postpone-message <span style="color: #8b2252;">"back-button-mode"</span>)
    (back-button-mode 1)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcc64545" class="outline-3">
<h3 id="orgcc64545"><span class="section-number-3">4.12</span> [smart-mark] C-g後に元の場所へカーソルを戻す</h3>
<div class="outline-text-3" id="text-4-12">
<p>
すぐわかる例は， <code>C-x h</code> で全選択して何もせず， <code>C-g</code> する場合です．通常だとバッファの先頭にカーソルが置き去りにされますが， <code>smart-mark</code> を使うと，全選択を実行した時の位置に自動的に戻してくれます．<br />
</p>

<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<ul class="org-ul">
<li><a href="https://github.com/zhangkaiyulw/smart-mark">zhangkaiyulw/smart-mark: Emacs package to restore point after C-g when mark</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">smart-mark</span> nil t)
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"smart-mark-mode"</span>)
      (smart-mark-mode 1))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org19cf18b" class="outline-3">
<h3 id="org19cf18b"><span class="section-number-3">4.13</span> [syntax-subword.el] M-f で移動する位置をより密にする</h3>
<div class="outline-text-3" id="text-4-13">
<ul class="org-ul">
<li><a href="https://bitbucket.org/jpkotta/syntax-subword">https://bitbucket.org/jpkotta/syntax-subword</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">syntax-subword</span> nil t)
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"global-syntax-subword-mode"</span>)
      (global-syntax-subword-mode 1))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org4f4b19c" class="outline-3">
<h3 id="org4f4b19c"><span class="section-number-3">4.14</span> [goto-chg.el] 編集箇所を簡単に辿る</h3>
<div class="outline-text-3" id="text-4-14">
<p>
編集結果を保持したまま編集箇所にカーソルを移すことができます．=C-/= の Undo のような操作で，簡単かつ高速にカーソルを移動できます．<br />
</p>

<ul class="org-ul">
<li><code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(goto-last-change goto-last-change-reverse)
       <span style="color: #8b2252;">"goto-chg"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-,"</span>) 'goto-last-change)
    (global-set-key (kbd <span style="color: #8b2252;">"C-."</span>) 'goto-last-change-reverse))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"flyspell"</span>
    (define-key flyspell-mode-map (kbd <span style="color: #8b2252;">"C-,"</span>) 'goto-last-change)
    (define-key flyspell-mode-map (kbd <span style="color: #8b2252;">"C-."</span>) 'goto-last-change-reverse)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orga08af59" class="outline-2">
<h2 id="orga08af59"><span class="section-number-2">5</span> 編集サポート</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org9d80f0d" class="outline-3">
<h3 id="org9d80f0d"><span class="section-number-3">5.1</span> 矩形編集／連番入力</h3>
<div class="outline-text-3" id="text-5-1">
<p>
Built-in の cua-base.el（CUA-mode）を使う．矩形選択は，領域選択後 <code>cua-toggle-rectangle-mark</code> でもできるが， 24.4 からは， <code>C-x SPC</code> を押下すると矩形モードに入り直感的に矩形選択ができるようになっています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">cua-base</span>)
  (cua-mode 1)
  (<span style="color: #a020f0;">setq</span> cua-enable-cua-keys nil))
</pre>
</div>

<p>
矩形選択した後に， <code>M-n</code> を押すと，連番をふれる．開始値，増加値を入力してから，hoge%03d.pgm などとすれば，hoge001，hoge002，，，と入力される．これと，org-mode の表機能（ <code>C-c |</code> で選択部分を簡単に表にできる）を組み合わせれば，連番で数値をふったテーブルを容易に作れる．<br />
</p>

<p>
なお，標準の rect.el に以下の機能が実装されている．<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">矩形切り取り</td>
<td class="org-left">C-x r k</td>
</tr>

<tr>
<td class="org-left">矩形削除</td>
<td class="org-left">C-x r d</td>
</tr>

<tr>
<td class="org-left">矩形貼り付け</td>
<td class="org-left">C-x r y</td>
</tr>

<tr>
<td class="org-left">矩形先頭に文字を挿入</td>
<td class="org-left">C-x r t</td>
</tr>

<tr>
<td class="org-left">矩形を空白に変換する</td>
<td class="org-left">C-x r c</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org562364b" class="outline-3">
<h3 id="org562364b"><span class="section-number-3">5.2</span> Yank時に装飾を取る</h3>
<div class="outline-text-3" id="text-5-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> yank-excluded-properties t)
</pre>
</div>
</div>
</div>

<div id="outline-container-orge739644" class="outline-3">
<h3 id="orge739644"><span class="section-number-3">5.3</span> ファイル保存時に時間を記録する</h3>
<div class="outline-text-3" id="text-5-3">
<p>
Built-in の time-stamp.el を使う．<br />
</p>

<p>
バッファの保存時にタイムスタンプを記録する．以下の設定では，バッファの先頭から10行以内に，"Last Update: " があると，"Last Update: 2011-12-31@12:00"のようにタイムスタンプが記録される．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">#+UPDATE &#29992;</span>
(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(update-stamp my-update-stamp)
       <span style="color: #8b2252;">"update-stamp"</span> nil t)

  (add-hook 'before-save-hook #'my-update-stamp)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"update-stamp"</span>
    (<span style="color: #a020f0;">setq</span> update-stamp-start <span style="color: #8b2252;">"#\\+update:[ \t]*"</span>)
    (<span style="color: #a020f0;">setq</span> update-stamp-end <span style="color: #8b2252;">"$"</span>)
    (<span style="color: #a020f0;">setq</span> update-stamp-line-limit 10) <span style="color: #b22222;">;; </span><span style="color: #b22222;">def=8</span>
    (custom-set-variables
     '(update-stamp-format <span style="color: #8b2252;">"%02H:%02M:%02S"</span>))
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-update-stamp</span> ()
      (<span style="color: #a020f0;">if</span> (boundp 'org-tree-slide-mode)
          (<span style="color: #a020f0;">unless</span> org-tree-slide-mode
            (update-stamp))
        (update-stamp)))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'before-save-hook #'time-stamp)
(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"time-stamp"</span>
  (<span style="color: #a020f0;">setq</span> time-stamp-start <span style="color: #8b2252;">"Last Update: "</span>)
  (<span style="color: #a020f0;">setq</span> time-stamp-format <span style="color: #8b2252;">"%04y-%02m-%02d@%02H:%02M"</span>)
  (<span style="color: #a020f0;">setq</span> time-stamp-end <span style="color: #8b2252;">"$"</span>)
  (<span style="color: #a020f0;">setq</span> time-stamp-line-limit 10)) <span style="color: #b22222;">; </span><span style="color: #b22222;">def=8</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9dda8b5" class="outline-3">
<h3 id="org9dda8b5"><span class="section-number-3">5.4</span> 選択リージョンを使って検索</h3>
<div class="outline-text-3" id="text-5-4">
<p>
検索語をミニバッファに入力するのが面倒なので，リージョンをそのまま検索語として利用します．<br />
</p>

<ul class="org-ul">
<li><a href="http://dev.ariel-networks.com/articles/emacs/part5/">http://dev.ariel-networks.com/articles/emacs/part5/</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defadvice</span> <span style="color: #0000ff;">isearch-mode</span>
    (around isearch-mode-default-string
            (forward <span style="color: #228b22;">&amp;optional</span> regexp op-fun recursive-edit word-p) activate)
  (<span style="color: #a020f0;">if</span> (<span style="color: #a020f0;">and</span> transient-mark-mode mark-active (not (eq (mark) (point))))
      (<span style="color: #a020f0;">progn</span>
        (isearch-update-ring (buffer-substring-no-properties (mark) (point)))
        (deactivate-mark)
        ad-do-it
        (<span style="color: #a020f0;">if</span> (not forward)
            (isearch-repeat-backward)
          (goto-char (mark))
          (isearch-repeat-forward)))
    ad-do-it))
</pre>
</div>
</div>
</div>

<div id="outline-container-org08725ca" class="outline-3">
<h3 id="org08725ca"><span class="section-number-3">5.5</span> ChangeLog モード</h3>
<div class="outline-text-3" id="text-5-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">see private.el</span>
(<span style="color: #a020f0;">setq</span> user-full-name <span style="color: #8b2252;">"Your NAME"</span>)
(<span style="color: #a020f0;">setq</span> user-mail-address <span style="color: #8b2252;">"your@address.com"</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'change-log-mode-hook
          #'(lambda()
              (<span style="color: #a020f0;">if</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">orgalist</span> nil t)
                  (<span style="color: #a020f0;">when</span> (boundp 'orgalist-mode)
                    (orgalist-mode 1))
                (orgstruct-mode))
              (<span style="color: #a020f0;">setq</span> tab-width 4)
              (<span style="color: #a020f0;">setq</span> left-margin 4)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org108b026" class="outline-3">
<h3 id="org108b026"><span class="section-number-3">5.6</span> テキストモード</h3>
<div class="outline-text-3" id="text-5-6">
<p>
<a href="http://d.hatena.ne.jp/NeoCat/20080211">http://d.hatena.ne.jp/NeoCat/20080211</a><br />
</p>

<p>
とは言っても，Org-modeを知ってから <code>.txt</code> もテキストモードで開かなくなったので，ほぼ無意味な設定となりました．しかも， <code>nxml-mode</code> で <code>TAB</code> が効かなくなる現象が起きているので，以下の設定はしない方がよさげ．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'text-mode-hook
          #'(lambda()
              (<span style="color: #a020f0;">setq</span> tab-width 4)
              (<span style="color: #a020f0;">setq</span> indent-line-function 'tab-to-tab-stop)
              (<span style="color: #a020f0;">setq</span> tab-stop-list
                    '(4 8 12 16 20 24 28 32 36 40 44 48 52 56 60
                        64 68 72 76 80))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc4984a3" class="outline-3">
<h3 id="orgc4984a3"><span class="section-number-3">5.7</span> C/C++モード</h3>
<div class="outline-text-3" id="text-5-7">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(modern-c++-font-lock-mode)
       <span style="color: #8b2252;">"modern-cpp-font-lock"</span> nil t)

  (add-hook 'c++-mode-hook #'modern-c++-font-lock-mode)
  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.h$"</span> . c++-mode) auto-mode-alist))
</pre>
</div>
</div>
</div>

<div id="outline-container-org2fa9fa0" class="outline-3">
<h3 id="org2fa9fa0"><span class="section-number-3">5.8</span> C#モード</h3>
<div class="outline-text-3" id="text-5-8">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(csharp-mode)
       <span style="color: #8b2252;">"csharp-mode"</span> <span style="color: #8b2252;">"Major mode for editing C# mode."</span> nil t)

  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.cs$"</span> . csharp-mode) auto-mode-alist))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3201727" class="outline-3">
<h3 id="org3201727"><span class="section-number-3">5.9</span> Infoモード</h3>
<div class="outline-text-3" id="text-5-9">
<p>
Org-mode の日本語翻訳済みinfoを読むための設定．<a href="https://github.com/org-mode-doc-ja/org-ja">翻訳プロジェクト</a>で頒布しています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(info org-info-ja)
       <span style="color: #8b2252;">"info"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"info"</span>
    (add-to-list 'Info-additional-directory-list
                 (expand-file-name <span style="color: #8b2252;">"~/devel/mygit/org-ja/work/"</span>))

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">org-info-ja</span> (<span style="color: #228b22;">&amp;optional</span> node)
      <span style="color: #8b2252;">"(Japanese) Read documentation for Org-mode in the info system.</span>
<span style="color: #8b2252;">    With optional NODE, go directly to that node."</span>
      (<span style="color: #a020f0;">interactive</span>)
      (info (format <span style="color: #8b2252;">"(org-ja)%s"</span> (<span style="color: #a020f0;">or</span> node <span style="color: #8b2252;">""</span>))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbe24559" class="outline-3">
<h3 id="orgbe24559"><span class="section-number-3">5.10</span> Rモード</h3>
<div class="outline-text-3" id="text-5-10">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(R-mode R)
       <span style="color: #8b2252;">"ess-site"</span> <span style="color: #8b2252;">"Emacs Speaks Statistics mode"</span> nil t)

  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.[rR]$"</span> . R-mode) auto-mode-alist))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf407d0d" class="outline-3">
<h3 id="orgf407d0d"><span class="section-number-3">5.11</span> nXMLモード</h3>
<div class="outline-text-3" id="text-5-11">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'nxml-mode-hook
          #'(lambda ()
              (define-key nxml-mode-map <span style="color: #8b2252;">"\r"</span> 'newline-and-indent)
              (auto-fill-mode -1)
              (<span style="color: #a020f0;">setq</span> indent-tabs-mode t)
              (<span style="color: #a020f0;">setq</span> nxml-slash-auto-complete-flag t)
              (<span style="color: #a020f0;">setq</span> tab-width 1)
              (<span style="color: #a020f0;">setq</span> nxml-child-indent 1)
              (<span style="color: #a020f0;">setq</span> nxml-attribute-indent 0)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga4894bc" class="outline-3">
<h3 id="orga4894bc"><span class="section-number-3">5.12</span> yamlモード</h3>
<div class="outline-text-3" id="text-5-12">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(yaml-mode)
       <span style="color: #8b2252;">"yaml-mode"</span> nil t)

  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.yml$"</span> . yaml-mode) auto-mode-alist))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf1bdc3d" class="outline-3">
<h3 id="orgf1bdc3d"><span class="section-number-3">5.13</span> jsonモード</h3>
<div class="outline-text-3" id="text-5-13">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(json-mode)
       <span style="color: #8b2252;">"json-mode"</span> nil t)

  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.json$"</span> . json-mode) auto-mode-alist))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd754418" class="outline-3">
<h3 id="orgd754418"><span class="section-number-3">5.14</span> javascriptモード</h3>
<div class="outline-text-3" id="text-5-14">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(js2-mode)
       <span style="color: #8b2252;">"js2-mode"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"js2-mode"</span>
    (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">js2-refactor</span> nil t)
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.js$"</span> . js2-mode) auto-mode-alist)

    (<span style="color: #a020f0;">when</span> (autoload-if-found
           '(ac-js2-mode ac-js2-setup-auto-complete-mode)
           <span style="color: #8b2252;">"ac-js2"</span> nil t)
      (add-hook 'js2-mode-hook #'ac-js2-mode))

    (<span style="color: #a020f0;">if</span> (executable-find <span style="color: #8b2252;">"tern"</span>)
        (<span style="color: #a020f0;">when</span> (autoload-if-found
               '(tern-mode)
               <span style="color: #8b2252;">"tern"</span> nil t)
          (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"tern"</span>
            (tern-mode 1)
            <span style="color: #b22222;">;; </span><span style="color: #b22222;">tern-command shall be overwritten by actual path</span>
            (<span style="color: #a020f0;">setq</span> tern-command `(<span style="color: #8b2252;">"node"</span> ,(executable-find <span style="color: #8b2252;">"tern"</span>)))
            (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">tern-auto-complete</span> nil t)
              (tern-ac-setup)))
          (add-hook 'js2-mode-hook #'tern-mode))
      (message <span style="color: #8b2252;">"--- tern is NOT installed in this system."</span>))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7ce57cd" class="outline-3">
<h3 id="org7ce57cd"><span class="section-number-3">5.15</span> csvモード</h3>
<div class="outline-text-3" id="text-5-15">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(csv-mode)
       <span style="color: #8b2252;">"csv-mode"</span> nil t)

  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.csv$"</span> . csv-mode) auto-mode-alist))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5b030fb" class="outline-3">
<h3 id="org5b030fb"><span class="section-number-3">5.16</span> asciiモード</h3>
<div class="outline-text-3" id="text-5-16">
<p>
カーソル下の文字のアスキーコードを別ウィンドウでリアルタイムに確認できます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(autoload-if-found '(ascii-on ascii-off) <span style="color: #8b2252;">"ascii"</span> nil t)
</pre>
</div>
</div>
</div>

<div id="outline-container-orga86b1a2" class="outline-3">
<h3 id="orga86b1a2"><span class="section-number-3">5.17</span> javaモード</h3>
<div class="outline-text-3" id="text-5-17">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(cc-mode)
       <span style="color: #8b2252;">"cc-mode"</span> nil t)

  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.pde$"</span> . java-mode) auto-mode-alist) <span style="color: #b22222;">;; </span><span style="color: #b22222;">Processing</span>
  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.java$"</span> . java-mode) auto-mode-alist))
</pre>
</div>
</div>
</div>

<div id="outline-container-org1007c12" class="outline-3">
<h3 id="org1007c12"><span class="section-number-3">5.18</span> esモード</h3>
<div class="outline-text-3" id="text-5-18">
<ul class="org-ul">
<li><a href="https://github.com/dakrone/es-mode">https://github.com/dakrone/es-mode</a><br /></li>
</ul>

<p>
<a href="https://www.elastic.co/products/elasticsearch">ElasticSearch</a> のクエリを編集します．org-mode との連携もできます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(es-mode)
       <span style="color: #8b2252;">"es-mode"</span> nil t)

  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.es$"</span> . es-mode) auto-mode-alist))
</pre>
</div>
</div>
</div>

<div id="outline-container-org4f03e24" class="outline-3">
<h3 id="org4f03e24"><span class="section-number-3">5.19</span> gnuplotモード</h3>
<div class="outline-text-3" id="text-5-19">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(gnuplot-mode)
       <span style="color: #8b2252;">"gnuplot-mode"</span> nil t)

  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.plt$"</span> . gnuplot-mode) auto-mode-alist))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgce7822c" class="outline-3">
<h3 id="orgce7822c"><span class="section-number-3">5.20</span> markdown-mode</h3>
<div class="outline-text-3" id="text-5-20">
<ul class="org-ul">
<li><a href="http://jblevins.org/projects/markdown-mode/">http://jblevins.org/projects/markdown-mode/</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(markdown-mode)
       <span style="color: #8b2252;">"markdown-mode"</span> nil t)

  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.markdown$"</span> . markdown-mode) auto-mode-alist)
  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.md$"</span> . markdown-mode) auto-mode-alist))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3b44f3b" class="outline-3">
<h3 id="org3b44f3b"><span class="section-number-3">5.21</span> cmakeモード</h3>
<div class="outline-text-3" id="text-5-21">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">if</span> (executable-find <span style="color: #8b2252;">"cmake"</span>)
    (<span style="color: #a020f0;">when</span> (autoload-if-found
           '(cmake-mode)
           <span style="color: #8b2252;">"cmake-mode"</span> nil t)

      (add-to-list 'auto-mode-alist '(<span style="color: #8b2252;">"CMakeLists\\.txt\\'"</span> . cmake-mode))
      (add-to-list 'auto-mode-alist '(<span style="color: #8b2252;">"\\.cmake\\'"</span> . cmake-mode)))
  (message <span style="color: #8b2252;">"--- cmake is NOT installed."</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbee5598" class="outline-3">
<h3 id="orgbee5598"><span class="section-number-3">5.22</span> スペルチェック</h3>
<div class="outline-text-3" id="text-5-22">
<p>
Built-in の ispell を使う．チェックエンジンは，aspell を利用する．<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">'ns</td>
<td class="org-left">sudo port install aspell aspell-dict-en</td>
</tr>

<tr>
<td class="org-left">'x32</td>
<td class="org-left">installer.exe and aspell-en from <a href="http://aspell.net/win32/">http://aspell.net/win32/</a></td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li><a href="http://qiita.com/YutakakINJO/items/2c891aff66ef45251893">英語の文章を aspell でスペルチェック - Qiita</a><br /></li>
</ul>

<p>
コマンドラインから <code>aspell</code> を使う時は，<br />
</p>

<div class="org-src-container">
<pre class="src src-sh">aspell -l en -c &lt;file&gt;
</pre>
</div>

<p>
とすると， <code>~/.aspell.en.pws</code> を個人辞書として暗黙的に設定し，スペルチェックをしてくれる． <code>hunspell</code> が使える環境ならば，優先して使います．さらに， <code>~/.aspell.conf</code> に，次を書いておきます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">lang en_US
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(ispell-region ispell-complete-word)
       <span style="color: #8b2252;">"ispell"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Spell checking within a specified region</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-c f 7"</span>) 'ispell-region)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35036;&#23436;&#20505;&#35036;&#12398;&#34920;&#31034;&#65288;flyspell &#12364;&#20351;&#12360;&#12427;&#26178;&#12399;&#12381;&#12385;&#12425;&#12434;&#20778;&#20808;&#12375;&#12390; &lt;f7&gt; &#12395;&#12377;&#12427;&#65294;</span>
    (global-set-key (kbd <span style="color: #8b2252;">"&lt;f7&gt;"</span>) 'ispell-word))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(if (autoload-if-found '(helm-ispell) "helm-ispell" nil t)</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">#'helm-ispell #'ispell-word)))</span>

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"ispell"</span>
    (<span style="color: #a020f0;">setq</span> ispell-encoding8-command t)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">for English and Japanese mixed</span>
    (add-to-list 'ispell-skip-region-alist '(<span style="color: #8b2252;">"[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\000-\377]+"</span>))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">http://endlessparentheses.com/ispell-and-org-mode.html</span>
    (add-to-list 'ispell-skip-region-alist '(<span style="color: #8b2252;">"^#\\+BEGIN_SRC"</span> . <span style="color: #8b2252;">"^#\\+END_SRC"</span>))
    (add-to-list 'ispell-skip-region-alist '(<span style="color: #8b2252;">"~"</span> <span style="color: #8b2252;">"~"</span>))
    (add-to-list 'ispell-skip-region-alist '(<span style="color: #8b2252;">"="</span> <span style="color: #8b2252;">"="</span>))
    (add-to-list 'ispell-skip-region-alist '(org-property-drawer-re))

    (<span style="color: #a020f0;">cond</span>
     ((executable-find <span style="color: #8b2252;">"hunspell"</span>)
      (setenv <span style="color: #8b2252;">"LC_ALL"</span> <span style="color: #8b2252;">"en_US"</span>)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">(message "--- hunspell loaded.")</span>
      (setenv <span style="color: #8b2252;">"DICPATH"</span> <span style="color: #8b2252;">"/Applications/LibreOffice.app/Contents/Resources/extensions/dict-en"</span>)
      (<span style="color: #a020f0;">if</span> shutup-p
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#24517;&#35201;&#65294;&#12375;&#12363;&#12418; ispell-program-name &#25351;&#23450;&#12398;&#21069;&#12391;&#65294;</span>
          (<span style="color: #a020f0;">shut-up</span> (ispell-change-dictionary <span style="color: #8b2252;">"en_US"</span> t))
        (ispell-change-dictionary <span style="color: #8b2252;">"en_US"</span> t))
      (<span style="color: #a020f0;">setq-default</span> ispell-program-name (executable-find <span style="color: #8b2252;">"hunspell"</span>))
      (<span style="color: #a020f0;">setq</span> ispell-local-dictionary <span style="color: #8b2252;">"en_US"</span>)
      (<span style="color: #a020f0;">setq</span> ispell-dictionary ispell-local-dictionary)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">Not regal way, but it's OK (usually ispell-local-dictionary-alist)</span>

      (<span style="color: #a020f0;">setq</span> ispell-local-dictionary-alist
            '((<span style="color: #8b2252;">"ja_JP"</span> <span style="color: #8b2252;">"[[:alpha:]]"</span> <span style="color: #8b2252;">"[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">[:alpha:]]"</span> <span style="color: #8b2252;">"[']"</span> nil
               (<span style="color: #8b2252;">"-d"</span> <span style="color: #8b2252;">"en_US"</span>) nil utf-8)
              (<span style="color: #8b2252;">"en_US"</span> <span style="color: #8b2252;">"[[:alpha:]]"</span> <span style="color: #8b2252;">"[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">[:alpha:]]"</span> <span style="color: #8b2252;">"[']"</span> nil
               (<span style="color: #8b2252;">"-d"</span> <span style="color: #8b2252;">"en_US"</span>) nil utf-8)))
      (<span style="color: #a020f0;">setq</span> ispell-hunspell-dictionary-alist ispell-local-dictionary-alist)
      (<span style="color: #a020f0;">setq</span> ispell-personal-dictionary <span style="color: #8b2252;">"~/Dropbox/emacs.d/.hunspell.en.dic"</span>))

     ((executable-find <span style="color: #8b2252;">"aspell"</span>)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">(message "--- aspell loaded.")</span>
      (<span style="color: #a020f0;">setq-default</span> ispell-program-name <span style="color: #8b2252;">"aspell"</span>)
      (<span style="color: #a020f0;">when</span> (eq window-system 'w32)
        (<span style="color: #a020f0;">setq-default</span> ispell-program-name
                      <span style="color: #8b2252;">"C:/Program Files/Aspell/bin/aspell.exe"</span>))
      (<span style="color: #a020f0;">setq</span> ispell-dictionary <span style="color: #8b2252;">"english"</span>)
      (<span style="color: #a020f0;">setq</span> ispell-personal-dictionary <span style="color: #8b2252;">"~/Dropbox/emacs.d/.aspell.en.pws"</span>)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">This will also avoid an IM-OFF issue for flyspell-mode.</span>
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq ispell-aspell-supports-utf8 t) ;; Obsolate</span>
      (<span style="color: #a020f0;">setq</span> ispell-local-dictionary-alist
            '((nil <span style="color: #8b2252;">"[a-zA-Z]"</span> <span style="color: #8b2252;">"[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">a-zA-Z]"</span> <span style="color: #8b2252;">"'"</span> t
                   (<span style="color: #8b2252;">"-d"</span> <span style="color: #8b2252;">"en"</span> <span style="color: #8b2252;">"--encoding=utf-8"</span>) nil utf-8))))
     (t nil))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;; </span><span style="color: #b22222;">Use aspell for spell checking instead of ispell.</span>
(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (executable-find <span style="color: #8b2252;">"aspell"</span>)
           (autoload-if-found
            '(ispell-region ispell-complete-word)
            <span style="color: #8b2252;">"ispell"</span> nil t))
  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"ispell"</span>
    (<span style="color: #a020f0;">setq-default</span> ispell-program-name <span style="color: #8b2252;">"aspell"</span>)
    (<span style="color: #a020f0;">when</span> (eq window-system 'w32)
      (<span style="color: #a020f0;">setq-default</span> ispell-program-name
                    <span style="color: #8b2252;">"C:/Program Files/Aspell/bin/aspell.exe"</span>))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">for English and Japanese mixed</span>
    (add-to-list 'ispell-skip-region-alist '(<span style="color: #8b2252;">"[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\000-\377]+"</span>))
    (add-to-list 'ispell-skip-region-alist
                 '(<span style="color: #8b2252;">"^#+BEGIN_SRC"</span> . <span style="color: #8b2252;">"^#+END_SRC"</span>))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq ispell-dictionarry "english")</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq ispell-personal-dictionary</span>
    <span style="color: #b22222;">;;       </span><span style="color: #b22222;">"~/Dropbox/emacs.d/.aspell.en.pws")</span>

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">This will also avoid an IM-OFF issue for flyspell-mode.</span>
    <span style="color: #b22222;">;;  </span><span style="color: #b22222;">(setq ispell-aspell-supports-utf8 t)</span>
    <span style="color: #b22222;">;;  </span><span style="color: #b22222;">(setq ispell-encoding8-command t)</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq ispell-local-dictionary-alist</span>
    <span style="color: #b22222;">;;       </span><span style="color: #b22222;">'((nil "[a-zA-Z]" "[</span><span style="color: #b22222;">^</span><span style="color: #b22222;">a-zA-Z]" "'" t</span>
    <span style="color: #b22222;">;;              </span><span style="color: #b22222;">("-d" "en" "--encoding=utf-8") nil utf-8)))</span>
    )

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Spell checking within a specified region</span>
  (global-set-key (kbd <span style="color: #8b2252;">"C-c f 7"</span>) 'ispell-region)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35036;&#23436;&#20505;&#35036;&#12398;&#34920;&#31034;</span>
  (global-set-key (kbd <span style="color: #8b2252;">"&lt;f7&gt;"</span>) 'ispell-word))
</pre>
</div>
</div>
</div>

<div id="outline-container-org73daad0" class="outline-3">
<h3 id="org73daad0"><span class="section-number-3">5.23</span> リアルタイムスペルチェック</h3>
<div class="outline-text-3" id="text-5-23">
<p>
Built-in の <a href="http://www.emacswiki.org/emacs/FlySpell">flyspell.el</a> を使います．flyspell は内部で <code>ispell</code> を読み込んでいるので，辞書機能自体はそちらの設定が使われます．<br />
</p>

<p>
<a href="http://www.morishima.net/~naoto/fragments/archives/2005/12/20/flyspell/">http://www.morishima.net/~naoto/fragments/archives/2005/12/20/flyspell/</a><br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(flyspell-prog-mode flyspell-mode)
       <span style="color: #8b2252;">"flyspell"</span> nil t)

  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">major-mode-with-flyspell</span>
    '(text-mode change-log-mode latex-mode yatex-mode
                git-commit-mode org-mode))
  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">major-mode-with-flyspell-prog</span>
    '(c-mode-common emacs-lisp-mode perl-mode python-mode))
  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-flyspell-target-modes</span>
    (append major-mode-with-flyspell
            major-mode-with-flyspell-prog))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12496;&#12483;&#12501;&#12449;&#20869;&#12398;&#20840;&#12390;&#12434;&#12481;&#12455;&#12483;&#12463;&#23550;&#35937;&#12395;&#12377;&#12427;&#12514;&#12540;&#12489;&#12398; hook &#12395; flyspell &#36215;&#21205;&#12434;&#30331;&#37682;</span>
  (<span style="color: #a020f0;">dolist</span> (hook major-mode-with-flyspell)
    (add-hook (intern (format <span style="color: #8b2252;">"%s-hook"</span> hook))
              #'(lambda () (flyspell-mode 1))))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12467;&#12513;&#12531;&#12488;&#34892;&#12398;&#12415;&#12434;&#23550;&#35937;&#12395;&#12377;&#12427;</span>
  (<span style="color: #a020f0;">dolist</span> (hook major-mode-with-flyspell-prog)
    (add-hook (intern (format <span style="color: #8b2252;">"%s-hook"</span> hook))
              #'flyspell-prog-mode))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"flyspell"</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">C-; &#12434;&#12458;&#12540;&#12496;&#12540;&#12521;&#12452;&#12489;</span>
    (define-key flyspell-mode-map (kbd <span style="color: #8b2252;">"C-;"</span>) 'comment-dwim)
    (<span style="color: #a020f0;">setq</span> flyspell-duplicate-distance 0)
    (<span style="color: #a020f0;">setq</span> flyspell-mode-line-string <span style="color: #8b2252;">" F"</span>)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq flyspell-large-region 200)</span>
    (set-face-attribute 'flyspell-duplicate nil
                        <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #EA5506;">#EA5506</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:bold</span> t
                        <span style="color: #483d8b;">:background</span> nil <span style="color: #483d8b;">:underline</span> t)
    (set-face-attribute 'flyspell-incorrect nil
                        <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #BA2636;">#BA2636</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:bold</span> nil
                        <span style="color: #483d8b;">:background</span> nil <span style="color: #483d8b;">:underline</span> t)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">ispell-complete-word &#12398;&#12461;&#12540;&#12496;&#12452;&#12531;&#12489;&#12434;&#19978;&#26360;&#12365;</span>
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">helm</span> nil t)
               (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">flyspell-correct-helm</span> nil t))
      (global-set-key (kbd <span style="color: #8b2252;">"&lt;f7&gt;"</span>) 'flyspell-correct-word-generic))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Auto complete &#12392;&#12398;&#34909;&#31361;&#12434;&#22238;&#36991;</span>
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"auto-complete"</span>
      (ac-flyspell-workaround))
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-flyspell-ignore-nonascii</span> (beg end _info)
      <span style="color: #8b2252;">"incorrect&#21028;&#23450;&#12434;ASCII&#12395;&#38480;&#23450;"</span>
      (string-match <span style="color: #8b2252;">"[</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">!-~]"</span> (buffer-substring beg end)))
    (add-hook 'flyspell-incorrect-hook 'my-flyspell-ignore-nonascii)

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-flyspell-on</span> ()
      (<span style="color: #a020f0;">cond</span>
       ((memq major-mode major-mode-with-flyspell)
        (turn-on-flyspell))
       ((memq major-mode major-mode-with-flyspell-prog)
        (flyspell-prog-mode))
       (t nil)))
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-flyspell-off</span> ()
      (<span style="color: #a020f0;">when</span> (memq major-mode my-flyspell-target-modes)
        (turn-off-flyspell)))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">[FIXME] nextstep+inline-patch&#29256;&#12391; flyspell &#12377;&#12427;&#12392;&#65292;&#26085;&#26412;&#35486;nyuu&#12398;&#12424;&#12358;&#12395;&#12394;&#12427;&#22580;&#21512;&#12364;&#12354;&#12427;&#12398;&#12391;&#65292;&#12381;&#12428;&#12434;&#22238;&#36991;&#65288;IME &#12364; ON&#12395;&#12394;&#12387;&#12383;&#12425;&#19968;&#26178;&#30340;&#12395; flyspell &#12434;&#27490;&#12417;&#12427;&#65289;</span>
    (add-hook 'my-ime-off-hook #'my-flyspell-on)
    (add-hook 'my-ime-on-hook #'my-flyspell-off)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org82c41b1" class="outline-3">
<h3 id="org82c41b1"><span class="section-number-3">5.24</span> [latex-math-preview.el] TeX数式をプレビュー</h3>
<div class="outline-text-3" id="text-5-24">
<ul class="org-ul">
<li><a href="http://www.emacswiki.org/emacs/latex-math-preview.el">http://www.emacswiki.org/emacs/latex-math-preview.el</a><br /></li>
<li><a href="http://transitive.info/software/latex-math-preview/">http://transitive.info/software/latex-math-preview/</a><br /></li>
</ul>

<p>
以下の設定では， 数式で <code>&lt;f6&gt;</code> を押すとプレビューが走り，さらに <code>&lt;f6&gt;</code> を押すとプレビューウィンドウを閉じるように動作します．通常，=q= でプレビューを閉じられます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(latex-math-preview-expression
         latex-math-preview-insert-symbol
         latex-math-preview-save-image-file
         latex-math-preview-beamer-frame)
       <span style="color: #8b2252;">"latex-math-preview"</span> nil t nil)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"&lt;f6&gt;"</span>) 'latex-math-preview-expression))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"latex-math-preview"</span>
    (<span style="color: #a020f0;">setq</span> latex-math-preview-command-path-alist
          '((latex . <span style="color: #8b2252;">"latex"</span>)
            (dvipng . <span style="color: #8b2252;">"dvipng"</span>)
            (dvips . <span style="color: #8b2252;">"dvips"</span>)))
    (define-key latex-math-preview-expression-mode-map (kbd <span style="color: #8b2252;">"&lt;f6&gt;"</span>)
      'latex-math-preview-delete-buffer)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgafef3d3" class="outline-3">
<h3 id="orgafef3d3"><span class="section-number-3">5.25</span> [po-mode.el] 翻訳ファイルの編集</h3>
<div class="outline-text-3" id="text-5-25">
<ul class="org-ul">
<li><a href="http://www.emacswiki.org/emacs/PoMode">http://www.emacswiki.org/emacs/PoMode</a><br /></li>
<li><a href="http://www.emacswiki.org/emacs/po-mode+.el">http://www.emacswiki.org/emacs/po-mode+.el</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;</span><span style="color: #b22222;">(autoload 'po-mode "po-mode+" nil nil)</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(autoload 'po-mode "po-mode" nil t)</span>
(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(po-mode)
       <span style="color: #8b2252;">"po-mode"</span> nil t)

  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.po[tx]?\\'</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">|</span><span style="color: #8b2252;">\\.po\\$"</span> . po-mode) auto-mode-alist))
</pre>
</div>
</div>
</div>

<div id="outline-container-org64120a0" class="outline-3">
<h3 id="org64120a0"><span class="section-number-3">5.26</span> [word-count.el] リージョン内の文字をカウントする</h3>
<div class="outline-text-3" id="text-5-26">
<p>
有効な頒布元に変更があった．<a href="http://www.emacswiki.org/emacs/WordCount">word-count.el</a> から新しい頒布元にたどりつける．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(word-count-mode)
       <span style="color: #8b2252;">"word-count"</span> <span style="color: #8b2252;">"Minor mode to count words."</span> t)

  (global-set-key (kbd <span style="color: #8b2252;">"M-="</span>) 'word-count-mode))
</pre>
</div>

<p>
と思ったら，ビルドインの simple.el に十分な機能なのがあった．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (global-set-key (kbd <span style="color: #8b2252;">"M-="</span>) 'count-words))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga1cafe7" class="outline-3">
<h3 id="orga1cafe7"><span class="section-number-3">5.27</span> [yatex.el] YaTeXモード</h3>
<div class="outline-text-3" id="text-5-27">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(yatex-mode)
       <span style="color: #8b2252;">"yatex"</span> <span style="color: #8b2252;">"Yet Another LaTeX mode"</span> t)

  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.tex$"</span> . yatex-mode) auto-mode-alist)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Disable auto line break</span>
  (add-hook 'yatex-mode-hook
            #'(lambda ()
                (<span style="color: #a020f0;">setq</span> auto-fill-function nil)))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"yatex"</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">1=Shift JIS, 2=JIS, 3=EUC, 4=UTF-8</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq YaTeX-kanji-code nil)</span>
    (modify-coding-system-alist 'file <span style="color: #8b2252;">"\\.tex$'"</span> 'utf-8)))
</pre>
</div>

<p>
ショートカットの利用を強制するメッセージが出るので，抑制します．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"yatex"</span>
  (put 'YaTeX-insert-braces 'begend-guide 2)

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:YaTeX-insert-begin-end</span> (env region-mode)
    <span style="color: #8b2252;">"Insert \\begin{mode-name} and \\end{mode-name}.</span>
<span style="color: #8b2252;">This works also for other defined begin/end tokens to define the structure."</span>
    (<span style="color: #a020f0;">setq</span> YaTeX-current-completion-type 'begin)
    (<span style="color: #a020f0;">let*</span>((ccol (current-column)) beg beg2 exchange
          (_arg region-mode)    <span style="color: #b22222;">;</span><span style="color: #b22222;">for old compatibility</span>
          (indent-column (+ ccol YaTeX-environment-indent))(_i 1) _func)
      (<span style="color: #a020f0;">if</span> (<span style="color: #a020f0;">and</span> region-mode (&gt; (point) (mark)))
          (<span style="color: #a020f0;">progn</span> (exchange-point-and-mark)
                 (<span style="color: #a020f0;">setq</span> exchange t
                       ccol (current-column)
                       indent-column (+ ccol YaTeX-environment-indent))))
      <span style="color: #b22222;">;;</span><span style="color: #b22222;">VER2 (insert "\\begin{" env "}" (YaTeX-addin env))</span>
      (<span style="color: #a020f0;">setq</span> beg (point))
      (YaTeX-insert-struc 'begin env)
      (<span style="color: #a020f0;">setq</span> beg2 (point))
      (insert <span style="color: #8b2252;">"\n"</span>)
      (indent-to indent-column)
      (<span style="color: #a020f0;">save-excursion</span>
        <span style="color: #b22222;">;;</span><span style="color: #b22222;">indent optional argument of \begin{env}, if any</span>
        (<span style="color: #a020f0;">while</span> (&gt; (point-beginning-of-line) beg)
          (skip-chars-forward <span style="color: #8b2252;">"\\s "</span> (point-end-of-line))
          (indent-to indent-column)
          (forward-line -1)))
      (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">yatexenv</span>)
      (<span style="color: #a020f0;">if</span> region-mode
          <span style="color: #b22222;">;;</span><span style="color: #b22222;">if region-mode, indent all text in the region</span>
          (<span style="color: #a020f0;">save-excursion</span>
            (<span style="color: #a020f0;">if</span> (fboundp (intern-soft (concat <span style="color: #8b2252;">"YaTeX-enclose-"</span> env)))
                (funcall (intern-soft (concat <span style="color: #8b2252;">"YaTeX-enclose-"</span> env))
                         (point) (mark))
              (<span style="color: #a020f0;">while</span> (&lt; (<span style="color: #a020f0;">progn</span> (forward-line 1) (point)) (mark))
                (<span style="color: #a020f0;">if</span> (eolp) nil
                  (skip-chars-forward <span style="color: #8b2252;">" \t\n"</span>)
                  (indent-to indent-column))))))
      (<span style="color: #a020f0;">if</span> region-mode (exchange-point-and-mark))
      (indent-to ccol)
      <span style="color: #b22222;">;;</span><span style="color: #b22222;">VER2 (insert "\\end{" env "}\n")</span>
      (YaTeX-insert-struc 'end env)
      (YaTeX-reindent ccol)
      (<span style="color: #a020f0;">if</span> region-mode
          (<span style="color: #a020f0;">progn</span>
            (insert <span style="color: #8b2252;">"\n"</span>)
            (<span style="color: #a020f0;">or</span> exchange (exchange-point-and-mark)))
        (goto-char beg2)
        (YaTeX-intelligent-newline nil)
        (YaTeX-indent-line))
      (YaTeX-package-auto-usepackage env 'env)
      (<span style="color: #a020f0;">if</span> YaTeX-current-position-register
          (point-to-register YaTeX-current-position-register))))

  (advice-add 'YaTeX-insert-begin-end
              <span style="color: #483d8b;">:override</span> #'advice:YaTeX-insert-begin-end))
</pre>
</div>
</div>
</div>

<div id="outline-container-org98c7e9e" class="outline-3">
<h3 id="org98c7e9e"><span class="section-number-3">5.28</span> [auxtex.el] AUCTEXモード</h3>
<div class="outline-text-3" id="text-5-28">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(autotex-latexmk)
       <span style="color: #8b2252;">"autotex-latexmk"</span> nil t)
  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"autotex-latexmk"</span>
    (<span style="color: #a020f0;">setq</span> TeX-auto-save t)
    (<span style="color: #a020f0;">setq</span> TeX-parse-self t)
    (<span style="color: #a020f0;">setq-default</span> TeX-master nil)
    (<span style="color: #a020f0;">setq</span> TeX-PDF-mode t)
    (auctex-latexmk-setup))
  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.tex$"</span> . autotex-latexmk) auto-mode-alist))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga36f537" class="outline-3">
<h3 id="orga36f537"><span class="section-number-3">5.29</span> [display-time-world-mode] 世界時計</h3>
<div class="outline-text-3" id="text-5-29">
<p>
世界の時刻を確認するために wclock.el がありました（参考：<a href="https://pxaka.tokyo/wiki/doku.php?id=emacs%EF%BC%89%E3%81%8C%EF%BC%8C%E7%8F%BE%E5%9C%A8%E3%81%AF%E3%83%93%E3%83%AB%E3%83%88%E3%82%A4%E3%83%B3%E3%81%AE">https://pxaka.tokyo/wiki/doku.php?id=emacs）が，現在はビルトインの</a> <code>time.el</code> に <code>display-time-world-mode</code> として吸収されているようです． <code>display-time-world-buffer-name</code> に wclock が設定されているところが名残と思われます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(display-time-world)
       <span style="color: #8b2252;">"time"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"time"</span>
    (define-key display-time-world-mode-map <span style="color: #8b2252;">"q"</span> 'delete-window)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc244b8b" class="outline-3">
<h3 id="orgc244b8b"><span class="section-number-3">5.30</span> [yasnippet.el] Emacs用のテンプレートシステム</h3>
<div class="outline-text-3" id="text-5-30">
<ul class="org-ul">
<li><a href="https://github.com/capitaomorte/yasnippet">https://github.com/capitaomorte/yasnippet</a><br /></li>
<li><a href="http://yasnippet-doc-jp.googlecode.com/svn/trunk/doc-jp/index.html">http://yasnippet-doc-jp.googlecode.com/svn/trunk/doc-jp/index.html</a><br /></li>
<li><a href="http://d.hatena.ne.jp/IMAKADO/20080401/1206715770">http://d.hatena.ne.jp/IMAKADO/20080401/1206715770</a><br /></li>
<li><a href="http://coderepos.org/share/browser/config/yasnippet">http://coderepos.org/share/browser/config/yasnippet</a><br /></li>
<li><a href="https://github.com/RickMoynihan/yasnippet-org-mode">https://github.com/RickMoynihan/yasnippet-org-mode</a><br /></li>
</ul>

<p>
<a href="http://orgmode.org/manual/Conflicts.html">Org-modeとの衝突を避ける</a><br />
</p>

<p>
↑のサイトで紹介されている回避策とは異なり，新たな <code>my-yas-expand</code> を作ることで，orgバッファのソースブロック中で <code>TAB</code> 押下してもエラーを受けないようにしました．ソースコードは <code>C-c '</code> で開く別バッファで編集します．<br />
</p>

<p>
↑どうやら<a href="https://github.com/joaotavora/yasnippet/commit/0041efedf9f06bfe427d36547f7c4a73ab7405ba">本家で対応</a>がされたようです． <code>my-yas-expand</code> なしで所望の動作になりました．ありがたや，ありがたや．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(yas-minor-mode yas-global-mode)
       <span style="color: #8b2252;">"yasnippet"</span> nil t)

  (<span style="color: #a020f0;">dolist</span> (hook
           (list
            'perl-mode-hook 'c-mode-common-hook 'js2-mode-hook 'org-mode-hook
            'python-mode-hook 'emacs-lisp-mode-hook))
    (add-hook hook #'yas-minor-mode))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"yasnippet"</span>
    (<span style="color: #a020f0;">setq</span> yas-verbosity 2)
    (<span style="color: #a020f0;">setq</span> yas-snippet-dirs
          (list <span style="color: #8b2252;">"~/Dropbox/emacs.d/yas-dict"</span>
                'yas-installed-snippets-dir)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">for Cask</span>

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-yas-expand-src-edit</span> (<span style="color: #228b22;">&amp;optional</span> field)
      <span style="color: #8b2252;">"Override `</span><span style="color: #008b8b;">yas-expand</span><span style="color: #8b2252;">'. Kick `</span><span style="color: #008b8b;">org-edit-special</span><span style="color: #8b2252;">' directly in src-block."</span>
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">cond</span> ((<span style="color: #a020f0;">and</span> (equal major-mode 'org-mode)
                  (org-in-src-block-p t))
             (org-edit-special))
            (t
             (yas-expand field))))

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-yas-expand</span> (<span style="color: #228b22;">&amp;optional</span> field)
      <span style="color: #8b2252;">"Disable `</span><span style="color: #008b8b;">yas-expand</span><span style="color: #8b2252;">' in src-block."</span>
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">cond</span> ((<span style="color: #a020f0;">and</span> (equal major-mode 'org-mode)
                  (org-at-heading-p))
             (org-cycle))
            ((<span style="color: #a020f0;">and</span> (equal major-mode 'org-mode)
                  (org-in-src-block-p t)
                  (not (<span style="color: #a020f0;">and</span> (fboundp 'org-src-edit-buffer-p)
                            (org-src-edit-buffer-p))))
             (org-cycle))
            (t (yas-expand field))))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26412;&#23478;&#12391;&#12365;&#12385;&#12435;&#12392;&#23550;&#24540;&#12373;&#12428;&#12383;&#12398;&#12391;&#65292;&#19981;&#35201;&#12395;&#12394;&#12387;&#12383;&#65294;</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(define-key yas-minor-mode-map (kbd "&lt;tab&gt;") 'my-yas-expand)</span>
    (<span style="color: #a020f0;">unless</span> batch-build
      (yas-global-mode 1))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf2688a1" class="outline-3">
<h3 id="orgf2688a1"><span class="section-number-3">5.31</span> [sdic.el] 英辞郎で英単語を調べる</h3>
<div class="outline-text-3" id="text-5-31">
<p>
<a href="http://www.namazu.org/~tsuchiya/sdic/index.html">http://www.namazu.org/~tsuchiya/sdic/index.html</a><br />
</p>

<p>
Emacs から辞書を使う．lookup を使う方法もあるが，Emacsから使うのは英辞郎に限定．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(sdic-describe-word sdic-describe-word-at-point)
       <span style="color: #8b2252;">"sdic"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"sdic"</span>
    (<span style="color: #a020f0;">setq</span> sdic-face-color <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #3333FF;">#3333FF</span><span style="color: #8b2252;">"</span>)
    (<span style="color: #a020f0;">setq</span> sdic-default-coding-system 'utf-8)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Dictionary (English =&gt; Japanese)</span>
    (<span style="color: #a020f0;">setq</span> sdic-eiwa-dictionary-list
          '((sdicf-client <span style="color: #8b2252;">"~/Dropbox/Dic/EIJIRO6/EIJI-128.sdic"</span>)))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Dictionary (Japanese =&gt; English)</span>
    (<span style="color: #a020f0;">setq</span> sdic-waei-dictionary-list
          '((sdicf-client <span style="color: #8b2252;">"~/Dropbox/Dic/EIJIRO6/WAEI-128.sdic"</span>))))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12459;&#12540;&#12477;&#12523;&#12398;&#20301;&#32622;&#12398;&#33521;&#21336;&#35486;&#12398;&#24847;&#21619;&#12434;&#35519;&#12409;&#12427;</span>
  (global-set-key (kbd <span style="color: #8b2252;">"C-M-w"</span>) 'sdic-describe-word-at-point)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12511;&#12491;&#12496;&#12483;&#12501;&#12449;&#12395;&#33521;&#21336;&#35486;&#12434;&#20837;&#12428;&#12390;&#33521;&#36766;&#37070;&#12434;&#20351;&#12358;</span>
  (global-set-key (kbd <span style="color: #8b2252;">"C-c w"</span>) 'sdic-describe-word))
</pre>
</div>
</div>
</div>

<div id="outline-container-org039db45" class="outline-3">
<h3 id="org039db45"><span class="section-number-3">5.32</span> [osx-dictionary.el] MacOSのdictionary.appで辞書をひく</h3>
<div class="outline-text-3" id="text-5-32">
<p>
<code>osx-dictionary</code> なるパッケージが存在します．さくさくと高速に動作します．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(osx-dictionary-search-pointer osx-dictionary-search-input)
       <span style="color: #8b2252;">"osx-dictionary"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-c f w"</span>) #'osx-dictionary-search-input)
    (global-set-key (kbd <span style="color: #8b2252;">"C-M-w"</span>) #'osx-dictionary-search-pointer))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"osx-dictionary"</span>
    (custom-set-variables
     '(osx-dictionary-dictionary-choice <span style="color: #8b2252;">"&#33521;&#36766;&#37070; &#31532;&#19971;&#29256;"</span>))))
</pre>
</div>

<p>
COBUILD5をデフォルトで使うには，次のサイト参照してください．<br />
</p>

<ul class="org-ul">
<li><a href="http://safx-dev.blogspot.jp/2012/02/collins-cobuld-5dictionaryapp.html">Collins COBULD 5をDictionary.appで利用できるようにする</a><br /></li>
</ul>

<p>
私の場合は，できあがった辞書を <code>/Library/Dictionaries/</code> 以下に置いています．その状態で dictionary.app の設定で辞書の優先順位を変えることで，常にCOBUILD5の情報を引っ張り出せます．もしくは， <code>osx-dictionary-dictionary-choice</code> で辞書名を指定します．<br />
</p>
</div>

<div id="outline-container-org62e7526" class="outline-4">
<h4 id="org62e7526"><span class="section-number-4">5.32.1</span> MacOSのdictionary.appでCOBUILD5の辞書をひく（旧）</h4>
<div class="outline-text-4" id="text-5-32-1">
<p>
OS標準の辞書アプリ（dictionary.app）を経由して，バッファにCOBUILD5のデータを流し込むことができます．<br />
</p>

<ul class="org-ul">
<li><a href="http://sakito.jp/mac/dictionary.html#emacs">辞書(Dictionary).appを使い倒そう</a><br /></li>
</ul>

<p>
以下の関数を準備します．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">dictionary</span> ()
  <span style="color: #8b2252;">"dictionary.app"</span>
  (<span style="color: #a020f0;">interactive</span>)

  (<span style="color: #a020f0;">let</span> ((editable (not buffer-read-only))
        (pt (<span style="color: #a020f0;">save-excursion</span> (mouse-set-point last-nonmenu-event)))
        beg end)

    (<span style="color: #a020f0;">if</span> (<span style="color: #a020f0;">and</span> mark-active
             (&lt;= (region-beginning) pt) (&lt;= pt (region-end)) )
        (<span style="color: #a020f0;">setq</span> beg (region-beginning)
              end (region-end))
      (<span style="color: #a020f0;">save-excursion</span>
        (goto-char pt)
        (<span style="color: #a020f0;">setq</span> end (<span style="color: #a020f0;">progn</span> (forward-word) (point)))
        (<span style="color: #a020f0;">setq</span> beg (<span style="color: #a020f0;">progn</span> (backward-word) (point)))
        ))

    (<span style="color: #a020f0;">let</span> ((word (buffer-substring-no-properties beg end))
          <span style="color: #b22222;">;;            </span><span style="color: #b22222;">(win (selected-window))</span>
          (tmpbuf <span style="color: #8b2252;">" * dict-process*"</span>))
      (pop-to-buffer tmpbuf)
      (erase-buffer)
      (insert <span style="color: #8b2252;">"Query: "</span> word <span style="color: #8b2252;">"\n\n"</span>)
      (start-process <span style="color: #8b2252;">"dict-process"</span> tmpbuf <span style="color: #8b2252;">"dict.py"</span> word)
      (goto-char 0)
      <span style="color: #b22222;">;;        </span><span style="color: #b22222;">(select-window win)</span>
      )))
</pre>
</div>

<p>
これでカーソル以下の単語の情報が別ウィンドウに出ます．チェックし終わったら <code>C-x 1</code> (delete-other-windows) で表示を閉じます． <code>q</code> で閉じられるようにしたり，ツールチップで表示したりもできるはずです．<br />
</p>

<p>
マスタカさんのナイスソリューションをまだ試していないので，こちらの方がエレガントかもしれません．<br />
</p>

<ul class="org-ul">
<li><a href="http://masutaka.net/chalow/2011-05-18-1.html">Emacs で Mac の辞書を sdic っぽく使う </a><br /></li>
<li><a href="http://masutaka.net/chalow/2012-09-17-1.html">EmacsからMacの辞書をお手軽に使う</a><br /></li>
</ul>

<p>
なお，COBUILD5の辞書データをdictionary.appで引けるようにするには以下の操作が必要です．<br />
</p>

<ul class="org-ul">
<li><a href="http://safx-dev.blogspot.jp/2012/02/collins-cobuld-5dictionaryapp.html">Collins COBULD 5をDictionary.appで利用できるようにする</a><br /></li>
</ul>

<p>
私の場合は，できあがった辞書を <code>/Library/Dictionaries/</code> 以下に置いています．その状態で dictionary.app の設定で辞書の優先順位を変えることで，常にCOBUILD5の情報を引っ張り出せます．<br />
</p>
</div>

<ol class="org-ol">
<li><a id="org8555b51"></a>マイナーモード化<br />
<div class="outline-text-5" id="text-5-32-1-1">
<p>
<code>q</code> で閉じたくなったのでマイナーモードを作りました．これまで通り， <code>C-M-w</code> でカーソル下の単語を調べてポップアップで表示．カーソルはその新しいバッファに移しておき， <code>q</code> で閉じられます．新しいバッファ内で別な単語を <code>C-M-w</code> で調べると，同じバッファに結果を再描画します．<br />
</p>

<p>
マイナーモード化した elisp は，<a href="https://gist.github.com/takaxp/9786376">gist</a>で公開しています．<br />
</p>
</div>
</li>

<li><a id="org8fbd76f"></a>キーバインド<br />
<div class="outline-text-5" id="text-5-32-1-2">
<p>
マイナーモード化した dict-app を使う場合は以下のようにします．sdic を使っている人は，sdic 用の設定と衝突しないように気をつけます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(dict-app-search)
       <span style="color: #8b2252;">"dict-app"</span> nil t)

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12459;&#12540;&#12477;&#12523;&#12398;&#20301;&#32622;&#12398;&#33521;&#21336;&#35486;&#12398;&#24847;&#21619;&#12434;&#35519;&#12409;&#12427;</span>
  (global-set-key (kbd <span style="color: #8b2252;">"C-M-w"</span>) 'dict-app-search))
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org1fd59fb" class="outline-3">
<h3 id="org1fd59fb"><span class="section-number-3">5.33</span> [lookup.el] 辞書</h3>
<div class="outline-text-3" id="text-5-33">
<p>
最近使っていません．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">.lookup/cache.el</span>
(<span style="color: #a020f0;">setq</span> lookup-init-directory <span style="color: #8b2252;">"~/env/dot_files/.lookup"</span>)

(autoload 'lookup <span style="color: #8b2252;">"lookup"</span> nil t)
(autoload 'lookup-region <span style="color: #8b2252;">"lookup"</span> nil t)
(autoload 'lookup-word <span style="color: #8b2252;">"lookup"</span> nil t)
(autoload 'lookup-select-dictionaries <span style="color: #8b2252;">"lookup"</span> nil t)

(<span style="color: #a020f0;">setq</span> lookup-search-modules
      '((<span style="color: #8b2252;">"default"</span>
         (<span style="color: #8b2252;">"ndeb:/Users/taka/Dropbox/Dic/COBUILD5/cobuild"</span> <span style="color: #483d8b;">:priority</span> t)
         (<span style="color: #8b2252;">"ndeb:/Users/taka/Dropbox/Dic/COBUILD5/wordbank"</span> <span style="color: #483d8b;">:priority</span> t)
         (<span style="color: #8b2252;">"ndeb:/Users/taka/Dropbox/Dic/LDOCE4/ldoce4"</span> <span style="color: #483d8b;">:priority</span> t)
         (<span style="color: #8b2252;">"ndeb:/Users/taka/Dropbox/Dic/LDOCE4/bank"</span> <span style="color: #483d8b;">:priority</span> t)
         (<span style="color: #8b2252;">"ndeb:/Users/taka/Dropbox/Dic/LDOCE4/colloc"</span> <span style="color: #483d8b;">:priority</span> t)
         (<span style="color: #8b2252;">"ndeb:/Users/taka/Dropbox/Dic/LDOCE4/activ"</span> <span style="color: #483d8b;">:priority</span> t))))

(<span style="color: #a020f0;">setq</span> lookup-agent-attributes
      '((<span style="color: #8b2252;">"ndeb:/Users/taka/Dropbox/Dic/COBUILD5"</span>
         (dictionaries <span style="color: #8b2252;">"cobuild"</span> <span style="color: #8b2252;">"wordbank"</span>))
        (<span style="color: #8b2252;">"ndeb:/Users/taka/Dropbox/Dic/LDOCE4"</span>
         (dictionaries <span style="color: #8b2252;">"ldoce4"</span> <span style="color: #8b2252;">"bank"</span> <span style="color: #8b2252;">"colloc"</span> <span style="color: #8b2252;">"activ"</span>))))

(<span style="color: #a020f0;">setq</span> lookup-dictionary-attributes
      '((<span style="color: #8b2252;">"ndeb:/Users/taka/Dropbox/Dic/COBUILD5/cobuild"</span>
         (title . <span style="color: #8b2252;">"COBUILD 5th Edition"</span>)
         (methods exact prefix))
        (<span style="color: #8b2252;">"ndeb:/Users/taka/Dropbox/Dic/COBUILD5/wordbank"</span>
         (title . <span style="color: #8b2252;">"Wordbank"</span>)
         (methods))
        (<span style="color: #8b2252;">"ndeb:/Users/taka/Dropbox/Dic/LDOCE4/ldoce4"</span>
         (title . <span style="color: #8b2252;">"Longman 4th Edition"</span>)
         (methods exact prefix))
        (<span style="color: #8b2252;">"ndeb:/Users/taka/Dropbox/Dic/LDOCE4/bank"</span>
         (title . <span style="color: #8b2252;">"LDOCE4 Examples and Phrases"</span>)
         (methods exact prefix menu))
        (<span style="color: #8b2252;">"ndeb:/Users/taka/Dropbox/Dic/LDOCE4/colloc"</span>
         (title . <span style="color: #8b2252;">"LDOCE4 Collocation"</span>)
         (methods exact prefix))
        (<span style="color: #8b2252;">"ndeb:/Users/taka/Dropbox/Dic/LDOCE4/activ"</span>
         (title . <span style="color: #8b2252;">"Longman Activator"</span>)
         (methods exact prefix menu))))

(<span style="color: #a020f0;">setq</span> lookup-default-dictionary-options
      '((<span style="color: #483d8b;">:stemmer</span> .  stem-english)))
(<span style="color: #a020f0;">setq</span> lookup-use-kakasi nil)
(global-set-key (kbd <span style="color: #8b2252;">"&lt;f6&gt;"</span>) 'lookup-word)

<span style="color: #b22222;">;;; </span><span style="color: #b22222;">lookup for dictionary (require EB Library, eblook, and lookup.el)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">package download: http://sourceforge.net/projects/lookup</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">http://lookup.sourceforge.net/docs/ja/index.shtml#Top</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">http://www.bookshelf.jp/texi/lookup/lookup-guide.html#SEC_Top</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(load "lookup-autoloads") ; for 1.99</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(autoload 'lookup "lookup" nil t)</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(autoload 'lookup-region "lookup" nil t)</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(autoload 'lookup-word "lookup" nil t)</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(autoload 'lookup-select-dictionaries "lookup" nil t)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">Search Agents</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">ndeb option requries "eblook" command</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">Use expand-file-name!</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(setq lookup-search-agents `((ndeb ,(concat homedir "/Dropbox/Dic/COBUILD5"))</span>
<span style="color: #b22222;">;;                            </span><span style="color: #b22222;">(ndeb ,(concat homedir "/Dropbox/Dic/LDOCE4"))))</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(setq lookup-use-bitmap nil)</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(setq ndeb-program-name "/usr/bin/eblook")</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(when (eq window-system 'ns)</span>
<span style="color: #b22222;">;;  </span><span style="color: #b22222;">(setq ndeb-program-name "/opt/local/bin/eblook")</span>
<span style="color: #b22222;">;;  </span><span style="color: #b22222;">(setq ndeb-program-arguments '("-q" "-e" "euc-jp"))</span>
<span style="color: #b22222;">;;  </span><span style="color: #b22222;">(setq ndeb-process-coding-system 'utf-8)) ; utf-8-hfs</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org549c0f1" class="outline-3">
<h3 id="org549c0f1"><span class="section-number-3">5.34</span> [cacoo] Cacoo で描く</h3>
<div class="outline-text-3" id="text-5-34">
<p>
画像をリサイズしてバッファに表示する用途にも使える．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(toggle-cacoo-minor-mode)
       <span style="color: #8b2252;">"cacoo"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"cacoo"</span>
    (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">cacoo-plugins</span>))

  (global-set-key (kbd <span style="color: #8b2252;">"M--"</span>) 'toggle-cacoo-minor-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org8fd4b2b" class="outline-3">
<h3 id="org8fd4b2b"><span class="section-number-3">5.35</span> [iedit] バッファ内の同じ文字列を一度に編集する</h3>
<div class="outline-text-3" id="text-5-35">
<p>
<a href="http://emacswiki.org/emacs/iedit.el">iedit.el</a> を使うと，バッファ内の同じ文字列を一度に編集することができる．部分重複のない変数名を置き換えるときに有用な場合がある．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">iedit</span> nil t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org1f7ac0d" class="outline-3">
<h3 id="org1f7ac0d"><span class="section-number-3">5.36</span> [web-mode] HTML編集</h3>
<div class="outline-text-3" id="text-5-36">
<p>
HTML編集をするなら <a href="http://web-mode.org/">web-mode</a> がお勧めです．古いHTMLモードを使っている方は，移行時期です．以下の <code>my-web-indent-fold</code> では， タブキーを打つたびにタグでくくられた領域を展開／非表示して整形します．Org-mode っぽい動作になりますが，操作の度にバッファに変更が加わったと判断されるので好みが分かれると思います．自動保存を有効にしているとそれほど気になりません．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(web-mode)
       <span style="color: #8b2252;">"web-mode"</span> <span style="color: #8b2252;">"web-mode"</span> t)

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">web-mode &#12391;&#38283;&#12367;&#12501;&#12449;&#12452;&#12523;&#12398;&#25313;&#24373;&#23376;&#12434;&#25351;&#23450;</span>
  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.phtml\\'"</span> . web-mode) auto-mode-alist)
  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.tpl\\.php\\'"</span> . web-mode) auto-mode-alist)
  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.jsp\\'"</span> . web-mode) auto-mode-alist)
  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.as[cp]x\\'"</span> . web-mode) auto-mode-alist)
  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.erb\\'"</span> . web-mode) auto-mode-alist)
  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.mustache\\'"</span> . web-mode) auto-mode-alist)
  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.djhtml\\'"</span> . web-mode) auto-mode-alist)
  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.html?\\'"</span> . web-mode) auto-mode-alist)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"web-mode"</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-web-indent-fold</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (web-mode-fold-or-unfold)
      (web-mode-buffer-indent)
      (indent-for-tab-command))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">indent</span>
    (<span style="color: #a020f0;">setq</span> web-mode-markup-indent-offset 1)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#33394;&#12398;&#35373;&#23450;</span>
    (custom-set-faces
     <span style="color: #b22222;">;; </span><span style="color: #b22222;">custom-set-faces was added by Custom.</span>
     <span style="color: #b22222;">;; </span><span style="color: #b22222;">If you edit it by hand, you could mess it up, so be careful.</span>
     <span style="color: #b22222;">;; </span><span style="color: #b22222;">Your init file should contain only one such instance.</span>
     <span style="color: #b22222;">;; </span><span style="color: #b22222;">If there is more than one, they won't work right.</span>
     '(web-mode-comment-face ((t (<span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #D9333F;">#D9333F</span><span style="color: #8b2252;">"</span>))))
     '(web-mode-css-at-rule-face ((t (<span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FF7F00;">#FF7F00</span><span style="color: #8b2252;">"</span>))))
     '(web-mode-css-pseudo-class-face ((t (<span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FF7F00;">#FF7F00</span><span style="color: #8b2252;">"</span>))))
     '(web-mode-css-rule-face ((t (<span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #A0D8EF;">#A0D8EF</span><span style="color: #8b2252;">"</span>))))
     '(web-mode-doctype-face ((t (<span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #82AE46;">#82AE46</span><span style="color: #8b2252;">"</span>))))
     '(web-mode-html-attr-name-face ((t (<span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #C97586;">#C97586</span><span style="color: #8b2252;">"</span>))))
     '(web-mode-html-attr-value-face ((t (<span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #82AE46;">#82AE46</span><span style="color: #8b2252;">"</span>))))
     '(web-mode-html-tag-face ((t (<span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"#</span><span style="color: #ffffff; background-color: #4682ae;">#4682ae</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:weight</span> bold))))
     '(web-mode-server-comment-face ((t (<span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #D9333F;">#D9333F</span><span style="color: #8b2252;">"</span>)))))
    (define-key web-mode-map (kbd <span style="color: #8b2252;">"&lt;tab&gt;"</span>) 'my-web-indent-fold)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org1bf9410" class="outline-3">
<h3 id="org1bf9410"><span class="section-number-3">5.37</span> [emmet-mode] zencoding の後継</h3>
<div class="outline-text-3" id="text-5-37">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(emmet-mode)
       <span style="color: #8b2252;">"emmet-mode"</span> nil t nil)

  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.xml\\'"</span> . nxml-mode) auto-mode-alist)
  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.rdf\\'"</span> . nxml-mode) auto-mode-alist)
  (<span style="color: #a020f0;">dolist</span> (hook
           '(sgml-mode-hook
             nxml-mode-hook css-mode-hook html-mode-hook web-mode-hook))
    (add-hook hook #'emmet-mode))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"emmet-mode"</span>
    (<span style="color: #a020f0;">setq</span> emmet-indentation 2)
    (<span style="color: #a020f0;">setq</span> emmet-move-cursor-between-quotes t)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3ccce95" class="outline-3">
<h3 id="org3ccce95"><span class="section-number-3">5.38</span> [zencoding-mode] HTML編集の高速化（旧）</h3>
<div class="outline-text-3" id="text-5-38">
<p>
zencoding でタグ打ちを効率化します．今は emmet-mode を使います．<br />
</p>

<ul class="org-ul">
<li><a href="http://www.emacswiki.org/emacs/ZenCoding">http://www.emacswiki.org/emacs/ZenCoding</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(zencoding-mode zencoding-expand-line)
       <span style="color: #8b2252;">"zencoding-mode"</span> <span style="color: #8b2252;">"Zen-coding"</span> t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"zencoding-mode"</span>
    (define-key zencoding-mode-keymap
      (kbd <span style="color: #8b2252;">"M-&lt;return&gt;"</span>) 'zencoding-expand-line))

  (add-hook 'sgml-mode-hook #'zencoding-mode)
  (add-hook 'html-mode-hook #'zencoding-mode)
  (add-hook 'web-mode-hook #'zencoding-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org54fa465" class="outline-3">
<h3 id="org54fa465"><span class="section-number-3">5.39</span> [describe-number] 16進数などを確認</h3>
<div class="outline-text-3" id="text-5-39">
<p>
<code>describe-number.el</code> を使うと，16進数表示や文字コードを確認できます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(autoload-if-found
 '(describe-number describe-number-at-point)
 <span style="color: #8b2252;">"describe-number"</span> nil t)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfb25de2" class="outline-3">
<h3 id="orgfb25de2"><span class="section-number-3">5.40</span> [web-beautify.el] ソースコード整形</h3>
<div class="outline-text-3" id="text-5-40">
<p>
ソースコードを読みやすい表示に整形します．バッファの自動時に自動で整形を実施するには， <code>after-save-hook</code> を使えばOKですね．<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">JavaScript</td>
<td class="org-left">M-x web-beautify-js</td>
</tr>

<tr>
<td class="org-left">HTML</td>
<td class="org-left">M-x web-beautify-html</td>
</tr>

<tr>
<td class="org-left">CSS</td>
<td class="org-left">M-x web-beautify-css</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">if</span> (executable-find <span style="color: #8b2252;">"js-beautify"</span>)
    (<span style="color: #a020f0;">when</span> (autoload-if-found
           '(js2-mode)
           <span style="color: #8b2252;">"js2-mode"</span> nil t)

      (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"js2-mode"</span>
        (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">web-beautify</span> nil t)
          (define-key js2-mode-map (kbd <span style="color: #8b2252;">"C-c b"</span>) 'web-beautify-js)
          (define-key js2-mode-map (kbd <span style="color: #8b2252;">"C-c b"</span>) 'web-beautify-css))))

  (message <span style="color: #8b2252;">"--- js-beautify is NOT installed."</span>)
  (message <span style="color: #8b2252;">"--- Note: npm -g install js-beautify"</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd0956dd" class="outline-3">
<h3 id="orgd0956dd"><span class="section-number-3">5.41</span> [smartparens.el] 対応するカッコの挿入をアシスト</h3>
<div class="outline-text-3" id="text-5-41">
<ul class="org-ul">
<li><a href="http://smartparens.readthedocs.io/">http://smartparens.readthedocs.io/</a><br /></li>
</ul>

<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">smartparens</span> nil t)
    (<span style="color: #a020f0;">setq-default</span> sp-highlight-pair-overlay nil)
    (<span style="color: #a020f0;">setq-default</span> sp-highlight-wrap-overlay nil)
    (<span style="color: #a020f0;">setq-default</span> sp-highlight-wrap-tag-overlay nil)
    (sp-local-pair 'org-mode <span style="color: #8b2252;">"$"</span> <span style="color: #8b2252;">"$"</span>)
    (sp-local-pair 'yatex-mode <span style="color: #8b2252;">"$"</span> <span style="color: #8b2252;">"$"</span>)
    (sp-local-pair 'emacs-lisp-mode <span style="color: #8b2252;">"`"</span> <span style="color: #8b2252;">"'"</span>)
    (sp-pair <span style="color: #8b2252;">"`"</span> nil <span style="color: #483d8b;">:actions</span> <span style="color: #483d8b;">:rem</span>)
    (sp-pair <span style="color: #8b2252;">"'"</span> nil <span style="color: #483d8b;">:actions</span> <span style="color: #483d8b;">:rem</span>)
    (sp-pair <span style="color: #8b2252;">"["</span> nil <span style="color: #483d8b;">:actions</span> <span style="color: #483d8b;">:rem</span>)
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"smartparens"</span>)
      (smartparens-global-mode))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7fd606d" class="outline-3">
<h3 id="org7fd606d"><span class="section-number-3">5.42</span> <span class="todo TODO">TODO</span> [isolate.el] ブラケット等の入力をアシスト</h3>
<div class="outline-text-3" id="text-5-42">
<ul class="org-ul">
<li><a href="https://github.com/casouri/isolate">casouri/isolate: Surrounding magics, extensible</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(autoload-if-found
 '(isolate-quick-add isolate-long-add isolate-quick-delete
                     isolate-quick-chnge isolate-long-change)
 <span style="color: #8b2252;">"isolate"</span> nil t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org96b0073" class="outline-3">
<h3 id="org96b0073"><span class="section-number-3">5.43</span> [replace-from-region.el] 選択領域を別の文字列に置き換える</h3>
<div class="outline-text-3" id="text-5-43">
<ul class="org-ul">
<li><a href="https://www.emacswiki.org/emacs/replace-from-region.el">https://www.emacswiki.org/emacs/replace-from-region.el</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(autoload-if-found
 '(query-replace-from-region query-replace-regexp-from-region)
 <span style="color: #8b2252;">"replace-from-region"</span> nil t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org8e1b3ca" class="outline-3">
<h3 id="org8e1b3ca"><span class="section-number-3">5.44</span> [selected.el] リージョン選択時のアクションを制御&#xa0;&#xa0;&#xa0;<span class="tag"><span class="Doing">Doing</span></span></h3>
<div class="outline-text-3" id="text-5-44">
<p>
選択した後に右クリック的な感じでリージョンに対するアクションを制御できます．選択領域に対するスピードコマンドですね．普通にシングルキーを割り当てると，日本語IMEが有効な時に上手くいかないので， <code>activate-mark-hook</code> と <code>deactivate-mark-hook</code> に細工しています．<br />
</p>

<ul class="org-ul">
<li><a href="https://github.com/Kungsgeten/selected.el">Kungsgeten/selected.el: Keymap for when region is active</a><br /></li>
<li><a href="https://www.reddit.com/r/emacs/comments/4fxnss/selectedel_keymap_for_when_region_is_active/">selected.el - Keymap for when region is active : emacs</a><br /></li>
</ul>

<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">selected</span> nil t)
    (define-key selected-keymap (kbd <span style="color: #8b2252;">";"</span>) #'comment-dwim)
    (define-key selected-keymap (kbd <span style="color: #8b2252;">"e"</span>) #'my-eval-region-echo)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(define-key selected-keymap (kbd "E") #'my-eval-region-echo-as-function)</span>
    (define-key selected-keymap (kbd <span style="color: #8b2252;">"="</span>) #'count-words-region)
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">helpful</span> nil t)
      (define-key selected-keymap (kbd <span style="color: #8b2252;">"m"</span>) #'helpful-macro))
    (define-key selected-keymap (kbd <span style="color: #8b2252;">"f"</span>)
      (<span style="color: #a020f0;">if</span> (fboundp 'helpful-function) #'helpful-function #'describe-function))
    (define-key selected-keymap (kbd <span style="color: #8b2252;">"v"</span>)
      (<span style="color: #a020f0;">if</span> (fboundp 'helpful-variable) #'helpful-variable #'describe-variable))
    (define-key selected-keymap (kbd <span style="color: #8b2252;">"w"</span>) #'osx-dictionary-search-pointer)
    (define-key selected-keymap (kbd <span style="color: #8b2252;">"5"</span>) #'query-replace-from-region)
    (define-key selected-keymap (kbd <span style="color: #8b2252;">"g"</span>) #'my-google-this)
    (define-key selected-keymap (kbd <span style="color: #8b2252;">"s"</span>) #'osx-lib-say-region)
    (define-key selected-keymap (kbd <span style="color: #8b2252;">"q"</span>) #'selected-off)
    (define-key selected-keymap (kbd <span style="color: #8b2252;">"x"</span>) #'my-hex-to-decimal)
    (define-key selected-keymap (kbd <span style="color: #8b2252;">"X"</span>) #'my-decimal-to-hex)
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-eval-region-echo</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">when</span> mark-active
        (eval-region (region-beginning) (region-end) t)))
    (<span style="color: #a020f0;">setq</span> selected-org-mode-map (make-sparse-keymap))
    (define-key selected-org-mode-map (kbd <span style="color: #8b2252;">"t"</span>) #'org-table-convert-region)

    (<span style="color: #a020f0;">when</span> (autoload-if-found
           '(my-org-list-insert-items my-org-list-insert-checkbox-into-items)
           <span style="color: #8b2252;">"utility"</span> nil t)

      (define-key selected-keymap (kbd <span style="color: #8b2252;">"-"</span>) #'my-org-list-insert-items)
      (define-key selected-keymap (kbd <span style="color: #8b2252;">"_"</span>)
        #'my-org-list-insert-checkbox-into-items))

    (<span style="color: #a020f0;">when</span> (autoload-if-found
           '(helm-selected)
           <span style="color: #8b2252;">"helm-selected"</span> nil t)
      (define-key selected-keymap (kbd <span style="color: #8b2252;">"h"</span>) 'helm-selected))

    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">help-fns+</span> nil t)
      (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-describe-selected-keymap</span> ()
        (<span style="color: #a020f0;">interactive</span>)
        (describe-keymap 'selected-keymap))
      (define-key selected-keymap (kbd <span style="color: #8b2252;">"H"</span>) #'my-describe-selected-keymap))
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"selected"</span>)
      (selected-global-mode 1))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org9c30a84" class="outline-3">
<h3 id="org9c30a84"><span class="section-number-3">5.45</span> [helm-selected.el] selecte.el のアクション候補を絞り込み</h3>
<div class="outline-text-3" id="text-5-45">
<ul class="org-ul">
<li><a href="https://qiita.com/takaxp/items/00245794d46c3a5fcaa8">記事</a>にしました．<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found '(helm-selected) <span style="color: #8b2252;">"helm-selected"</span> nil t)
  (define-key selected-keymap (kbd <span style="color: #8b2252;">"h"</span>) 'helm-selected))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaba6d27" class="outline-3">
<h3 id="orgaba6d27"><span class="section-number-3">5.46</span> <span class="todo TODO">TODO</span> [git-complete.el] GIT grep を使う補完エンジン</h3>
<div class="outline-text-3" id="text-5-46">
<ul class="org-ul">
<li><a href="https://github.com/zk-phi/git-complete">zk-phi/git-complete: {Emacs} Yet another completion engine powered by "git grep"</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(git-complete)
       <span style="color: #8b2252;">"git-complete"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-c f &lt;tab&gt;"</span>) 'git-complete)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org2314d1c" class="outline-3">
<h3 id="org2314d1c"><span class="section-number-3">5.47</span> <span class="todo TODO">TODO</span> [tiny.el] 連番入力をサポート</h3>
<div class="outline-text-3" id="text-5-47">
<ul class="org-ul">
<li><a href="https://github.com/abo-abo/tiny">abo-abo/tiny: Quickly generate linear ranges in Emacs</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">tiny</span> nil t)
  (tiny-setup-default))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb14aa66" class="outline-3">
<h3 id="orgb14aa66"><span class="section-number-3">5.48</span> <span class="todo TODO">TODO</span> [bratex] LaTeX 数式のブラケット入力をサポート</h3>
<div class="outline-text-3" id="text-5-48">
<ul class="org-ul">
<li><a href="https://github.com/sbrisard/bratex">sbrisard/bratex: Emacs package for manipulation of brackets in LaTeX mode</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(bratex-config)
       <span style="color: #8b2252;">"bratex"</span> nil t)
  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (add-hook 'yatex-mode-hook #'bratex-config)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org70bc6ef" class="outline-2">
<h2 id="org70bc6ef"><span class="section-number-2">6</span> 表示サポート</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org046ddbf" class="outline-3">
<h3 id="org046ddbf"><span class="section-number-3">6.1</span> モードラインのモード名を短くする</h3>
<div class="outline-text-3" id="text-6-1">
<p>
以前は自作したパッケージを使っていましたが，不具合も多く，調べると <code>diminish.el</code> という素晴らしいパッケージがあったので移行しました．これはマイナーモードの短縮表示なので，メジャーモードは個別にフックで <code>mode-name</code> を書き換えて対応します． <code>use-package.el</code> を使っていると依存関係から自動的にインストールされます．<br />
</p>

<p>
<code>diminish.el</code> を使えば，短縮名に書き換えることも，存在自体を消してしまうこともできます．helm だけ行儀が悪いので，後段での設定時に diminish を呼ぶようにしています．代替パッケージに，<a href="https://github.com/Malabarba/rich-minority">rich-minority-mode</a>があります．<br />
</p>

<p>
メジャーモードの短縮表示は <code>diminish</code> に頼らず，単純に各モードの <code>hook</code> で対処します．<br />
</p>

<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">diminish</span> nil t)
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"diminish"</span>))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"ggtags"</span> (diminish 'ggtags-mode <span style="color: #8b2252;">" G"</span>))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span> (diminish 'orgstruct-mode <span style="color: #8b2252;">" OrgS"</span>))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"centered-cursor-mode"</span>
      (diminish 'centered-cursor-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"volatile-highlights"</span>
      (diminish 'volatile-highlights-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"aggressive-indent"</span>
      (diminish 'aggressive-indent-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"all-the-icons-dired"</span>
      (diminish 'all-the-icons-dired-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"yasnippet"</span> (diminish 'yas-minor-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"auto-complete"</span> (diminish 'auto-complete-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"ws-butler"</span> (diminish 'ws-butler-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"isearch"</span> (diminish 'isearch-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"autorevert"</span> (diminish 'auto-revert-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"smooth-scroll"</span> (diminish 'smooth-scroll-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"whitespace"</span> (diminish 'global-whitespace-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"emmet-mode"</span> (diminish 'emmet-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"abbrev"</span> (diminish 'abbrev-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"doxymacs"</span> (diminish 'doxymacs-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"editorconfig"</span> (diminish 'editorconfig-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"rainbow-mode"</span> (diminish 'rainbow-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"guide-key"</span> (diminish 'guide-key-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"highlight-symbol"</span> (diminish 'highlight-symbol-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"which-key"</span> (diminish 'which-key-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"fancy-narrow"</span> (diminish 'fancy-narrow-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"smartparens"</span> (diminish 'smartparens-mode))
    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"selected"</span> (diminish 'selected-minor-mode))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(with-eval-after-load "org-autolist" (diminish 'org-autolist-mode))</span>
   <span style="color: #b22222;">;;;  </span><span style="color: #b22222;">(with-eval-after-load "helm" (diminish 'helm-mode " H"))</span>
    ))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12513;&#12472;&#12515;&#12540;&#12514;&#12540;&#12489;&#12398;&#30701;&#32302;</span>
(add-hook 'c-mode-hook #'(lambda () (<span style="color: #a020f0;">setq</span> mode-name <span style="color: #8b2252;">"C"</span>)))
(add-hook 'js2-mode-hook #'(lambda () (<span style="color: #a020f0;">setq</span> mode-name <span style="color: #8b2252;">"JS"</span>)))
(add-hook 'c++-mode-hook #'(lambda () (<span style="color: #a020f0;">setq</span> mode-name <span style="color: #8b2252;">"C++"</span>)))
(add-hook 'csharp-mode-hook #'(lambda () (<span style="color: #a020f0;">setq</span> mode-name <span style="color: #8b2252;">"C#"</span>)))
(add-hook 'prog-mode-hook #'(lambda () (<span style="color: #a020f0;">setq</span> mode-name <span style="color: #8b2252;">"Pr"</span>)))
(add-hook 'emacs-lisp-mode-hook #'(lambda () (<span style="color: #a020f0;">setq</span> mode-name <span style="color: #8b2252;">"El"</span>)))
(add-hook 'python-mode-hook #'(lambda () (<span style="color: #a020f0;">setq</span> mode-name <span style="color: #8b2252;">"Py"</span>)))
(add-hook 'perl-mode-hook #'(lambda () (<span style="color: #a020f0;">setq</span> mode-name <span style="color: #8b2252;">"Pl"</span>)))
(add-hook 'web-mode-hook #'(lambda () (<span style="color: #a020f0;">setq</span> mode-name <span style="color: #8b2252;">"W"</span>)))
(add-hook 'change-log-mode-hook #'(lambda () (<span style="color: #a020f0;">setq</span> mode-name <span style="color: #8b2252;">"ChangeLog"</span>)))
(add-hook 'lisp-interaction-mode-hook #'(lambda () (<span style="color: #a020f0;">setq</span> mode-name <span style="color: #8b2252;">"Lisp"</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org8b96965" class="outline-3">
<h3 id="org8b96965"><span class="section-number-3">6.2</span> 続・モードラインのモード名を短縮する</h3>
<div class="outline-text-3" id="text-6-2">
<ul class="org-ul">
<li><a href="https://elpa.gnu.org/packages/delight.html">GNU ELPA - delight</a><br />
<ul class="org-ul">
<li>ELPAに登録されている，diminish.el 代替パッケージ<br /></li>
</ul></li>
<li>マイナーモードとメジャーモードを同じ形式で記述できて，スッキリします．<br /></li>
</ul>


<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">delight</span> nil t)
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"delight"</span>))
    (delight
     '(<span style="color: #b22222;">;; </span><span style="color: #b22222;">Major modes</span>
       (c-mode <span style="color: #8b2252;">"C"</span> <span style="color: #483d8b;">:major</span>)
       (c++mode <span style="color: #8b2252;">"C++"</span> <span style="color: #483d8b;">:major</span>)
       (js2-mode <span style="color: #8b2252;">"JS"</span> <span style="color: #483d8b;">:major</span>)
       (<span style="color: #a020f0;">csharp-mode</span> <span style="color: #8b2252;">"C#"</span> <span style="color: #483d8b;">:major</span>)
       (prog-mode <span style="color: #8b2252;">"Pr"</span> <span style="color: #483d8b;">:major</span>)
       (emacs-lisp-mode <span style="color: #8b2252;">"El"</span> <span style="color: #483d8b;">:major</span>)
       (python-mode <span style="color: #8b2252;">"Py"</span> <span style="color: #483d8b;">:major</span>)
       (perl-mode <span style="color: #8b2252;">"Pl"</span> <span style="color: #483d8b;">:major</span>)
       (web-mode <span style="color: #8b2252;">"W"</span> <span style="color: #483d8b;">:major</span>)
       (change-log-mode <span style="color: #8b2252;">"ChangeLog"</span> <span style="color: #483d8b;">:major</span>)
       (lisp-interaction-mode <span style="color: #8b2252;">"Lisp"</span> <span style="color: #483d8b;">:major</span>)

       <span style="color: #b22222;">;; </span><span style="color: #b22222;">Shorten for minor modes</span>
       (ggtags-mode <span style="color: #8b2252;">" G"</span> <span style="color: #8b2252;">"ggtags"</span>)
       <span style="color: #b22222;">;; </span><span style="color: #b22222;">(orgstruct-mode " OrgS" "org")</span>
       (orgalist-mode <span style="color: #8b2252;">" ol"</span> <span style="color: #8b2252;">"orgalist"</span>)

       <span style="color: #b22222;">;; </span><span style="color: #b22222;">No display for minor modes</span>
       (org-fancy-priorities-mode nil <span style="color: #8b2252;">"org-fancy-priorities"</span>)
       (smooth-scroll-mode nil <span style="color: #8b2252;">"smooth-scroll"</span>)
       (eldoc-mode nil <span style="color: #8b2252;">"eldoc"</span>)
       (centered-cursor-mode nil <span style="color: #8b2252;">"centered-cursor-mode"</span>)
       (volatile-highlights-mode nil <span style="color: #8b2252;">"volatile-highlights"</span>)
       (aggressive-indent-mode nil <span style="color: #8b2252;">"aggressive-indent"</span>)
       (all-the-icons-dired-mode nil <span style="color: #8b2252;">"all-the-icons-dired"</span>)
       (yas-minor-mode nil <span style="color: #8b2252;">"yasnippet"</span>)
       (auto-complete-mode nil <span style="color: #8b2252;">"auto-complete"</span>)
       (ws-butler-mode nil <span style="color: #8b2252;">"ws-butler"</span>)
       (isearch-mode nil <span style="color: #8b2252;">"isearch"</span>)
       (auto-revert-mode nil <span style="color: #8b2252;">"autorevert"</span>)
       (global-whitespace-mode nil <span style="color: #8b2252;">"whitespace"</span>)
       (emmet-mode nil <span style="color: #8b2252;">"emmet-mode"</span>)
       (helm-mode nil <span style="color: #8b2252;">"helm-mode"</span>)
       (abbrev-mode nil <span style="color: #8b2252;">"abbrev"</span>)
       (doxymacs-mode nil <span style="color: #8b2252;">"doxymacs"</span>)
       (editorconfig-mode nil <span style="color: #8b2252;">"editorconfig"</span>)
       (rainbow-mode nil <span style="color: #8b2252;">"rainbow-mode"</span>)
       (highlight-symbol-mode nil <span style="color: #8b2252;">"highlight-symbol"</span>)
       (which-key-mode nil <span style="color: #8b2252;">"which-key"</span>)
       (fancy-narrow-mode nil <span style="color: #8b2252;">"fancy-narrow"</span>)
       (smartparens-mode nil <span style="color: #8b2252;">"smartparens"</span>)
       (selected-minor-mode nil <span style="color: #8b2252;">"selected"</span>)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf00da0e" class="outline-3">
<h3 id="orgf00da0e"><span class="section-number-3">6.3</span> モードラインのNarrowを短くする</h3>
<div class="outline-text-3" id="text-6-3">
<p>
標準では「Narrow」と表示されますが，「N」に短縮します．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  (<span style="color: #a020f0;">setq</span> mode-line-modes
        (mapcar
         (<span style="color: #a020f0;">lambda</span> (entry)
           (<span style="color: #a020f0;">if</span> (<span style="color: #a020f0;">and</span> (stringp entry)
                    (string= entry <span style="color: #8b2252;">"%n"</span>))
               '(<span style="color: #483d8b;">:eval</span> (<span style="color: #a020f0;">if</span> (<span style="color: #a020f0;">and</span> (= 1 (point-min))
                                (= (1+ (buffer-size)) (point-max))) <span style="color: #8b2252;">""</span>
                         <span style="color: #8b2252;">" N"</span>)) <span style="color: #ff0000; font-weight: bold;">entry))</span>
         mode-line-modes)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org2f03356" class="outline-3">
<h3 id="org2f03356"><span class="section-number-3">6.4</span> モードラインの節約（VC-mode編）</h3>
<div class="outline-text-3" id="text-6-4">
<p>
定形で表示されている <code>Git</code> を消します．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"vc-hooks"</span>
  (setcdr (assq 'vc-mode mode-line-format)
          '((<span style="color: #483d8b;">:eval</span> (replace-regexp-in-string <span style="color: #8b2252;">"^ Git"</span> <span style="color: #8b2252;">" "</span> vc-mode)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgccf4699" class="outline-3">
<h3 id="orgccf4699"><span class="section-number-3">6.5</span> モードラインの色をカスタマイズする</h3>
<div class="outline-text-3" id="text-6-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-face-attribute 'mode-line nil <span style="color: #483d8b;">:overline</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #203e6f;">#203e6f</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:box</span> nil)
(set-face-foreground 'mode-line <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #203e6f;">#203e6f</span><span style="color: #8b2252;">"</span>)
(set-face-background 'mode-line <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #b2cefb;">#b2cefb</span><span style="color: #8b2252;">"</span>)

(set-face-attribute 'mode-line-inactive nil <span style="color: #483d8b;">:overline</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #94bbf9;">#94bbf9</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:box</span> nil)
(set-face-foreground 'mode-line-inactive  <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #94bbf9;">#94bbf9</span><span style="color: #8b2252;">"</span>)
(set-face-background 'mode-line-inactive <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #d8e6fd;">#d8e6fd</span><span style="color: #8b2252;">"</span>)
</pre>
</div>
</div>

<div id="outline-container-org4ae6d73" class="outline-4">
<h4 id="org4ae6d73"><span class="section-number-4">6.5.1</span> 色セット例</h4>
<div class="outline-text-4" id="text-6-5-1">
<ul class="org-ul">
<li>青／白<br /></li>
</ul>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">background</td>
<td class="org-left">foreground</td>
<td class="org-left">overline</td>
</tr>

<tr>
<td class="org-left">active</td>
<td class="org-left">558BE2</td>
<td class="org-left">FFFFFF</td>
<td class="org-left">566f99</td>
</tr>

<tr>
<td class="org-left">inactive</td>
<td class="org-left">94bbf9</td>
<td class="org-left">EFEFEF</td>
<td class="org-left">a4bfea</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>青<br /></li>
</ul>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">background</td>
<td class="org-left">foreground</td>
<td class="org-left">overline</td>
</tr>

<tr>
<td class="org-left">active</td>
<td class="org-left">b2cefb</td>
<td class="org-left">203e6f</td>
<td class="org-left">203e6f</td>
</tr>

<tr>
<td class="org-left">inactive</td>
<td class="org-left">94bbf9</td>
<td class="org-left">94bbf9</td>
<td class="org-left">94bbf9</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>緑<br /></li>
</ul>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">background</td>
<td class="org-left">foreground</td>
<td class="org-left">overline</td>
</tr>

<tr>
<td class="org-left">active</td>
<td class="org-left">b1fbd6</td>
<td class="org-left">206f47</td>
<td class="org-left">206f47</td>
</tr>

<tr>
<td class="org-left">inactive</td>
<td class="org-left">95f9c7</td>
<td class="org-left">95f9c7</td>
<td class="org-left">95f9c7</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-orge185df5" class="outline-3">
<h3 id="orge185df5"><span class="section-number-3">6.6</span> 行番号の表示制限を拡張する</h3>
<div class="outline-text-3" id="text-6-6">
<p>
デフォルトだと200桁までしか把握しないので，いつも表示されるように拡張する．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> line-number-display-limit-width 100000)
</pre>
</div>
</div>
</div>

<div id="outline-container-org31fade7" class="outline-3">
<h3 id="org31fade7"><span class="section-number-3">6.7</span> visible-bell のカスタマイズ</h3>
<div class="outline-text-3" id="text-6-7">
<p>
<a href="http://www.emacswiki.org/emacs/MilesBader">http://www.emacswiki.org/emacs/MilesBader</a> を参考にカスタマイズしていました．現在は後継パッケージ（<a href="http://www.emacswiki.org/emacs/echo-bell.el">http://www.emacswiki.org/emacs/echo-bell.el</a>）があり，MELPAから取れます．<br />
</p>

<p>
visibl-bell を使うと，操作ミスで発生するビープ音を，視覚的な表示に入れ替えられます．ただ，デフォルトではバッファ中央に黒い四角が表示されて少々鬱陶しいので，ミニバッファの点滅に変更します．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(echo-area-bell)
       <span style="color: #8b2252;">"echo-area-bell"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"echo-area-bell"</span>
    (<span style="color: #a020f0;">setq</span> visible-bell t)
    (<span style="color: #a020f0;">setq</span> ring-bell-function 'echo-area-bell)))


<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12497;&#12483;&#12465;&#12540;&#12472;&#65288;echo-bell&#65289;&#12398;&#22580;&#21512;</span>
(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">echo-bell</span> nil t)
  (echo-bell-mode 1)
  (<span style="color: #a020f0;">setq</span> echo-bell-string <span style="color: #8b2252;">""</span>)
  (<span style="color: #a020f0;">setq</span> echo-bell-background <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFDCDC;">#FFDCDC</span><span style="color: #8b2252;">"</span>)
  (<span style="color: #a020f0;">setq</span> echo-bell-delay 0.1))
</pre>
</div>

<p>
ビープ音も無しかつ視覚効果も無くすには，次のようにします．<br />
</p>

<p>
see <a href="http://yohshiy.blog.fc2.com/blog-entry-171.html">http://yohshiy.blog.fc2.com/blog-entry-171.html</a><br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;  </span><span style="color: #b22222;">(setq visible-bell nil) ;; default=nil</span>
(<span style="color: #a020f0;">setq</span> ring-bell-function 'ignore)
</pre>
</div>
</div>
</div>

<div id="outline-container-org348285d" class="outline-3">
<h3 id="org348285d"><span class="section-number-3">6.8</span> 常に <b>scratch</b> を表示して起動する</h3>
<div class="outline-text-3" id="text-6-8">
<p>
<code>session.el</code> や <code>desktop.el</code> を使っていても，いつも <code>*scratch*</code> バッファを表示する．そうじゃないと安心できない人向け．<br />
</p>

<p>
使われるメジャーモードと表示する文字列も制御できます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Start Emacs with scratch buffer even though it call session.el/desktop.el</span>
(add-hook 'emacs-startup-hook #'(lambda () (switch-to-buffer <span style="color: #8b2252;">"*scratch*"</span>)))
(<span style="color: #a020f0;">setq</span> initial-major-mode 'text-mode)
(<span style="color: #a020f0;">setq</span> initial-scratch-message
      (concat <span style="color: #8b2252;">"                                                              "</span>
              (format-time-string <span style="color: #8b2252;">"%Y-%m-%d (%a.)"</span>) <span style="color: #8b2252;">"\n"</span>
              <span style="color: #8b2252;">"-----------------------------------------------------"</span>
              <span style="color: #8b2252;">"--------------------------\n"</span>))
</pre>
</div>

<p>
最近は，起動用にメジャーモードを書いて対応しています．詳しくはリンク先にて．<br />
</p>

<ul class="org-ul">
<li><a href="http://qiita.com/takaxp/items/12c01bff4c687b3f242b">高速起動用ミニマム*scratch*バッファ - Qiita</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">empty-booting</span> nil t)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq initial-buffer-choice t) ;; &#24341;&#25968;&#20184;&#12365;&#36215;&#21205;&#12377;&#12427;&#12392;&#30011;&#38754;&#20998;&#21106;&#12373;&#12428;&#12427;</span>
  (<span style="color: #a020f0;">setq</span> initial-scratch-message nil)
  (<span style="color: #a020f0;">setq</span> initial-major-mode 'empty-booting-mode)
  <span style="color: #b22222;">;;  </span><span style="color: #b22222;">:underline "</span><span style="color: #ffffff; background-color: #203e6f;">#203e6f</span><span style="color: #b22222;">"</span>
  (set-face-foreground 'header-line <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #8b2252;">"</span>) <span style="color: #b22222;">;; </span><span style="color: #b22222;">"</span><span style="color: #ffffff; background-color: #203e6f;">#203e6f</span><span style="color: #b22222;">" </span><span style="color: #ffffff; background-color: #333333;">#333333</span><span style="color: #b22222;"> "</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #b22222;">"</span>
  (set-face-background 'header-line <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #5F7DB7;">#5F7DB7</span><span style="color: #8b2252;">"</span>) <span style="color: #b22222;">;; </span><span style="color: #b22222;">"</span><span style="color: #000000; background-color: #ffb08c;">#ffb08c</span><span style="color: #b22222;">" "</span><span style="color: #ffffff; background-color: #7e59b5;">#7e59b5</span><span style="color: #b22222;">"</span>
  (set-face-attribute 'header-line nil
                      <span style="color: #483d8b;">:inherit</span> nil
                      <span style="color: #483d8b;">:overline</span> nil
                      <span style="color: #483d8b;">:underline</span> nil)
  (<span style="color: #a020f0;">setq</span> header-line-format
        (concat
         <span style="color: #8b2252;">" GNU Emacs                                                  "</span>
         (format-time-string <span style="color: #8b2252;">"W%W: %Y-%m-%d %a."</span>))))

(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:split-window-below</span> (<span style="color: #228b22;">&amp;optional</span> _size)
    <span style="color: #8b2252;">"An extention to switch to </span><span style="color: #ff0000; font-weight: bold;">\</span><span style="color: #8b2252;">*scratch</span><span style="color: #ff0000; font-weight: bold;">\</span><span style="color: #8b2252;">* buffer after splitting window."</span>
    (my-open-scratch))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(advice-add 'split-window-below :after #'advice:split-window-below)</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-open-scratch</span> ()
    <span style="color: #8b2252;">"Switch the current buffer to </span><span style="color: #ff0000; font-weight: bold;">\</span><span style="color: #8b2252;">*scratch</span><span style="color: #ff0000; font-weight: bold;">\</span><span style="color: #8b2252;">* buffer."</span>
    (<span style="color: #a020f0;">interactive</span>)
    (switch-to-buffer <span style="color: #8b2252;">"*scratch*"</span>))
  (global-set-key (kbd <span style="color: #8b2252;">"C-M-s"</span>) #'my-open-scratch))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcb6d79e" class="outline-3">
<h3 id="orgcb6d79e"><span class="section-number-3">6.9</span> バッテリー情報をモードラインに表示する</h3>
<div class="outline-text-3" id="text-6-9">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Show battery information on the mode line.</span>
(display-battery-mode t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org540188f" class="outline-3">
<h3 id="org540188f"><span class="section-number-3">6.10</span> スクロールバーを非表示にする</h3>
<div class="outline-text-3" id="text-6-10">
<p>
スクロールバーを非表示にするには，nil を指定します．<br />
右側に表示したい場合は，'right とします．<br />
現在は，ソースコードレベルでオフにしています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Show scroll bar or not</span>
(<span style="color: #a020f0;">when</span> (display-graphic-p)
  (set-scroll-bar-mode -1)) <span style="color: #b22222;">; </span><span style="color: #b22222;">'right</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org608d9ce" class="outline-3">
<h3 id="org608d9ce"><span class="section-number-3">6.11</span> [yascroll] フリンジにスクロールバーを出す</h3>
<div class="outline-text-3" id="text-6-11">
<p>
<code>yascroll</code> を使います．<br />
</p>

<ul class="org-ul">
<li><a href="http://d.hatena.ne.jp/m2ym/20110401/1301617991">http://d.hatena.ne.jp/m2ym/20110401/1301617991</a><br /></li>
<li>2015-03-15: smooth-scroll との組み合わせで重いのを確認．<br /></li>
</ul>

<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">yascroll</span> nil t)
    (<span style="color: #a020f0;">setq</span> yascroll:delay-to-hide 2)
    (<span style="color: #a020f0;">setq</span> yascroll:disabled-modes '(org-mode))
    (set-face-foreground 'yascroll:thumb-fringe <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #b2cefb;">#b2cefb</span><span style="color: #8b2252;">"</span>)
    (set-face-background 'yascroll:thumb-fringe <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #b2cefb;">#b2cefb</span><span style="color: #8b2252;">"</span>)
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"yascroll"</span>)
      (global-yascroll-bar-mode 1))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org88e1dcc" class="outline-3">
<h3 id="org88e1dcc"><span class="section-number-3">6.12</span> ツールバーを非表示にする</h3>
<div class="outline-text-3" id="text-6-12">
<p>
ツールバーは使わないので非表示にします．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Disable to show the tool bar.</span>
(<span style="color: #a020f0;">when</span> (display-graphic-p)
  (tool-bar-mode -1))
</pre>
</div>
</div>
</div>

<div id="outline-container-org9ae099e" class="outline-3">
<h3 id="org9ae099e"><span class="section-number-3">6.13</span> 起動時のスプラッシュ画面を表示しない</h3>
<div class="outline-text-3" id="text-6-13">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Disable to show the splash window at startup</span>
(<span style="color: #a020f0;">setq</span> inhibit-startup-screen t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org79d3f1f" class="outline-3">
<h3 id="org79d3f1f"><span class="section-number-3">6.14</span> カーソル行の行数をモードラインに表示する</h3>
<div class="outline-text-3" id="text-6-14">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Show line number in the mode line.</span>
(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">unless</span> batch-build
    (postpone-message <span style="color: #8b2252;">"line-number-mode"</span>)
    (line-number-mode 1)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgad3bb54" class="outline-3">
<h3 id="orgad3bb54"><span class="section-number-3">6.15</span> カーソル行の関数名をモードラインに表示する</h3>
<div class="outline-text-3" id="text-6-15">
<ul class="org-ul">
<li>emacs24.3 で重く感じるので外している．<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Show function name in the mode line.</span>
(which-function-mode t)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd7f93cb" class="outline-3">
<h3 id="orgd7f93cb"><span class="section-number-3">6.16</span> 時刻をモードラインに表示する</h3>
<div class="outline-text-3" id="text-6-16">
<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Show clock in in the mode line</span>
(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">setq</span> display-time-format <span style="color: #8b2252;">"%H%M.%S"</span>) <span style="color: #b22222;">;; </span><span style="color: #b22222;">%y%m%d.</span>
  (<span style="color: #a020f0;">setq</span> display-time-interval 1)
  (<span style="color: #a020f0;">setq</span> display-time-default-load-average nil)
  (<span style="color: #a020f0;">unless</span> batch-build
    (postpone-message <span style="color: #8b2252;">"display-time-mode"</span>)
    (display-time-mode 1)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org6253397" class="outline-3">
<h3 id="org6253397"><span class="section-number-3">6.17</span> 対応するカッコをハイライトする</h3>
<div class="outline-text-3" id="text-6-17">
<p>
Built-in の paren.el が利用できる．拡張版として <a href="http://www.emacswiki.org/emacs/mic-paren.el">mic-paren.el</a> があり，現在はこれを利用している．<br />
</p>

<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">mic-paren</span> nil t)
    (<span style="color: #a020f0;">setq</span> paren-sexp-mode nil)
    (set-face-foreground 'paren-face-match <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #8b2252;">"</span>)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Deep </span><span style="color: #ffffff; background-color: #0000ff;">blue</span><span style="color: #b22222;">: </span><span style="color: #ffffff; background-color: #6666CC;">#6666CC</span><span style="color: #b22222;">, </span><span style="color: #000000; background-color: #ffa500;">orange</span><span style="color: #b22222;">: </span><span style="color: #000000; background-color: #FFCC66;">#FFCC66</span>
    (set-face-background 'paren-face-match <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #66CC66;">#66CC66</span><span style="color: #8b2252;">"</span>)
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"mic-paren"</span>)
      (paren-activate))))
</pre>
</div>

<p>
paren.el の場合は以下の設定．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> show-paren-delay 0)
(show-paren-mode t)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq show-paren-style 'expression) ; &#12459;&#12483;&#12467;&#20869;&#12418;&#24375;&#35519;</span>
<span style="color: #b22222;">;;</span><span style="color: #b22222;">(set-face-background 'show-paren-match-face "</span><span style="color: #000000; background-color: #5DA4ff;">#5DA4ff</span><span style="color: #b22222;">") ; &#12459;&#12540;&#12477;&#12523;&#12424;&#12426;&#28611;&#12356;&#38738;</span>
(set-face-background 'show-paren-match-face <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #a634ff;">#a634ff</span><span style="color: #8b2252;">"</span>)
(set-face-foreground 'show-paren-match-face <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #8b2252;">"</span>)
(set-face-underline-p 'show-paren-match-face nil)
(<span style="color: #a020f0;">setq</span> show-paren-style 'parenthesis)
</pre>
</div>
</div>
</div>

<div id="outline-container-org84f51a2" class="outline-3">
<h3 id="org84f51a2"><span class="section-number-3">6.18</span> 全角スペースと行末タブ／半角スペースを強調表示する</h3>
<div class="outline-text-3" id="text-6-18">
<ul class="org-ul">
<li><a href="http://ubulog.blogspot.jp/2007/09/emacs_09.html">http://ubulog.blogspot.jp/2007/09/emacs_09.html</a><br /></li>
<li><a href="https://beiznotes.org/200906031244034052-2/">emacsでタブとEOFと全角空白の表示を。</a><br /></li>
<li><a href="http://qiita.com/itiut@github/items/4d74da2412a29ef59c3a">whitespace-modeを使って、ファイルの保存時に行末のスペースや末尾の改行を削除する - Qiita</a><br /></li>
</ul>

<p>
英語で原稿を書く時に全角スペースが入っているを苦労するので，強調表示して編集中でも気づくようにします．また，行末のタブや半角スペースも無駄なので，入り込まないように強調しています．パッケージを使うと too much かなという印象があったので，個別の設定だけを使わせてもらっています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12473;&#12506;&#12540;&#12473;</span>
  (<span style="color: #a020f0;">defface</span> <span style="color: #a0522d;">my-face-b-1</span>
    '((t (<span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #bebebe;">gray</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:bold</span> t <span style="color: #483d8b;">:underline</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #ff0000;">red</span><span style="color: #8b2252;">"</span>)))
    nil <span style="color: #483d8b;">:group</span> 'font-lock-highlighting-faces)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12479;&#12502;&#12384;&#12369;&#12398;&#34892;</span>
  (<span style="color: #a020f0;">defface</span> <span style="color: #a0522d;">my-face-b-2</span>
    '((t (<span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #ffa500;">orange</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:bold</span> t <span style="color: #483d8b;">:underline</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #ff0000;">red</span><span style="color: #8b2252;">"</span>)))
    nil <span style="color: #483d8b;">:group</span> 'font-lock-highlighting-faces)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21322;&#35282;&#12473;&#12506;&#12540;&#12473;</span>
  (<span style="color: #a020f0;">defface</span> <span style="color: #a0522d;">my-face-b-3</span> '((t (<span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #ffa500;">orange</span><span style="color: #8b2252;">"</span>)))
    nil <span style="color: #483d8b;">:group</span> 'font-lock-highlighting-faces)

  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-face-b-1</span> 'my-face-b-1)
  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-face-b-2</span> 'my-face-b-2)
  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-face-b-3</span> 'my-face-b-3)
  (<span style="color: #a020f0;">defadvice</span> <span style="color: #0000ff;">font-lock-mode</span> (before my-font-lock-mode ())
    (font-lock-add-keywords
     major-mode
     <span style="color: #b22222;">;; </span><span style="color: #b22222;">"[\t]+$" &#34892;&#26411;&#12398;&#12479;&#12502;</span>
     '((<span style="color: #8b2252;">"</span><span style="color: #8b2252; background-color: #bebebe; font-weight: bold; text-decoration: underline;">&#12288;</span><span style="color: #8b2252;">"</span> 0 my-face-b-1 append)
       (<span style="color: #8b2252;">"[ ]+$"</span> 0 my-face-b-3 append)
       (<span style="color: #8b2252;">"[\t]+$"</span> 0 my-face-b-2 append))))
  (ad-enable-advice 'font-lock-mode 'before 'my-font-lock-mode)
  (ad-activate 'font-lock-mode))

<span style="color: #b22222;">;;</span><span style="color: #b22222;">show EOF</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(defun set-buffer-end-mark()</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(let ((overlay (make-overlay (point-max) (point-max))))</span>
<span style="color: #b22222;">;;     </span><span style="color: #b22222;">(overlay-put overlay 'before-string #("[EOF]" 0 5 (face highlight)))</span>
<span style="color: #b22222;">;;     </span><span style="color: #b22222;">(overlay-put overlay 'insert-behind-hooks</span>
<span style="color: #b22222;">;;                  </span><span style="color: #b22222;">'((lambda (overlay after beg end &amp;optional len)</span>
<span style="color: #b22222;">;;                      </span><span style="color: #b22222;">(when after</span>
<span style="color: #b22222;">;;                        </span><span style="color: #b22222;">(move-overlay overlay (point-max) (point-max))))))))</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-hook 'find-file-hooks 'set-buffer-end-mark)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org73eddf9" class="outline-3">
<h3 id="org73eddf9"><span class="section-number-3">6.19</span> バッファの終わりをフリンジで明示</h3>
<div class="outline-text-3" id="text-6-19">
<p>
以下の設定では，ウィンドウ以下にバッファが続いているかを表す矢印と，続いていないことを示すカギカッコをフリンジに表示します．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq-default</span> indicate-buffer-boundaries
              '((top . nil) (bottom . right) (down . right)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgde8f962" class="outline-3">
<h3 id="orgde8f962"><span class="section-number-3">6.20</span> 行番号をバッファに表示する</h3>
<div class="outline-text-3" id="text-6-20">
<p>
Emacs Version 26.1 からネイティブ実装に切り替わった <code>display-line-numbers.el</code> を使います．普段は使わないので，必要に応じてグローバルにトグルできるようにしてあります．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(my-toggle-display-line-numbers-mode)
       <span style="color: #8b2252;">"display-line-numbers"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"display-line-numbers"</span>
    (custom-set-variables
     '(display-line-numbers-width-start t)))

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-toggle-display-line-numbers-mode</span> ()
    <span style="color: #8b2252;">"Toggle variable `</span><span style="color: #008b8b;">global-display-line-numbers-mode</span><span style="color: #8b2252;">'."</span>
    (<span style="color: #a020f0;">interactive</span>)
    (<span style="color: #a020f0;">if</span> (fboundp 'global-display-line-numbers-mode) <span style="color: #b22222;">;; </span><span style="color: #b22222;">26.1 or later</span>
        (<span style="color: #a020f0;">let</span> ((flag (<span style="color: #a020f0;">if</span> global-display-line-numbers-mode -1 1)))
          (global-display-line-numbers-mode flag))
      (<span style="color: #ff0000; font-weight: bold;">user-error</span> <span style="color: #8b2252;">"The display-line-numbers is supported in 26.1 or later"</span>))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga44b979" class="outline-3">
<h3 id="orga44b979"><span class="section-number-3">6.21</span> [migemo.el] ローマ字入力で日本語を検索する</h3>
<div class="outline-text-3" id="text-6-21">
<p>
<a href="http://0xcc.net/migemo/#download">http://0xcc.net/migemo/#download</a><br />
</p>

<p>
以下は，<a href="http://www.kaoriya.net/software/cmigemo">cmigemo</a> を使う設定です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">if</span> (executable-find <span style="color: #8b2252;">"cmigemo"</span>)
    (<span style="color: #a020f0;">when</span> (autoload-if-found
           '(migemo-init)
           <span style="color: #8b2252;">"migemo"</span> nil t)

      (add-hook 'isearch-mode-hook #'migemo-init)

      (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"migemo"</span>
        (custom-set-variables
         '(completion-ignore-case t) <span style="color: #b22222;">;; </span><span style="color: #b22222;">case-independent</span>
         '(migemo-command <span style="color: #8b2252;">"cmigemo"</span>)
         '(migemo-options '(<span style="color: #8b2252;">"-q"</span> <span style="color: #8b2252;">"--emacs"</span> <span style="color: #8b2252;">"-i"</span> <span style="color: #8b2252;">"\a"</span>))
         '(migemo-dictionary <span style="color: #8b2252;">"/usr/local/share/migemo/utf-8/migemo-dict"</span>)
         '(migemo-user-dictionary nil)
         '(migemo-regex-dictionary nil)
         '(migemo-use-pattern-alist t)
         '(migemo-use-frequent-pattern-alist t)
         '(migemo-pattern-alist-length 1024)
         '(migemo-coding-system 'utf-8-unix))))
  (message <span style="color: #8b2252;">"--- cmigemo is NOT installed."</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgab26950" class="outline-3">
<h3 id="orgab26950"><span class="section-number-3">6.22</span> [anything.el] 何でも絞り込みインターフェイス（旧）</h3>
<div class="outline-text-3" id="text-6-22">
<ul class="org-ul">
<li>helm に移行しました．<br /></li>
</ul>

<p>
<a href="http://svn.coderepos.org/share/lang/elisp/anything-c-moccur/trunk/anything-c-moccur.el">http://svn.coderepos.org/share/lang/elisp/anything-c-moccur/trunk/anything-c-moccur.el</a><br />
<a href="http://d.hatena.ne.jp/IMAKADO/20080724/1216882563">http://d.hatena.ne.jp/IMAKADO/20080724/1216882563</a><br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(anything-other-buffer
         anything-complete anything-M-x
         anything-c-moccur-occur-by-moccur)
       <span style="color: #8b2252;">"anything-startup"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"anything-startup"</span>
    (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">anything-c-moccur</span> nil t)
    <span style="color: #b22222;">;;  </span><span style="color: #b22222;">(setq moccur-split-word t)</span>
    <span style="color: #b22222;">;;  </span><span style="color: #b22222;">(setq anything-c-locate-options `("locate" "-w"))</span>

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x install-elisp-from-emacswiki recentf-ext.el</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">http://www.emacswiki.org/cgi-bin/wiki/download/recentf-ext.el</span>
    <span style="color: #b22222;">;;  </span><span style="color: #b22222;">(autoload-if-found 'recentf-ext "recentf-ext" nil t)</span>
    <span style="color: #b22222;">;;              </span><span style="color: #b22222;">(require 'recentf-ext nil t)</span>

    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">migemo</span> nil t)
      (<span style="color: #a020f0;">setq</span> moccur-use-migemo t))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x anything-grep-by-name</span>
    (<span style="color: #a020f0;">setq</span> anything-grep-alist
          '((<span style="color: #8b2252;">"Org-files"</span> (<span style="color: #8b2252;">"egrep -Hin %s *.org"</span> <span style="color: #8b2252;">"~/Dropbox/org/"</span>))
            (<span style="color: #8b2252;">".emacs.d"</span> (<span style="color: #8b2252;">"egrep -Hin %s *.el"</span> <span style="color: #8b2252;">"~/.emacs.d/"</span>))
            (<span style="color: #8b2252;">"ChangeLog"</span> (<span style="color: #8b2252;">"egrep -Hin %s ChangeLog"</span> <span style="color: #8b2252;">"~/"</span>))))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">("Spotlight" ("mdfind %s -onlyin ~/Dropbox/Documents/Library/" ""))))</span>

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-anything</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (anything-other-buffer
       '(anything-c-source-recentf
         anything-c-source-file-name-history
         anything-c-source-buffers
         anything-c-source-emacs-commands
         anything-c-source-locate)
       <span style="color: #8b2252;">" *my-anything*"</span>))

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-anything-buffer</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (anything-other-buffer
       '(anything-c-source-buffers)
       <span style="color: #8b2252;">" *my-anthing-buffer*"</span>))

    (<span style="color: #a020f0;">when</span> (memq window-system '(mac ns))
      (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-anything-spotlight</span> ()
        <span style="color: #8b2252;">"Spotlight search with anything.el"</span>
        (<span style="color: #a020f0;">interactive</span>)
        (anything-other-buffer
         '(anything-c-source-mac-spotlight)
         <span style="color: #8b2252;">" *anything-spotlight*"</span>)))

    (<span style="color: #a020f0;">setq</span> anything-candidate-number-limit 50) <span style="color: #b22222;">; </span><span style="color: #b22222;">50</span>
    (<span style="color: #a020f0;">setq</span> anything-input-idle-delay 0.1)      <span style="color: #b22222;">; </span><span style="color: #b22222;">0.1</span>
    (<span style="color: #a020f0;">setq</span> anything-idle-delay 0.5)            <span style="color: #b22222;">; </span><span style="color: #b22222;">0.5</span>
    (<span style="color: #a020f0;">setq</span> anything-quick-update nil))        <span style="color: #b22222;">; </span><span style="color: #b22222;">nil</span>

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Show ibuffer powered by anything</span>
  <span style="color: #b22222;">;;  </span><span style="color: #b22222;">(with-eval-after-load "anything-startup"</span>
  (global-set-key (kbd <span style="color: #8b2252;">"M-x"</span>) 'anything-M-x)
  (global-set-key (kbd <span style="color: #8b2252;">"C-c o"</span>) 'anything-c-moccur-occur-by-moccur)
  (global-set-key (kbd <span style="color: #8b2252;">"C-M-r"</span>) 'my-anything)
  (global-set-key (kbd <span style="color: #8b2252;">"C-M-s"</span>) 'my-anything-spotlight)
  (global-set-key (kbd <span style="color: #8b2252;">"C-x C-b"</span>) 'my-anything-buffer))
</pre>
</div>
</div>
</div>

<div id="outline-container-org1c6baae" class="outline-3">
<h3 id="org1c6baae"><span class="section-number-3">6.23</span> [helm.el] 続・何でも絞り込みインターフェイス</h3>
<div class="outline-text-3" id="text-6-23">
<p>
<code>M-s</code> を <code>helm-swoop</code> にあてていましたが， <code>M-s</code> を入り口にたくさんの検索系コマンドが割り振られているため <code>M-s M-s</code> に変えました．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(helm-google)
       <span style="color: #8b2252;">"helm-google"</span> nil t)
  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"helm-google"</span>
    (custom-set-variables
     '(helm-google-tld <span style="color: #8b2252;">"co.jp"</span>))))

(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(helm-buffers-list)
       <span style="color: #8b2252;">"helm"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-x C-b"</span>) 'helm-buffers-list))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"helm"</span>
    (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">helm-config</span> nil t)))

(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(helm-M-x
         helm-locate helm-recentf helm-descbinds
         helm-occur helm-swoop helm-flycheck helm-bookmarks)
       <span style="color: #8b2252;">"helm-config"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(defun my-helm-swoop ()</span>
    <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(interactive)</span>
    <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(when (and (fboundp 'dimmer-mode)</span>
    <span style="color: #b22222;">;;              </span><span style="color: #b22222;">(eq dimmer-mode t))</span>
    <span style="color: #b22222;">;;     </span><span style="color: #b22222;">(setq dimmer-mode -1))</span>
    <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(helm-swoop))</span>

    (global-set-key (kbd <span style="color: #8b2252;">"M-x"</span>) 'helm-M-x)
    (global-set-key (kbd <span style="color: #8b2252;">"C-M-r"</span>) 'helm-recentf)
    (global-set-key (kbd <span style="color: #8b2252;">"C-M-l"</span>) 'helm-locate)
    (global-set-key (kbd <span style="color: #8b2252;">"C-c f b"</span>) 'helm-bookmarks)
    (global-set-key (kbd <span style="color: #8b2252;">"M-s M-s"</span>) 'helm-swoop)
    (global-set-key (kbd <span style="color: #8b2252;">"C-c o"</span>) 'helm-occur)
    (global-set-key (kbd <span style="color: #8b2252;">"C-h d"</span>) 'helm-descbinds))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"helm-config"</span>
    (helm-mode 1)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(when (require 'diminish nil t)</span>
    <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(diminish 'helm-mode)) ;; " H"</span>

    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">helm-swoop</span> nil t)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12459;&#12540;&#12477;&#12523;&#12398;&#21336;&#35486;&#12364; org &#12398;&#35211;&#20986;&#12375;&#65288;*&#12398;&#38598;&#12414;&#12426;&#65289;&#12394;&#12425;&#26908;&#32034;&#23550;&#35937;&#12395;&#12375;&#12394;&#12356;&#65294;</span>
      (<span style="color: #a020f0;">setq</span> helm-swoop-pre-input-function
            #'(lambda()
                (<span style="color: #a020f0;">unless</span> (thing-at-point-looking-at <span style="color: #8b2252;">"^\\*+"</span>)
                  (thing-at-point 'symbol))))
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#37197;&#33394;&#35373;&#23450;</span>
      (set-face-attribute
       'helm-swoop-target-line-face nil <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFEDDC;">#FFEDDC</span><span style="color: #8b2252;">"</span>)
      (set-face-attribute
       'helm-swoop-target-word-face nil <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #FF5443;">#FF5443</span><span style="color: #8b2252;">"</span>))

    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">helm-files</span> nil t)
      (define-key helm-find-files-map
        (kbd <span style="color: #8b2252;">"&lt;tab&gt;"</span>) 'helm-execute-persistent-action)
      (define-key helm-read-file-map
        (kbd <span style="color: #8b2252;">"&lt;tab&gt;"</span>) 'helm-execute-persistent-action))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(require 'recentf-ext nil t)</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">helm-find-files &#12434;&#21628;&#12400;&#12379;&#12394;&#12356;</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-to-list 'helm-completing-read-handlers-alist '(find-file . nil))</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">helm-mode-ag &#12434;&#21628;&#12400;&#12379;&#12394;&#12356;</span>
    (add-to-list 'helm-completing-read-handlers-alist '(ag . nil))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">helm-mode-org-set-tags &#12434;&#21628;&#12400;&#12379;&#12394;&#12356;</span>
    (add-to-list 'helm-completing-read-handlers-alist
                 '(org-set-tags . nil))
    (<span style="color: #a020f0;">setq</span> helm-display-source-at-screen-top nil)
    <span style="color: #b22222;">;;         </span><span style="color: #b22222;">(setq helm-display-header-line nil)</span>

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">helm-autoresize-mode &#12434;&#26377;&#21177;&#12395;&#12375;&#12388;&#12388; 30% &#12395;&#22266;&#23450;</span>
    (helm-autoresize-mode 1)
    (<span style="color: #a020f0;">setq</span> helm-autoresize-max-height 30)
    (<span style="color: #a020f0;">setq</span> helm-autoresize-min-height 30)
    (set-face-attribute 'helm-source-header nil
                        <span style="color: #483d8b;">:height</span> 1.0 <span style="color: #483d8b;">:family</span> <span style="color: #8b2252;">"Verdana"</span> <span style="color: #483d8b;">:weight</span> 'normal
                        <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #666666;">#666666</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #DADADA;">#DADADA</span><span style="color: #8b2252;">"</span>)
    (<span style="color: #a020f0;">when</span> (memq window-system '(mac ns))
      (<span style="color: #a020f0;">setq</span> helm-locate-command <span style="color: #8b2252;">"mdfind -name %s %s"</span>))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(require 'helm-css-scss nil t)</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(require 'helm-emmet nil t)</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(require 'helm-descbinds nil t)</span>

    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">helm-projectile</span> nil t)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x helm-projectile-find-file (C-c p f)</span>
      (<span style="color: #a020f0;">setq</span> projectile-completion-system 'helm)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">projectile.el &#12398;&#12461;&#12540;&#12496;&#12452;&#12531;&#12489;&#12434;&#12458;&#12540;&#12496;&#12540;&#12521;&#12452;&#12489;</span>
      (helm-projectile-toggle 1))

    (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">helm-bm</span> nil t)))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12371;&#12398;&#20462;&#27491;&#12364;&#24517;&#35201;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(when (require 'helm-migemo nil t)</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(defun helm-compile-source--candidates-in-buffer (source)</span>
<span style="color: #b22222;">;;     </span><span style="color: #b22222;">(helm-aif (assoc 'candidates-in-buffer source)</span>
<span style="color: #b22222;">;;         </span><span style="color: #b22222;">(append source</span>
<span style="color: #b22222;">;;                 </span><span style="color: #b22222;">`((candidates</span>
<span style="color: #b22222;">;;                    </span><span style="color: #b22222;">. ,(or (cdr it)</span>
<span style="color: #b22222;">;;                           </span><span style="color: #b22222;">(lambda ()</span>
<span style="color: #b22222;">;;                             </span><span style="color: #b22222;">;; Do not use `</span><span style="color: #008b8b;">source</span><span style="color: #b22222;">' because other plugins</span>
<span style="color: #b22222;">;;                             </span><span style="color: #b22222;">;; (such as helm-migemo) may change it</span>
<span style="color: #b22222;">;;                             </span><span style="color: #b22222;">(helm-candidates-in-buffer</span>
<span style="color: #b22222;">;;                              </span><span style="color: #b22222;">(helm-get-current-source)))))</span>
<span style="color: #b22222;">;;                   </span><span style="color: #b22222;">(volatile) (match identity)))</span>
<span style="color: #b22222;">;;       </span><span style="color: #b22222;">source)))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcdfcc64" class="outline-3">
<h3 id="orgcdfcc64"><span class="section-number-3">6.24</span> [stripe-buffer.el] テーブルの色をストライプにする</h3>
<div class="outline-text-3" id="text-6-24">
<p>
<a href="https://github.com/sabof/stripe-buffer/blob/master/stripe-buffer.el">stripe-buffer.el</a>を使います．重くツリーが多いOrgバッファだと激重になる可能性があります．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(turn-on-stripe-table-mode)
       <span style="color: #8b2252;">"stripe-buffer"</span> nil t)

  (add-hook 'org-mode-hook #'turn-on-stripe-table-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org8da000e" class="outline-3">
<h3 id="org8da000e"><span class="section-number-3">6.25</span> [rainbow-delimiters] 対応するカッコに色を付ける</h3>
<div class="outline-text-3" id="text-6-25">
<p>
複数のカッコが重なる言語では，カッコの対応関係がひと目で理解し難い場合があります． <code>rainbow-delimiters</code> を使うと，対応するカッコを七色に色付けして見やすくできます．デフォルトだと色がパステル調で薄いので，パラメータを追加して調整します．<br />
</p>

<p>
<code>org-block</code> 内でうまく動かないようなので，本格導入は様子見中です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"rainbow-delimiters"</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">https://yoo2080.wordpress.com/2013/12/21/small-rainbow-delimiters-tutorial/</span>
  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">cl-lib</span>)
  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">color</span>)
  (<span style="color: #a020f0;">cl-loop</span>
   for index from 1 to rainbow-delimiters-max-face-count
   do
   (<span style="color: #a020f0;">let</span> ((face (intern (format <span style="color: #8b2252;">"rainbow-delimiters-depth-%d-face"</span> index))))
     (<span style="color: #a020f0;">cl-callf</span> color-saturate-name (face-foreground face) 50))))

(add-hook 'prog-mode-hook
          #'(lambda ()
              (<span style="color: #a020f0;">unless</span> (equal (buffer-name) <span style="color: #8b2252;">"*scratch*"</span>)
                (rainbow-delimiters-mode))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org32a5448" class="outline-3">
<h3 id="org32a5448"><span class="section-number-3">6.26</span> [git-gutter-fringe] 編集差分をフレーム端で視覚化</h3>
<div class="outline-text-3" id="text-6-26">
<p>
編集差分の視覚化は元々 git-gutter が提供している機能です．有効にするとフレームの幅が若干広がってしまうので，気になる人は git-gutter-fringe を使えばよいです．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(git-gutter-mode)
       <span style="color: #8b2252;">"git-gutter-fringe"</span> nil t)

  (<span style="color: #a020f0;">dolist</span> (hook
           '(emacs-lisp-mode-hook
             lisp-mode-hook perl-mode-hook python-mode-hook
             c-mode-common-hook nxml-mode-hook web-mode-hook))
    (add-hook hook #'git-gutter-mode))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"git-gutter-fringe"</span>
    (<span style="color: #a020f0;">setq</span> git-gutter:lighter <span style="color: #8b2252;">""</span>)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">"!"</span>
    (fringe-helper-define 'git-gutter-fr:modified nil
                          <span style="color: #8b2252;">"...XX..."</span>
                          <span style="color: #8b2252;">"...XX..."</span>
                          <span style="color: #8b2252;">"...XX..."</span>
                          <span style="color: #8b2252;">"...XX..."</span>
                          <span style="color: #8b2252;">"...XX..."</span>
                          <span style="color: #8b2252;">"........"</span>
                          <span style="color: #8b2252;">"...XX..."</span>
                          <span style="color: #8b2252;">"...XX..."</span>)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">"+"</span>
    (fringe-helper-define 'git-gutter-fr:added nil
                          <span style="color: #8b2252;">"........"</span>
                          <span style="color: #8b2252;">"...XX..."</span>
                          <span style="color: #8b2252;">"...XX..."</span>
                          <span style="color: #8b2252;">".XXXXXX."</span>
                          <span style="color: #8b2252;">".XXXXXX."</span>
                          <span style="color: #8b2252;">"...XX..."</span>
                          <span style="color: #8b2252;">"...XX..."</span>
                          <span style="color: #8b2252;">"........"</span>)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">"-"</span>
    (fringe-helper-define 'git-gutter-fr:deleted nil
                          <span style="color: #8b2252;">"........"</span>
                          <span style="color: #8b2252;">"........"</span>
                          <span style="color: #8b2252;">"........"</span>
                          <span style="color: #8b2252;">".XXXXXX."</span>
                          <span style="color: #8b2252;">".XXXXXX."</span>
                          <span style="color: #8b2252;">"........"</span>
                          <span style="color: #8b2252;">"........"</span>
                          <span style="color: #8b2252;">"........"</span>)
    (<span style="color: #a020f0;">setq</span> git-gutter-fr:side 'left-fringe)
    (set-face-foreground 'git-gutter-fr:added    <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #FF2600;">#FF2600</span><span style="color: #8b2252;">"</span>)
    (set-face-foreground 'git-gutter-fr:modified <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #ffa500;">orange</span><span style="color: #8b2252;">"</span>)
    (set-face-foreground 'git-gutter-fr:deleted  <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #3cb371;">medium sea green</span><span style="color: #8b2252;">"</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgefca6e0" class="outline-3">
<h3 id="orgefca6e0"><span class="section-number-3">6.27</span> [zlc.el] find-file バッファを zsh ライクにする</h3>
<div class="outline-text-3" id="text-6-27">
<p>
ファイル選択を zsh ライクに変更できます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">zlc</span> nil t)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">http://d.hatena.ne.jp/mooz/20101003/p1</span>
  (zlc-mode 1)
  (set-face-attribute 'zlc-selected-completion-face nil
                      <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #000000;">#000000</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #9DFFD2;">#9DFFD2</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:bold</span> t)
  <span style="color: #b22222;">;;    </span><span style="color: #b22222;">(setq zlc-select-completion-immediately t)</span>
  (<span style="color: #a020f0;">let</span> ((map minibuffer-local-map))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">like menu select</span>
    (define-key map (kbd <span style="color: #8b2252;">"C-n"</span>) 'zlc-select-next-vertical)
    (define-key map (kbd <span style="color: #8b2252;">"C-p"</span>) 'zlc-select-previous-vertical)
    (define-key map (kbd <span style="color: #8b2252;">"C-f"</span>) 'zlc-select-next)
    (define-key map (kbd <span style="color: #8b2252;">"C-b"</span>) 'zlc-select-previous)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">reset selection</span>
    (define-key map (kbd <span style="color: #8b2252;">"C-c"</span>) 'zlc-reset)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0dbdac1" class="outline-3">
<h3 id="org0dbdac1"><span class="section-number-3">6.28</span> [japanese-holidays] カレンダーをカラフルにする</h3>
<div class="outline-text-3" id="text-6-28">
<p>
ビルドインの <code>holidays</code> と， <code>japanese-holidays</code> を使います．土日祝日に色を着けます．土曜日と日曜祝日で異なる配色にできます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"calendar"</span>
  (add-hook 'calendar-today-visible-hook #'calendar-mark-today)

  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">japanese-holidays</span> nil t)
    (<span style="color: #a020f0;">setq</span> calendar-holidays
          (append japanese-holidays
                  holiday-local-holidays holiday-other-holidays))
    (<span style="color: #a020f0;">setq</span> mark-holidays-in-calendar t)
    (<span style="color: #a020f0;">setq</span> japanese-holiday-weekend-marker
          '(holiday nil nil nil nil nil japanese-holiday-saturday))
    (<span style="color: #a020f0;">setq</span> japanese-holiday-weekend '(0 6))
    (add-hook 'calendar-today-visible-hook #'japanese-holiday-mark-weekend)
    (add-hook 'calendar-today-invisible-hook #'japanese-holiday-mark-weekend)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb44976a" class="outline-3">
<h3 id="orgb44976a"><span class="section-number-3">6.29</span> [calendar.el] カレンダーで週番号を表示する</h3>
<div class="outline-text-3" id="text-6-29">
<p>
ビルドインの <code>calendar.el</code> にある <code>calendar-intermonth-text</code> をカスタマイズすると，カレンダーに週番号を表示させることが可能です．ただ， <code>calendar.el</code> に記載されている例だと， <code>calendar-week-start-day</code> が <code>1</code> 以外の時に計算結果がおかしくなるので，次のように <code>calendar-absolute-from-gregorian</code> に渡す値を補正する必要があります．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (global-set-key (kbd <span style="color: #8b2252;">"C-c f c c"</span>) 'calendar))

(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"calendar"</span>
  (<span style="color: #a020f0;">setq</span> calendar-week-start-day 1)
  (copy-face 'default 'calendar-iso-week-header-face)
  (set-face-attribute 'calendar-iso-week-header-face nil
                      <span style="color: #483d8b;">:height</span> 1.0 <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #1010FF;">#1010FF</span><span style="color: #8b2252;">"</span>
                      <span style="color: #483d8b;">:background</span> (face-background 'default))
  (<span style="color: #a020f0;">setq</span> calendar-intermonth-header
        (propertize <span style="color: #8b2252;">" w"</span>
                    'font-lock-face 'calendar-iso-week-header-face))

  (copy-face font-lock-constant-face 'calendar-iso-week-face)
  (set-face-attribute 'calendar-iso-week-face nil
                      <span style="color: #483d8b;">:height</span> 1.0 <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #ffa500;">orange</span><span style="color: #8b2252;">"</span>
                      <span style="color: #483d8b;">:background</span> (face-background 'default))

  (<span style="color: #a020f0;">setq</span> calendar-intermonth-text
        '(propertize
          (format <span style="color: #8b2252;">"%02d"</span>
                  (car
                   (calendar-iso-from-absolute
                    (calendar-absolute-from-gregorian
                     (list month
                           (- day (1- calendar-week-start-day)) year)))))
          'font-lock-face 'calendar-iso-week-face)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org8ae0f4b" class="outline-3">
<h3 id="org8ae0f4b"><span class="section-number-3">6.30</span> [guide-key] キーバインドの選択肢をポップアップする</h3>
<div class="outline-text-3" id="text-6-30">
<p>
<code>which-key</code> に移行しました．<br />
</p>

<p>
自分用の関数にキーバインドを付けたのはいいけど，覚えられない時に使っています．以下の例では， <code>helm</code> もしくは <code>org</code> が読み込まれた時についでに有効化し， <code>C-c f</code> を押して， 0.5秒経つと，その後ろに続くキーの一覧がポップします．すでに覚えたキーバインドならば，0.5秒以内に打てるでしょうから，ポップ表示無しで通常通りにコマンドが発行します．色分けも効くのでわかりやすいです．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(guide-key-mode)
       <span style="color: #8b2252;">"guide-key"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"guide-key"</span>
    (<span style="color: #a020f0;">setq</span> guide-key/guide-key-sequence '(<span style="color: #8b2252;">"C-c f"</span> <span style="color: #8b2252;">"C-c f c"</span>))
    (<span style="color: #a020f0;">setq</span> guide-key/popup-window-position 'bottom)
    (<span style="color: #a020f0;">setq</span> guide-key/idle-delay 0.5)
    (<span style="color: #a020f0;">setq</span> guide-key/highlight-command-regexp
          '((<span style="color: #8b2252;">"my-"</span> . <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #ff0000;">red</span><span style="color: #8b2252;">"</span>)
            (<span style="color: #8b2252;">"takaxp:"</span> . <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #0000ff;">blue</span><span style="color: #8b2252;">"</span>))))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
    (guide-key-mode 1))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"guide-key-mode"</span>)
      (guide-key-mode 1))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5a0682a" class="outline-3">
<h3 id="org5a0682a"><span class="section-number-3">6.31</span> [which-key] キーバインドの選択肢をポップアップする</h3>
<div class="outline-text-3" id="text-6-31">
<p>
<code>guide-key.el</code> の後発． <code>guide-key.el</code> の改良でもあり，ディスパッチャが見やすく，直感的でとても使いやすい．<br />
</p>

<p>
起動時間を短縮するため，設定の読み込みは <code>org-mode</code> か <code>helm</code> 起動時に行うように遅延設定している．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(which-key-mode)
       <span style="color: #8b2252;">"which-key"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"which-key"</span>)
      (which-key-mode 1)))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"which-key"</span>
    (custom-set-variables
     '(which-key-idle-delay 1.5))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0d12aea" class="outline-3">
<h3 id="org0d12aea"><span class="section-number-3">6.32</span> [stock-ticker] 株価をモードラインに表示</h3>
<div class="outline-text-3" id="text-6-32">
<p>
日経平均やダウ平均の状況をモードラインに表示します．表示が長くなる傾向があるので， <code>stock-ticker--parse</code> を再定義して，銘柄（3桁のみ）と変動率だけを表示しています．<br />
</p>

<p>
起動時には不要なので，ウィンドウにフォーカスが移った時に開始して，さらに1分でモードラインから消えるようにしています．<br />
</p>

<p>
色々と不安定になってきたので，最近は使っていません．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(my-activate-stock-ticker stock-ticker-global-mode)
       <span style="color: #8b2252;">"stock-ticker"</span> nil t)
  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"stock-ticker"</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">stock-ticker--parse</span> (data)
      <span style="color: #8b2252;">"Parse financial DATA into list of display strings."</span>
      (<span style="color: #a020f0;">let</span> ((qs (assoc-default
                 'quote (assoc-default
                         'results (assoc-default 'query data)))))
        (mapcar
         (<span style="color: #a020f0;">lambda</span> (q)
           (<span style="color: #a020f0;">let</span> ((percent (assoc-default 'PercentChange q))
                 (name (assoc-default 'Name q))
                 (symbol (assoc-default 'Symbol q))
                 (change (assoc-default 'Change q)))
             (format <span style="color: #8b2252;">" %s:%s"</span>
                     (substring
                      (<span style="color: #a020f0;">if</span> (<span style="color: #a020f0;">or</span>
                           (string-match <span style="color: #8b2252;">"="</span> symbol)
                           (string-match <span style="color: #8b2252;">"\\^"</span> symbol))
                          name symbol) <span style="color: #ff0000; font-weight: bold;">0 3)</span>
                     (<span style="color: #a020f0;">if</span> percent percent <span style="color: #8b2252;">""</span>))))
         qs)))
    (<span style="color: #a020f0;">setq</span> stock-ticker-display-interval 5)
    (<span style="color: #a020f0;">setq</span> stock-ticker-symbols '(<span style="color: #8b2252;">"^N225"</span> <span style="color: #8b2252;">"DOW"</span>))
    (<span style="color: #a020f0;">setq</span> stock-ticker-update-interval 300)

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-activate-stock-ticker</span> (<span style="color: #228b22;">&amp;optional</span> duration)
      <span style="color: #8b2252;">"Activate stock-ticker within the given duration."</span>
      (stock-ticker-global-mode 1)
      (<span style="color: #a020f0;">unless</span> (numberp duration)
        (<span style="color: #a020f0;">setq</span> duration 90))
      (run-with-timer duration nil 'stock-ticker-global-mode -1)))

  (add-hook 'focus-in-hook #'my-activate-stock-ticker))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb6eee68" class="outline-3">
<h3 id="orgb6eee68"><span class="section-number-3">6.33</span> [mode-icons] 使用中のモード表示をアイコンで代替</h3>
<div class="outline-text-3" id="text-6-33">
<p>
しばらく使ってみたが，統一感が失われるので使用停止中．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">mode-icons</span> nil t)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12450;&#12452;&#12467;&#12531;&#12434;&#20445;&#23384;&#12375;&#12390;&#12356;&#12427;&#12487;&#12451;&#12524;&#12463;&#12488;&#12522;&#12434;&#25351;&#23450;</span>
  (<span style="color: #a020f0;">setq</span> mode-icons--directory
        (expand-file-name <span style="color: #8b2252;">"~/.emacs.d/.cask/package/icons"</span>))
  (mode-icons-mode 1))
</pre>
</div>
</div>
</div>

<div id="outline-container-org49d8d29" class="outline-3">
<h3 id="org49d8d29"><span class="section-number-3">6.34</span> [highlight-symbol] 同じ名前のシンボルをハイライトする</h3>
<div class="outline-text-3" id="text-6-34">
<p>
一定時間が過ぎると，カーソル下のワードをバッファ内で検索し，ハイライトしてくれる．殺風景なバッファに動きが出て良い．また， <code>highlight-symbol-nav-mode</code> を使うと，シンボル間を <code>M-n/M-p</code> で移動できるので，毎度検索しなくてよい．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(highlight-symbol-mode highlight-symbol-nav-mode)
       <span style="color: #8b2252;">"highlight-symbol"</span> nil t)

  (<span style="color: #a020f0;">dolist</span> (hook '(emacs-lisp-mode-hook c-mode-common-hook prog-mode-hook))
    (add-hook hook #'highlight-symbol-mode))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"highlight-symbol"</span>
    (custom-set-variables
     '(highlight-symbol-idle-delay 0.5))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgff88de6" class="outline-3">
<h3 id="orgff88de6"><span class="section-number-3">6.35</span> [all-the-icons-dired] フォントを使ったアイコンを表示</h3>
<div class="outline-text-3" id="text-6-35">
<p>
<code>dired</code> と <code>neotree</code> で，ファイルのアイコンを表示します． <code>all-the-icons</code> をインストール後に， <code>M-x all-the-icons-install-fonts</code> を忘れずに実行する必要があります． <code>neotree</code> の設定は別セクションに記載しています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(all-the-icons-dired-mode)
       <span style="color: #8b2252;">"all-the-icons-dired"</span> nil t)

  (add-hook 'dired-mode-hook #'all-the-icons-dired-mode))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7cddb58" class="outline-3">
<h3 id="org7cddb58"><span class="section-number-3">6.36</span> [eldoc.el] コンテクストに応じてヘルプを表示</h3>
<div class="outline-text-3" id="text-6-36">
<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(turn-on-eldoc-mode)
       <span style="color: #8b2252;">"eldoc"</span> nil t)

  (<span style="color: #a020f0;">dolist</span> (hook '(emacs-lisp-mode-hook org-mode-hook c-mode-common-hook))
    (add-hook hook #'turn-on-eldoc-mode))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"eldoc"</span>
    (custom-set-variables
     '(eldoc-idle-delay 1.5))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org32c2fa7" class="outline-3">
<h3 id="org32c2fa7"><span class="section-number-3">6.37</span> [keycast.el] 入力しているキーとコマンドをモードラインに表示</h3>
<div class="outline-text-3" id="text-6-37">
<ul class="org-ul">
<li>入力した文字や発行したコマンドキーをモードラインに表示．コマンドの名前もリアルタイムに表示される．<br /></li>
<li><a href="https://github.com/tarsius/keycast">tarsius/keycast: Show current command and its key in the mode line</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(autoload-if-found '(keycast-mode) <span style="color: #8b2252;">"keycast"</span> nil t)
</pre>
</div>
</div>
</div>
<div id="outline-container-org5f61302" class="outline-3">
<h3 id="org5f61302"><span class="section-number-3">6.38</span> <span class="todo TODO">TODO</span> [dimmer.el] 現在のバッファ以外の輝度を落とす</h3>
<div class="outline-text-3" id="text-6-38">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(dimmer-mode dimmer-process-all dimmer-off dimmer-on)
       <span style="color: #8b2252;">"dimmer"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"dimmer-mode"</span>)
      (custom-set-variables
       '(dimmer-exclusion-regexp
         <span style="color: #8b2252;">"^\\*[Hh]elm</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">|</span><span style="color: #8b2252;">^ \\*Minibuf</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">|</span><span style="color: #8b2252;">^ \\*Echo</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">|</span><span style="color: #8b2252;">^\\*Calendar</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">|</span><span style="color: #8b2252;">*Org"</span>)
       '(dimmer-fraction 0.6))
      (dimmer-mode 1)))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"dimmer"</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">dimmer-off</span> ()
      (dimmer-mode -1)
      (dimmer-process-all))
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">dimmer-on</span> ()
      (dimmer-mode 1)
      (dimmer-process-all))
    (add-hook 'focus-out-hook #'dimmer-off)
    (add-hook 'focus-in-hook #'dimmer-on)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgcb202fa" class="outline-2">
<h2 id="orgcb202fa"><span class="section-number-2">7</span> メディアサポート</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org2a29974" class="outline-3">
<h3 id="org2a29974"><span class="section-number-3">7.1</span> [bongo.el] Emacsのバッファで音楽ライブラリを管理する</h3>
<div class="outline-text-3" id="text-7-1">
<p>
<a href="https://pxaka.tokyo/wiki/doku.php?id=emacs">iTunes の代わりに Emacs を使う</a><br />
</p>

<p>
autoload を設定すると， <code>*.bango-playlist</code> や <code>*.bongo-library</code> から起動できないので，明示的に require している．なお，bongo-mplayer を使う場合，bongo を先にrequireするとうまく動作しない（bongo.el の最後で，bongo-mplayer が provide されているからだと思われる）．<br />
</p>

<p>
以下の設定では，autoload で使いつつ，=M-x init-bongo= でプレイリストを読み込んでいる．これならば，Emacs起動時は軽量で，かつ，プレイリストの訪問で Bongo を開始できる．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(bongo)
       <span style="color: #8b2252;">"bongo-mplayer"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"bongo-mplayer"</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">init-bongo</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (bongo)
      (find-file <span style="color: #8b2252;">"~/Desktop/next/Tidy/hoge.bongo-playlist"</span>))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Volume control</span>
    <span style="color: #b22222;">;;         </span><span style="color: #b22222;">(require volume.el nil t)</span>
    (<span style="color: #a020f0;">setq</span> bongo-mplayer-extra-arguments '(<span style="color: #8b2252;">"-volume"</span> <span style="color: #8b2252;">"1"</span>))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Avoid error when editing bongo buffers</span>
    (<span style="color: #a020f0;">setq</span> yank-excluded-properties nil)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Use mplayer</span>
    (<span style="color: #a020f0;">setq</span> bongo-enabled-backends '(mplayer))))
</pre>
</div>

<p>
org-player.el を使えば，org-mode のバッファから Bongo を操作できる．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-player</span> nil t))
</pre>
</div>

<p>
音量コントロールには，<a href="https://github.com/dbrock/volume-el">volume.el</a>が必要です．設定がうまくいかないので保留中<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(autoload 'volume <span style="color: #8b2252;">"volume"</span> <span style="color: #8b2252;">"Tweak your sound card volume."</span> t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org3da11c2" class="outline-3">
<h3 id="org3da11c2"><span class="section-number-3">7.2</span> [emms.el] メディアプレーヤー</h3>
<div class="outline-text-3" id="text-7-2">
<p>
<code>mpv</code> を使い，emacs からメディアファイルを再生します．Bongo.elよりも使いやすい印象．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(emms-play-file
         emms-play-playlist emms-play-directory my-play-bgm
         emms-next emms-previous emms-stop emms-pause)
       <span style="color: #8b2252;">"emms"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-c e b"</span>) 'my-play-bgm)
    (<span style="color: #a020f0;">let</span> ((base <span style="color: #8b2252;">"C-c e "</span>))
      (global-set-key (kbd (concat base <span style="color: #8b2252;">"n"</span>)) 'emms-next)
      (global-set-key (kbd (concat base <span style="color: #8b2252;">"p"</span>)) 'emms-previous)
      (global-set-key (kbd (concat base <span style="color: #8b2252;">"s"</span>)) 'emms-stop)
      (global-set-key (kbd (concat base <span style="color: #8b2252;">"SPC"</span>)) 'emms-pause)))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"emms-mode-line"</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:emms-mode-line-playlist-current</span> ()
      <span style="color: #8b2252;">"Display filename in mode-line, not full-path."</span>
      (format emms-mode-line-format
              (file-name-nondirectory
               (emms-track-description
                (emms-playlist-current-selected-track)))))
    (advice-add 'emms-mode-line-playlist-current <span style="color: #483d8b;">:override</span>
                #'advice:emms-mode-line-playlist-current))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"emms-mode-line-icon"</span>
    (<span style="color: #a020f0;">setq</span> emms-mode-line-format <span style="color: #8b2252;">"%s"</span>)
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:emms-mode-line-icon-function</span> ()
      <span style="color: #8b2252;">"Replace the default musical note icon with a Unicode character."</span>
      (concat <span style="color: #8b2252;">" "</span>
              emms-mode-line-icon-before-format
              <span style="color: #8b2252;">"&#9834;"</span>
              (emms-mode-line-playlist-current)))
    (advice-add 'emms-mode-line-icon-function <span style="color: #483d8b;">:override</span>
                #'advice:emms-mode-line-icon-function))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"emms"</span>
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">emms-setup</span> nil t)
      (emms-standard)
      (emms-default-players))

    (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">helm-emms</span> nil t)

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-play-bgm</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">let</span> ((file <span style="color: #8b2252;">"~/Dropbox/12-audio/ffximusic104.m4a"</span>))
        (<span style="color: #a020f0;">when</span> (file-exists-p file)
          (emms-play-file file)
          (emms-toggle-repeat-track))))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">setup an additional player</span>
    (<span style="color: #a020f0;">if</span> (executable-find <span style="color: #8b2252;">"mpv"</span>)
        (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">emms-player-mpv</span> nil t)
          (add-to-list 'emms-player-list 'emms-player-mpv)

          <span style="color: #b22222;">;; </span><span style="color: #b22222;">(defvar emms-player-mpv-ontop nil)</span>
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">(defun emms-player-mpv-toggle-ontop ()</span>
          <span style="color: #b22222;">;;   </span><span style="color: #b22222;">"Toggle float on top."</span>
          <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(interactive)</span>
          <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(if emms-player-mpv-ontop</span>
          <span style="color: #b22222;">;;       </span><span style="color: #b22222;">(emms-player-mpv-disable-ontop)</span>
          <span style="color: #b22222;">;;     </span><span style="color: #b22222;">(emms-player-mpv-enable-ontop)))</span>

          <span style="color: #b22222;">;; </span><span style="color: #b22222;">(defun emms-player-mpv-enable-ontop ()</span>
          <span style="color: #b22222;">;;   </span><span style="color: #b22222;">"Enable float on top."</span>
          <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(let ((cmd (emms-player-mpv--format-command "set ontop yes")))</span>
          <span style="color: #b22222;">;;     </span><span style="color: #b22222;">(call-process-shell-command cmd nil nil nil))</span>
          <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(setq emms-player-mpv-ontop t))</span>

          <span style="color: #b22222;">;; </span><span style="color: #b22222;">(defun emms-player-mpv-disable-ontop ()</span>
          <span style="color: #b22222;">;;   </span><span style="color: #b22222;">"Disable float on top."</span>
          <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(let ((cmd (emms-player-mpv--format-command "set ontop no")))</span>
          <span style="color: #b22222;">;;     </span><span style="color: #b22222;">(call-process-shell-command cmd nil nil nil))</span>
          <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(setq emms-player-mpv-ontop nil))</span>

          <span style="color: #b22222;">;; </span><span style="color: #b22222;">(global-set-key (kbd "C-c e t") 'emms-player-mpv-toggle-ontop)</span>
          )

      (message <span style="color: #8b2252;">"--- mpv is NOT installed."</span>))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org108ee70" class="outline-3">
<h3 id="org108ee70"><span class="section-number-3">7.3</span> [GoogleMaps.el] GoogleMaps を Emacs 内で使う</h3>
<div class="outline-text-3" id="text-7-3">
<p>
<a href="http://julien.danjou.info/software/google-maps.el">http://julien.danjou.info/software/google-maps.el</a><br />
</p>

<p>
<code>M-x google-maps</code> で起動します．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(google-maps)
       <span style="color: #8b2252;">"google-maps"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"google-maps"</span>
    (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-location-google-maps</span> nil t)))
</pre>
</div>

<p>
<code>+/-</code> でズーム， <code>矢印</code> で移動， <code>q</code> で終了します．また， <code>w</code> でURLを取得してコピー， <code>t</code> で地図の種別を変更できます．<br />
</p>

<p>
Org-mode を使っている場合には， <code>C-c M-L</code> で表示されるプロンプトで検索すると，プロパティにそのキーワードが記録されます．後から <code>C-c M-l</code> すれば，いつでも地図を表示できるようになります．<br />
</p>
</div>
</div>

<div id="outline-container-org8d397db" class="outline-3">
<h3 id="org8d397db"><span class="section-number-3">7.4</span> [org-google-weather.el] org-agenda に天気を表示する</h3>
<div class="outline-text-3" id="text-7-4">
<p>
残念ながら Google API が変更になり動かなくなったそうです．<br />
</p>

<p>
<a href="http://julien.danjou.info/software/google-weather.el">http://julien.danjou.info/software/google-weather.el</a><br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">google-weather</span> nil t)
(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-google-weather</span> nil t)
  '(org-google-weather-use-google-icons t))
</pre>
</div>
</div>
</div>
<div id="outline-container-org6434a83" class="outline-3">
<h3 id="org6434a83"><span class="section-number-3">7.5</span> [japanlaw.el] Emacs 電子六法</h3>
<div class="outline-text-3" id="text-7-5">
<p>
Emacs で総務省の「<a href="http://law.e-gov.go.jp/">法令データ提供システム</a>」に登録された法令データを閲覧します． <code>w3m</code> が必要です．<br />
</p>

<ul class="org-ul">
<li><a href="http://www.ne.jp/asahi/alpha/kazu/laws.html">Emacs 電子六法</a><br /></li>
<li><a href="https://github.com/mhayashi1120/japanlaw.el">mhayashi1120/japanlaw.el: Emacs 電子六法</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">if</span> (executable-find <span style="color: #8b2252;">"w3m"</span>)
    (autoload-if-found
     '(japanlaw)
     <span style="color: #8b2252;">"japanlaw"</span> nil t)

  (message <span style="color: #8b2252;">"--- w3m is NOT installed."</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-org6e01579" class="outline-3">
<h3 id="org6e01579"><span class="section-number-3">7.6</span> [sunshine.el] 天気を知る</h3>
<div class="outline-text-3" id="text-7-6">
<ul class="org-ul">
<li><a href="https://openweathermap.org/">https://openweathermap.org/</a> にアカウントを作り，APIを呼び出すための専用IDを発行する必要があります．取得した idを， <code>sunshine-appid</code> に格納し， <code>sunshine-location</code> で対象地域を設定すれば， <code>M-x sunshine-forecast</code> で天気が表示されます． <code>M-x sunshine-quick-format</code> を使うと，結果がミニバッファに表示されます．<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(sunshine-forecast sunshine-quick-forecast)
       <span style="color: #8b2252;">"sunshine"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"sunshine"</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq sunshine-location "Tokyo, Japan")</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq sunshine-appid "................................")</span>
    (custom-set-variables
     '(sunshine-show-icons t)
     '(sunshine-units 'metric))))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org8d85e91" class="outline-2">
<h2 id="org8d85e91"><span class="section-number-2">8</span> 履歴／ファイル管理</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-org41de425" class="outline-3">
<h3 id="org41de425"><span class="section-number-3">8.1</span> [dired] ファイラのサポートツール</h3>
<div class="outline-text-3" id="text-8-1">
<p>
<code>dired.el</code> をリッチに使うツール群．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"dired"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">gited</span> nil t)
    (define-key dired-mode-map (kbd <span style="color: #8b2252;">"C-x C-g"</span>) 'gited-list-branches))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">https://github.com/Fuco1/dired-hacks</span>

  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">dired-narrow</span> nil t)
    (define-key dired-mode-map (kbd <span style="color: #8b2252;">"/"</span>) 'dired-narrow))

  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">dired-du</span> nil t)

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">https://github.com/xuchunyang/emacs.d</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">type "!" or "X" in dired</span>
  (<span style="color: #a020f0;">when</span> (eq system-type 'darwin)
    (<span style="color: #a020f0;">setq</span> dired-guess-shell-alist-user
          (list
           (list (<span style="color: #a020f0;">rx</span> (<span style="color: #a020f0;">and</span> <span style="color: #8b2252;">"."</span>
                          (<span style="color: #a020f0;">or</span>
                           <span style="color: #b22222;">;; </span><span style="color: #b22222;">Videos</span>
                           <span style="color: #8b2252;">"mp4"</span> <span style="color: #8b2252;">"avi"</span> <span style="color: #8b2252;">"mkv"</span> <span style="color: #8b2252;">"rmvb"</span>
                           <span style="color: #b22222;">;; </span><span style="color: #b22222;">Torrent</span>
                           <span style="color: #8b2252;">"torrent"</span>
                           <span style="color: #b22222;">;; </span><span style="color: #b22222;">PDF</span>
                           <span style="color: #8b2252;">"pdf"</span>
                           <span style="color: #b22222;">;; </span><span style="color: #b22222;">Image</span>
                           <span style="color: #8b2252;">"gif"</span> <span style="color: #8b2252;">"png"</span> <span style="color: #8b2252;">"jpg"</span> <span style="color: #8b2252;">"jpeg"</span>)
                          string-end)) <span style="color: #8b2252;">"open"</span>)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb9f8364" class="outline-3">
<h3 id="orgb9f8364"><span class="section-number-3">8.2</span> <span class="todo TODO">TODO</span> [dired-x] dired 拡張設定</h3>
<div class="outline-text-3" id="text-8-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"dired"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">dired-x</span> nil t)
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-reveal-in-finder</span> ()
      <span style="color: #8b2252;">"Reveal the current buffer in Finder."</span>
      (<span style="color: #a020f0;">interactive</span>)
      (shell-command-to-string <span style="color: #8b2252;">"open ."</span>))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">dired-x &#12434;&#35501;&#12415;&#36796;&#12435;&#12384;&#12354;&#12392;&#12376;&#12419;&#12394;&#12356;&#12392;&#12384;&#12417;</span>
    (define-key dired-mode-map (kbd <span style="color: #8b2252;">"M-f"</span>) 'my-reveal-in-finder)
    (dired-extra-startup)))

(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"helm-config"</span>
  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">helm-dired-history</span> nil t))
</pre>
</div>
</div>
</div>

<div id="outline-container-org31bb8f0" class="outline-3">
<h3 id="org31bb8f0"><span class="section-number-3">8.3</span> <span class="todo TODO">TODO</span> [dired-recent] 訪問したディレクトリの履歴を取る</h3>
<div class="outline-text-3" id="text-8-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(dired-recent-open dired-recent-mode)
       <span style="color: #8b2252;">"dired-recent"</span> nil t)

  (global-set-key (kbd <span style="color: #8b2252;">"C-x C-d"</span>) 'dired-recent-open)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"dired-recent"</span>
    (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">helm-config</span> nil t)
    (dired-recent-mode 1)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org66d0bfd" class="outline-3">
<h3 id="org66d0bfd"><span class="section-number-3">8.4</span> Undoバッファを無限に取る</h3>
<div class="outline-text-3" id="text-8-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> undo-outer-limit nil)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb9a1b72" class="outline-3">
<h3 id="orgb9a1b72"><span class="section-number-3">8.5</span> [undo-tree] 編集履歴をわかりやすくたどる</h3>
<div class="outline-text-3" id="text-8-5">
<p>
Undoのツリーが表示され，履歴をたどれます． <code>C-x u</code> と <code>q</code> に対して，フレームサイズの変更を紐付けています．また， <code>auto-save-buffers</code> が org-files をどんどん保存して記録してしまうので，ツリーを選んでいる時に auto-save-buffers が発動するのを別途抑制しています．加えて， <code>org-tree-slide</code> でナローイングしていると，タイムスタンプが記録される時に履歴が辿れなくなるので， <code>org-tree-slide</code> が有効の時は，タイムスタンプを押させないように別途制限を加えています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(my-undo-tree-visualize)
       <span style="color: #8b2252;">"undo-tree"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-x u"</span>) 'my-undo-tree-visualize))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"undo-tree"</span>
    (global-undo-tree-mode)
    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">undo-tree-active</span> nil)
    (<span style="color: #a020f0;">setq</span> undo-tree-mode-lighter nil) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12514;&#12540;&#12489;&#12521;&#12452;&#12531;&#38936;&#22495;&#12434;&#31680;&#32004;</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-undo-tree-visualizer-quit</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (undo-tree-visualizer-quit)
      (delete-window)
      (<span style="color: #a020f0;">when</span> undo-tree-active
        (set-frame-width (selected-frame)
                         (- (frame-width) 63))
        (<span style="color: #a020f0;">setq</span> undo-tree-active nil))
      (<span style="color: #a020f0;">when</span> (&lt; (frame-width) moom--frame-width)
        (set-frame-width (selected-frame) moom--frame-width)))
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-undo-tree-visualize</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (not undo-tree-active) (not (eq buffer-undo-list t)))
        (set-frame-width (selected-frame)
                         (+ (frame-width) 63))
        (<span style="color: #a020f0;">setq</span> undo-tree-active t))
      (undo-tree-visualize))

    (define-key undo-tree-visualizer-mode-map (kbd <span style="color: #8b2252;">"q"</span>)
      'my-undo-tree-visualizer-quit)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">undo-tree-map &#12395;&#12418;&#24517;&#35201;</span>
    (define-key undo-tree-map (kbd <span style="color: #8b2252;">"C-x u"</span>)
      'my-undo-tree-visualize)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3520dda" class="outline-3">
<h3 id="org3520dda"><span class="section-number-3">8.6</span> バッファ保存時にバックアップファイルを生成する</h3>
<div class="outline-text-3" id="text-8-6">
<p>
バッファが保存されるとき，必ずバックアップを生成する．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">Backup the buffer whenever the buffer is saved</span>
(global-set-key (kbd <span style="color: #8b2252;">"C-x C-s"</span>)
                #'(lambda () (<span style="color: #a020f0;">interactive</span>) (save-buffer 16)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org42c9180" class="outline-3">
<h3 id="org42c9180"><span class="section-number-3">8.7</span> バッファ保存時にバックアップを生成させない</h3>
<div class="outline-text-3" id="text-8-7">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">*.~</span>
(<span style="color: #a020f0;">setq</span> make-backup-files nil)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">.#*</span>
(<span style="color: #a020f0;">setq</span> auto-save-default nil)
<span style="color: #b22222;">;; </span><span style="color: #b22222;">auto-save-list</span>
(<span style="color: #a020f0;">setq</span> auto-save-list-file-prefix nil)
</pre>
</div>
</div>
</div>

<div id="outline-container-org8a7c193" class="outline-3">
<h3 id="org8a7c193"><span class="section-number-3">8.8</span> ミニバッファの履歴を保存しリストアする</h3>
<div class="outline-text-3" id="text-8-8">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">savehist</span> nil t)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12498;&#12473;&#12488;&#12522;&#12501;&#12449;&#12452;&#12523;&#12434;&#26126;&#31034;&#30340;&#12395;&#25351;&#23450;</span>
  (<span style="color: #a020f0;">setq</span> savehist-file <span style="color: #8b2252;">"~/Dropbox/emacs.d/.history"</span>)
  (savehist-mode 1))
</pre>
</div>
</div>
</div>

<div id="outline-container-org2df90cc" class="outline-3">
<h3 id="org2df90cc"><span class="section-number-3">8.9</span> 履歴サイズを大きくする</h3>
<div class="outline-text-3" id="text-8-9">
<p>
<code>t</code> で無限大に指定する．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> history-length 2000)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcd2dd89" class="outline-3">
<h3 id="orgcd2dd89"><span class="section-number-3">8.10</span> Emacs終了時に開いていたバッファを起動時に復元する</h3>
<div class="outline-text-3" id="text-8-10">
<p>
Built-in の <a href="http://www.emacswiki.org/emacs/DeskTop">desktop.el</a> を使う．<br />
</p>

<p>
org バッファを CONTENT view で大量に開いていると，再起動が非常に遅くなるので利用を中止した．代替手段として，session.el と recentf の組み合わせがある．最近利用したファイルとそのカーソル位置が保持されるため，最後に訪問していたファイルを比較的簡単に復元できる．頻繁に復元するバッファには，別途キーバインドを割り当てておけば問題ない．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">desktop</span> nil t)
    (<span style="color: #a020f0;">setq</span> desktop-files-not-to-save <span style="color: #8b2252;">"</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">(</span><span style="color: #8b2252;">^/tmp</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">|</span><span style="color: #8b2252;">^/var</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">|</span><span style="color: #8b2252;">^/ssh:</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">)</span><span style="color: #8b2252;">"</span>)
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"desktop"</span>)
      (desktop-save-mode 1))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org427227f" class="outline-3">
<h3 id="org427227f"><span class="section-number-3">8.11</span> 最近開いたファイルリストを保持</h3>
<div class="outline-text-3" id="text-8-11">
<p>
Built-in の <a href="http://www.emacswiki.org/emacs/RecentFiles">recentf.el</a> を使う．<br />
</p>

<p>
<a href="http://d.hatena.ne.jp/tomoya/20110217/1297928222">http://d.hatena.ne.jp/tomoya/20110217/1297928222</a><br />
</p>

<p>
session.el でも履歴管理できるが，anything のソースとして使っているので併用している．<br />
</p>

<p>
recentf-auto-cleanup を <code>'mode</code> などにすると起動時にファイルのクリーニングが行われるてしまうので，='never= で回避し，アイドルタイマーなどで対応する．これだけで50[ms]ほど起動を高速化できる．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(rencetf-mode
         my-recentf-save-list-silence
         my-recentf-cleanup-silence
         recentf-open-files)
       <span style="color: #8b2252;">"recentf"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"recentf-mode"</span>)
      (recentf-mode 1)))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"recentf"</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-recentf-save-list-silence</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">let</span> ((message-log-max nil))
        (<span style="color: #a020f0;">if</span> (fboundp 'shut-up)
            (<span style="color: #a020f0;">shut-up</span> (recentf-save-list))
          (recentf-save-list)))
      (message <span style="color: #8b2252;">""</span>))
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-recentf-cleanup-silence</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">let</span> ((message-log-max nil))
        (<span style="color: #a020f0;">if</span> shutup-p
            (<span style="color: #a020f0;">shut-up</span> (recentf-cleanup))
          (recentf-cleanup)))
      (message <span style="color: #8b2252;">""</span>))
    (add-hook 'focus-out-hook #'my-recentf-save-list-silence)
    (add-hook 'focus-out-hook #'my-recentf-cleanup-silence)

    (custom-set-variables
     '(recentf-max-saved-items 2000)
     '(recentf-save-file (expand-file-name <span style="color: #8b2252;">"~/.emacs.d/recentf"</span>))
     '(recentf-auto-cleanup 'never)
     '(recentf-exclude
       '(<span style="color: #8b2252;">".recentf"</span> <span style="color: #8b2252;">"^/tmp\\.*"</span>
         <span style="color: #8b2252;">"^/private\\.*"</span> <span style="color: #8b2252;">"^/var/folders\\.*"</span> <span style="color: #8b2252;">"/TAGS$"</span>)))))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-hook 'after-init-hook #'recentf-mode))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc0b79e1" class="outline-3">
<h3 id="orgc0b79e1"><span class="section-number-3">8.12</span> 深夜にバッファを自動整理する</h3>
<div class="outline-text-3" id="text-8-12">
<ul class="org-ul">
<li><a href="http://www.emacswiki.org/emacs-zh/CleanBufferList">http://www.emacswiki.org/emacs-zh/CleanBufferList</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">midnight</span> nil t)
  (<span style="color: #a020f0;">setq</span> clean-buffer-list-buffer-names
        (append clean-buffer-list-kill-buffer-names
                '(<span style="color: #8b2252;">"note.txt"</span>)))
  (<span style="color: #a020f0;">setq</span> clean-buffer-list-delay-general 1)
  (<span style="color: #a020f0;">setq</span> clean-buffer-list-delay-special 10))
</pre>
</div>
</div>
</div>

<div id="outline-container-orge2b36e6" class="outline-3">
<h3 id="orge2b36e6"><span class="section-number-3">8.13</span> [auto-save-buffers.el] 一定間隔でバッファを保存する</h3>
<div class="outline-text-3" id="text-8-13">
<ul class="org-ul">
<li><a href="http://0xcc.net/misc/auto-save/">http://0xcc.net/misc/auto-save/</a><br /></li>
</ul>

<p>
同じ機能で比較的新しいパッケージに， <code>real-auto-save</code> があります．ただ，私の場合は，以下のようなモードごとの制御がうまくできなかったので移行していません．<br />
</p>

<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">auto-save-buffers</span> nil t)
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"auto-save-buffers"</span>))
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-auto-save-buffers</span> ()
      (<span style="color: #a020f0;">cond</span> ((equal major-mode 'undo-tree-visualizer-mode) nil)
            ((equal major-mode 'diff-mode) nil)
            ((string-match <span style="color: #8b2252;">"Org Src"</span> (buffer-name)) nil)
            (t (<span style="color: #a020f0;">if</span> shutup-p
                   (<span style="color: #a020f0;">shut-up</span> (auto-save-buffers))
                 (auto-save-buffers)))))
    (run-with-idle-timer 1.6 t #'my-auto-save-buffers)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org63d994b" class="outline-3">
<h3 id="org63d994b"><span class="section-number-3">8.14</span> [backup-dir.el] バックアップファイルを一箇所に集める</h3>
<div class="outline-text-3" id="text-8-14">
<p>
<code>backup-each-save</code> を使うようになりました．<br />
</p>

<ul class="org-ul">
<li><a href="http://www.emacswiki.org/emacs/BackupDirectory">http://www.emacswiki.org/emacs/BackupDirectory</a><br /></li>
<li><a href="http://www.northbound-train.com/emacs-hosted/backup-dir.el">http://www.northbound-train.com/emacs-hosted/backup-dir.el</a><br /></li>
<li><a href="http://www.northbound-train.com/emacs.html">http://www.northbound-train.com/emacs.html</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(make-variable-buffer-local 'backup-inhibited)
(<span style="color: #a020f0;">setq</span> backup-files-store-dir <span style="color: #8b2252;">"~/.emacs.d/backup"</span>)
(<span style="color: #a020f0;">unless</span> (file-directory-p backup-files-store-dir)
  (message <span style="color: #8b2252;">"!!! %s does not exist. !!!"</span> backup-files-store-dir)
  (sleep-for 1))
(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">backup-dir</span> nil t)
  (<span style="color: #a020f0;">when</span> (file-directory-p backup-files-store-dir)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">backup path</span>
    (<span style="color: #a020f0;">setq</span> bkup-backup-directory-info '((t <span style="color: #8b2252;">"~/.emacs.d/backup"</span> ok-create)))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">for tramp</span>
    (<span style="color: #a020f0;">setq</span> tramp-bkup-backup-directory-info bkup-backup-directory-info)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">generation properties</span>
    (<span style="color: #a020f0;">setq</span> delete-old-versions t
          kept-old-versions 0
          kept-new-versions 5
          version-control t)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0c2013e" class="outline-3">
<h3 id="org0c2013e"><span class="section-number-3">8.15</span> [backup-each-save] クラッシュに備える</h3>
<div class="outline-text-3" id="text-8-15">
<p>
直近のファイルを常にバックアップします． <code>backup-dir.el</code> でも良いですが，バックアップの目的が，バッファ編集中に <code>emacs</code> が落ちる時の保険ならば， <code>backup-each-save</code> の方が適切な場合があります．以下の例では，すべてのファイルを保存の度に保存し， <code>emacs</code> 起動後に postpone モードが有効になる時点で7日前までのバックアップファイルをすべて削除するようにしています．<br />
</p>

<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(backup-each-save my-auto-backup)
       <span style="color: #8b2252;">"backup-each-save"</span> nil t)

  (add-hook 'after-save-hook 'my-auto-backup)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"backup-each-save"</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-auto-backup</span> ()
      (<span style="color: #a020f0;">unless</span> (equal (buffer-name) <span style="color: #8b2252;">"recentf"</span>)
        (backup-each-save)))
    (<span style="color: #a020f0;">setq</span> backup-each-save-mirror-location <span style="color: #8b2252;">"~/.emacs.d/backup"</span>)
    (<span style="color: #a020f0;">setq</span> backup-each-save-time-format <span style="color: #8b2252;">"%y-%m-%d_%M:%S"</span>)
    (<span style="color: #a020f0;">setq</span> backup-each-save-size-limit 1048576))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12394;&#12380;&#12363; (backup-each-save) &#12398;&#30452;&#25509;&#21628;&#12403;&#20986;&#12375;&#12384;&#12392;&#12384;&#12417;</span>
  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">backup-each-save</span> nil t)
      (<span style="color: #a020f0;">unless</span> batch-build
        (postpone-message <span style="color: #8b2252;">"backup-each-save"</span>)))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">%y-%m-%d_%M:%S &#12391;&#32066;&#12431;&#12427;&#12501;&#12449;&#12452;&#12523;&#12434;&#26412;&#26469;&#12398;&#12513;&#12472;&#12515;&#12540;&#12514;&#12540;&#12489;&#12391;&#38283;&#12367;</span>
    (add-to-list 'auto-mode-alist '(<span style="color: #8b2252;">"-[0-9-]\\{8\\}_[0-9:]\\{5\\}$"</span> nil t))))

(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(recursive-delete-backup-files delete-backup-files)
       <span style="color: #8b2252;">"utility"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (recursive-delete-backup-files 7)))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-hook 'kill-emacs-hook #'my-delete-backup-7days))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7650226" class="outline-3">
<h3 id="org7650226"><span class="section-number-3">8.16</span> 特定のファイルを Dropbox 以下にバックアップする</h3>
<div class="outline-text-3" id="text-8-16">
<p>
複数の端末でEmacsを使うと，稀に端末の環境に依存した設定ファイルが必要になり，それらは端末間で共有しません．私の場合は， <code>recentf</code> がそれに該当します．とは言えバックアップしていないのは不安なので，なんとかします．引数にバックアップ対象のファイルリストを渡せます．<br />
</p>

<p>
ちょっとダサいのですが，予め <code>~/Dropbox/backup</code> の下に， <code>system-name</code> で得られる値のディレクトリを作成する必要があります． <code>my-backup</code> は <a href="./utility.el">./utility.el</a> で実装しています．<br />
</p>

<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(my-backup-recentf my-backup)
       <span style="color: #8b2252;">"utility"</span> nil t)

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-backup-recentf</span> ()
    (my-backup <span style="color: #8b2252;">"~/.emacs.d/recentf"</span>))
  (run-with-idle-timer 180 t 'my-backup-recentf))
</pre>
</div>
</div>
</div>

<div id="outline-container-org004ef2b" class="outline-3">
<h3 id="org004ef2b"><span class="section-number-3">8.17</span> [session.el] 様々な履歴を保存し復元に利用する</h3>
<div class="outline-text-3" id="text-8-17">
<p>
<a href="http://emacs-session.sourceforge.net/">http://emacs-session.sourceforge.net/</a><br />
</p>

<ul class="org-ul">
<li>入力履歴の保持（検索語，表示したバッファ履歴）<br /></li>
<li>保存時のカーソル位置の保持<br /></li>
<li>キルリングの保持<br /></li>
<li>変更が加えられたファイル履歴の保持<br /></li>
<li><code>session-initialize</code> の呼び出しタイミングに注意．前回終了時の状況を保存しているため，他のパッケージの初期化が終った後に呼び出すと，パッケージが想定している初期化を上書きしてしまい，不安定になる． <code>after-init-hook</code> 推奨．<br /></li>
</ul>
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> <code>M-x session-save-session</code><br /></li>
</ul>

<p>
session-undo-check を指定していると，保存時ではなくバッファを閉じるときの状態を保持する．<br />
</p>

<p>
Org Mode と併用する場合は，my-org-reveal-session-jump の設定が必須．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(session-initialize)
       <span style="color: #8b2252;">"session"</span> nil t)

  (<span style="color: #a020f0;">unless</span> batch-build
    (add-hook 'after-init-hook #'session-initialize))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"session"</span>
    (add-to-list 'session-globals-exclude 'org-mark-ring)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Change save point of session.el</span>
    (<span style="color: #a020f0;">setq</span> session-save-file
          (expand-file-name <span style="color: #8b2252;">"~/Dropbox/emacs.d/.session"</span>))
    (<span style="color: #a020f0;">setq</span> session-initialize '(de-saveplace session keys menus places)
          session-globals-include '((kill-ring 100)
                                    (session-file-alist 100 t)
                                    (file-name-history 200)
                                    search-ring
                                    regexp-search-ring))
    (<span style="color: #a020f0;">setq</span> session-undo-check -1)))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">FIXME</span>
<span style="color: #b22222;">;;  </span><span style="color: #b22222;">(setq session-set-file-name-exclude-regexp</span>
<span style="color: #b22222;">;;        </span><span style="color: #b22222;">"^/private/\\.\\*"))</span>
<span style="color: #b22222;">;;          </span><span style="color: #b22222;">"[/\\]\\.overview\\|[/\\]\\.session\\|News[/\\]\\|^/private\\.*\\|^/var/folders\\.*"))</span>
</pre>
</div>

<p>
次はテスト中．orgバッファを開いたらカーソル位置をorg-revealしたいが，time-stampなどと組み合わせたり，org-tree-slideと組み合わせていると，うまくいかない．バッファを表示した時に org-reveal (C-c C-r) を打つのをサボりたいだけなのだが．．．<br />
</p>

<p>
<a href="http://www.emacswiki.org/emacs/EmacsSession">http://www.emacswiki.org/emacs/EmacsSession</a><br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(session-initialize)
       <span style="color: #8b2252;">"session"</span> nil t)
  (add-hook 'after-init-hook #'session-initialize)
  (eval-after-load <span style="color: #8b2252;">"session"</span>
    '(<span style="color: #a020f0;">progn</span>
       <span style="color: #b22222;">;; </span><span style="color: #b22222;">For Org-mode</span>
       (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-maybe-reveal</span> ()
         (<span style="color: #a020f0;">interactive</span>)
         (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (<span style="color: #a020f0;">or</span> (memq major-mode '(org-mode outline-mode))
                        (<span style="color: #a020f0;">and</span> (boundp 'outline-minor-mominor-de)
                             outline-minor-mode))
                    (outline-invisible-p))
           (<span style="color: #a020f0;">if</span> (eq major-mode 'org-mode)
               (org-reveal)
             (show-subtree))))

       (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-org-reveal-session-jump</span> ()
         (message <span style="color: #8b2252;">"call!"</span>)
         (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (eq major-mode 'org-mode)
                    (outline-invisible-p))
           (org-reveal)))

       <span style="color: #b22222;">;; </span><span style="color: #b22222;">C-x C-/</span>
       (add-hook 'session-after-jump-to-last-change-hook
                 #'my-maybe-reveal))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org00948d2" class="outline-3">
<h3 id="org00948d2"><span class="section-number-3">8.18</span> [wakatime-mode.el] WakaTime を利用して作業記録する</h3>
<div class="outline-text-3" id="text-8-18">
<ol class="org-ol">
<li><a href="https://www.wakati.me/">https://www.wakati.me/</a>（API発行とログGUI表示）<br /></li>
<li><a href="https://github.com/wakatime/wakatime">https://github.com/wakatime/wakatime</a>（ログ記録用スクリプト）<br /></li>
<li><a href="https://github.com/nyuhuhuu/wakatime-mode">https://github.com/nyuhuhuu/wakatime-mode</a>（Emacs用プラグイン）<br /></li>
</ol>

<p>
利用開始前に，ログ表示サイトでルールをカスタマイズしておくとよい．例えば，拡張子が <code>.org</code> なファイルの場合，言語設定を <code>Text</code> にする，という具合に．すると，グラフ表示がわかりやすくなる．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">wakatime-mode</span> nil t)
  (<span style="color: #a020f0;">setq</span> wakatime-api-key <span style="color: #8b2252;">"&lt;insert your own api key&gt;"</span>)
  (<span style="color: #a020f0;">setq</span> wakatime-cli-path <span style="color: #8b2252;">"/Users/taka/Dropbox/emacs.d/bin/wakatime-cli.py"</span>)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12377;&#12409;&#12390;&#12398;&#12496;&#12483;&#12501;&#12449;&#12391;&#35370;&#21839;&#26178;&#12395;&#35352;&#37682;&#12434;&#38283;&#22987;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(global-wakatime-mode)</span>
    )
</pre>
</div>
</div>
</div>

<div id="outline-container-org6ed28d7" class="outline-3">
<h3 id="org6ed28d7"><span class="section-number-3">8.19</span> [neotree.el] ディレクトリ情報をツリー表示</h3>
<div class="outline-text-3" id="text-8-19">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(neotree neotree-toggle)
       <span style="color: #8b2252;">"neotree"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-c n"</span>) #'neotree-toggle))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"neotree"</span>
    (custom-set-variables
     '(neo-show-hidden-files t)
     '(neo-theme 'arrow)
     '(neo-smart-open t))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq neo-window-position 'right)</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq neo-vc-integration '(face char)) ;; Itls heavy at 2017-08-31</span>
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">all-the-icons-dired</span> nil t)
      (<span style="color: #a020f0;">setq</span> neo-theme (<span style="color: #a020f0;">if</span> (display-graphic-p) 'icons 'arrow)))
    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-neo-frame-width-single</span> 80)
    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-neo-frame-width-double</span> my-neo-frame-width-single)
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">moom</span> nil t)
      (<span style="color: #a020f0;">setq</span> my-neo-frame-width-single moom-frame-width-single)
      (<span style="color: #a020f0;">setq</span> my-neo-frame-width-double moom-frame-width-double))
    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-neo-adjusted-window-width</span> (+ 3 neo-window-width))
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:neotree-show</span> ()
      <span style="color: #8b2252;">"Extension to support change frame width when opening neotree."</span>
      (<span style="color: #a020f0;">unless</span> (neo-global--window-exists-p)
        (set-frame-width (selected-frame)
                         (+ (frame-width) my-neo-adjusted-window-width))
        <span style="color: #b22222;">;; </span><span style="color: #b22222;">override</span>
        (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">moom</span> nil t)
          (<span style="color: #a020f0;">setq</span> moom-frame-width-single
                (+ my-neo-frame-width-single my-neo-adjusted-window-width))
          (<span style="color: #a020f0;">setq</span> moom-frame-width-double
                (+ my-neo-frame-width-double my-neo-adjusted-window-width)))))
    (advice-add 'neotree-show <span style="color: #483d8b;">:before</span> #'advice:neotree-show)
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:neotree-hide</span> ()
      <span style="color: #8b2252;">"Extension to support change frame width when closing neotree."</span>
      (<span style="color: #a020f0;">when</span> (neo-global--window-exists-p)
        (set-frame-width (selected-frame)
                         (- (frame-width) my-neo-adjusted-window-width))
        <span style="color: #b22222;">;; </span><span style="color: #b22222;">restore</span>
        (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">moom</span> nil t)
          (<span style="color: #a020f0;">setq</span> moom-frame-width-single my-neo-frame-width-single)
          (<span style="color: #a020f0;">setq</span> moom-frame-width-double my-neo-frame-width-double)))
      (<span style="color: #a020f0;">when</span> (&gt; my-neo-frame-width-single (frame-width))
        (set-frame-width (selected-frame) my-neo-frame-width-single)))
    (advice-add 'neotree-hide <span style="color: #483d8b;">:before</span> #'advice:neotree-hide)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orge5e5150" class="outline-3">
<h3 id="orge5e5150"><span class="section-number-3">8.20</span> [osx-trash] system-move-file-to-trash を有効にする</h3>
<div class="outline-text-3" id="text-8-20">
<p>
<a href="https://github.com/lunaryorn/osx-trash.el">osx-trash</a> は，OSXで <code>system-move-file-to-trash</code> を使えるようにする．単独で使うのはあまり考えられないので，読み込みを <code>dired</code> に紐付けます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"dired"</span>
  (<span style="color: #a020f0;">setq</span> dired-use-ls-dired nil)
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">osx-trash</span> nil t)
    (<span style="color: #a020f0;">setq</span> delete-by-moving-to-trash t)
    (osx-trash-setup)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd1156cd" class="outline-3">
<h3 id="orgd1156cd"><span class="section-number-3">8.21</span> [helpful.el] リッチなヘルプページ</h3>
<div class="outline-text-3" id="text-8-21">
<p>
ヘルプの内容を見やすく構造化して表示してくれます．関数や変数のヘルプだけでなく，キーやマクロなども見やすく表示してくれます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(helpful-key helpful-function helpful-variable)
       <span style="color: #8b2252;">"helpful"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-h k"</span>) 'helpful-key)
    (global-set-key (kbd <span style="color: #8b2252;">"C-h f"</span>) 'helpful-function)
    (global-set-key (kbd <span style="color: #8b2252;">"C-h m"</span>) 'helpful-macro)
    (global-set-key (kbd <span style="color: #8b2252;">"C-h v"</span>) 'helpful-variable)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org05536d8" class="outline-3">
<h3 id="org05536d8"><span class="section-number-3">8.22</span> [keyfreq.el] コマンドログ</h3>
<div class="outline-text-3" id="text-8-22">
<p>
発行しているコマンドの使用頻度を記録し確認できます．デフォルトで， <code>~/.emacs.keyfreq</code> に情報が記録されます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(keyfreq-mode keyfreq-autosave-mode advice:keyfreq-show)
       <span style="color: #8b2252;">"keyfreq"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"keyfreq"</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:keyfreq-show</span> ()
      <span style="color: #8b2252;">"Extension to make the buffer view-only."</span>
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">if</span> shutup-p
          (<span style="color: #a020f0;">shut-up</span> (view-buffer keyfreq-buffer))
        (view-buffer keyfreq-buffer)))
    (advice-add 'keyfreq-show <span style="color: #483d8b;">:after</span> #'advice:keyfreq-show)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(define-key keyfreq-mode-map (kbd "q")</span>
    <span style="color: #b22222;">;;   </span><span style="color: #b22222;">#'(lambda () (interactive)</span>
    <span style="color: #b22222;">;;       </span><span style="color: #b22222;">(when (string= (buffer-name) keyfreq-buffer)</span>
    <span style="color: #b22222;">;;         </span><span style="color: #b22222;">(kill-buffer-and-window))))</span>
    (<span style="color: #a020f0;">setq</span> keyfreq-file
          (expand-file-name <span style="color: #8b2252;">"~/Dropbox/emacs.d/.keyfreq"</span>))
    (keyfreq-autosave-mode 1))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"keyfreq-mode"</span>)
      (keyfreq-mode 1))))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org2fef066" class="outline-2">
<h2 id="org2fef066"><span class="section-number-2">9</span> 開発サポート</h2>
<div class="outline-text-2" id="text-9">
</div>
<div id="outline-container-orgac548d2" class="outline-3">
<h3 id="orgac548d2"><span class="section-number-3">9.1</span> 便利キーバインド</h3>
<div class="outline-text-3" id="text-9-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (global-set-key (kbd <span style="color: #8b2252;">"C-;"</span>) 'comment-dwim) <span style="color: #b22222;">;; </span><span style="color: #b22222;">M-; is the defualt</span>
  (global-set-key (kbd <span style="color: #8b2252;">"C-c c"</span>) 'compile))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3728fb1" class="outline-3">
<h3 id="org3728fb1"><span class="section-number-3">9.2</span> [gist.el] Gist インターフェイス</h3>
<div class="outline-text-3" id="text-9-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(autoload-if-found '(gist) <span style="color: #8b2252;">"gist"</span> nil t)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb9f7ee2" class="outline-3">
<h3 id="orgb9f7ee2"><span class="section-number-3">9.3</span> [doxymacs.el] Doxygen のコメントを簡単に入力する</h3>
<div class="outline-text-3" id="text-9-3">
<ul class="org-ul">
<li><a href="http://doxymacs.sourceforge.net/">http://doxymacs.sourceforge.net/</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(doxymacs-mode)
       <span style="color: #8b2252;">"doxymacs"</span> nil t)

  (add-hook 'c-mode-common-hook #'doxymacs-mode)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"doxymacs"</span>
    (<span style="color: #a020f0;">setq</span> doxymacs-doxygen-style <span style="color: #8b2252;">"JavaDoc"</span>)
    (add-hook 'font-lock-mode-hook
              #'(lambda ()
                  (<span style="color: #a020f0;">when</span> (memq major-mode '(c-mode c++-mode))
                    (doxymacs-font-lock))))
    (define-key doxymacs-mode-map (kbd <span style="color: #8b2252;">"C-c C-s"</span>) 'ff-find-other-file)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgce46084" class="outline-3">
<h3 id="orgce46084"><span class="section-number-3">9.4</span> [matlab.el] Matlab用の設定&#xa0;&#xa0;&#xa0;<span class="tag"><span class="Mac">Mac</span></span></h3>
<div class="outline-text-3" id="text-9-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (memq window-system '(mac ns))
           (&gt; emacs-major-version 23))
  (<span style="color: #a020f0;">when</span> (autoload-if-found
         '(matlab-mode matlab-shell)
         <span style="color: #8b2252;">"matlab"</span> nil t)
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.m$"</span> . matlab-mode) auto-mode-alist)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf8e440c" class="outline-3">
<h3 id="orgf8e440c"><span class="section-number-3">9.5</span> [flycheck.el] 構文エラー表示</h3>
<div class="outline-text-3" id="text-9-5">
<ul class="org-ul">
<li>auto-complete より前に hook設定しておくと余計なエラーが出ないようです．<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(flycheck-mode)
       <span style="color: #8b2252;">"flycheck"</span> nil t)

  (<span style="color: #a020f0;">dolist</span> (hook
           '(js2-mode-hook c-mode-common-hook perl-mode-hook python-mode-hook))
    (add-hook hook #'flycheck-mode))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"flycheck"</span>
    (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">helm-flycheck</span> nil t)
    (<span style="color: #a020f0;">setq</span> flycheck-gcc-language-standard <span style="color: #8b2252;">"c++14"</span>)
    (<span style="color: #a020f0;">setq</span> flycheck-clang-language-standard <span style="color: #8b2252;">"c++14"</span>)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">TODO: really needed?</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(when (require 'flycheck-clang-tidy nil t)</span>
    <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(add-hook 'flycheck-mode-hook #'flycheck-clang-tidy-setup))</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">http://qiita.com/senda-akiha/items/cddb02cfdbc0c8c7bc2b</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(when (require 'flycheck-pos-tip nil t)</span>
    <span style="color: #b22222;">;;   </span><span style="color: #b22222;">'(custom-set-variables</span>
    <span style="color: #b22222;">;;     </span><span style="color: #b22222;">'(flycheck-display-errors-function</span>
    <span style="color: #b22222;">;;       </span><span style="color: #b22222;">#'flycheck-pos-tip-error-messages)))</span>
    ))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">(flycheck-add-next-checker 'javascript-jshint</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">'javascript-gjslint)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org323998b" class="outline-3">
<h3 id="org323998b"><span class="section-number-3">9.6</span> [auto-complete.el] 自動補完機能</h3>
<div class="outline-text-3" id="text-9-6">
<p>
<a href="http://cx4a.org/software/auto-complete/manual.ja.html">http://cx4a.org/software/auto-complete/manual.ja.html</a><br />
</p>

<ul class="org-ul">
<li>辞書データを使う（ <code>ac-dictionary-directories</code> ）<br /></li>
<li>auto-complete.el, auto-complete-config.el, fuzzy.el, popup.el を使う．<br /></li>
<li><a href="http://cx4a.org/software/auto-complete/manual.ja.html">日本語マニュアル</a><br /></li>
<li>ac-auto-start を 4 にしておけば，3文字までは TAB を yasnippet に渡せる．<br /></li>
</ul>

<p>
Org-mode ユーザにとって <code>TAB</code> は非常に重要なコマンド．そこに <code>auto-complete</code> と <code>yasnippet</code> が <code>TAB</code> を奪いに来るので，住み分けが重要になる．=ac-auto-start= を=4=にすると，&lt;s=TAB= によるソースブロックの短縮入力を <code>yasnippet</code> で実行できる（この目的だけならば=3=を指定してもいい）．&lt;sys などと4文字入力すると，=auto-complete= が動いて &lt;system&gt; などを補完してくれる．もちろん，見出しで <code>TAB</code> を押すときには，ツリーの表示／非表示の切り替えになる．<br />
</p>

<p>
情報源については，<a href="http://cx4a.org/software/auto-complete/manual.ja.html#.E6.A8.99.E6.BA.96.E6.83.85.E5.A0.B1.E6.BA.90">オンラインマニュアル</a>を参照のこと．<br />
</p>

<p>
auto-complete が正しく効いているかは，バッファ内で適当にパスを打ち込んで，補完候補が表示されるかで判定判定できると思います（ <code>/home</code> を入力とか）<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(ac-default-setup ac-org-mode-setup)
       <span style="color: #8b2252;">"auto-complete"</span> nil t)

  (<span style="color: #a020f0;">dolist</span> (hook
           (list 'org-mode-hook 'python-mode-hook
                 'perl-mode-hook 'objc-mode-hook))
    (add-hook hook #'ac-default-setup))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">*scratch* &#12496;&#12483;&#12501;&#12449;&#12391;&#12399;&#28961;&#21177;&#21270;</span>
  (add-hook 'lisp-mode-hook
            #'(lambda () (<span style="color: #a020f0;">unless</span> (equal <span style="color: #8b2252;">"*scratch*"</span> (buffer-name))
                           (ac-default-setup))))
  (add-hook 'org-mode-hook #'ac-org-mode-setup)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"auto-complete"</span>
    (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">auto-complete-config</span> nil t)
    (ac-config-default)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#36861;&#21152;&#12398;&#12513;&#12472;&#12515;&#12540;&#12514;&#12540;&#12489;&#12434;&#35373;&#23450;</span>
    (add-to-list 'ac-modes 'objc-mode)
    (add-to-list 'ac-modes 'org-mode)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">ac-modes &#12395;&#12354;&#12427;&#12513;&#12472;&#12515;&#12540;&#12514;&#12540;&#12489;&#12391;&#26377;&#21177;&#12395;&#12377;&#12427;</span>
    <span style="color: #b22222;">;;</span><span style="color: #b22222;">lisp, c, c++, java, perl, cperl, python, makefile, sh, fortran, f90</span>
    (global-auto-complete-mode t)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#36766;&#26360;</span>
    (add-to-list 'ac-dictionary-directories <span style="color: #8b2252;">"~/.emacs.d/ac-dict"</span>)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">history</span>
    (<span style="color: #a020f0;">setq</span> ac-comphist-file <span style="color: #8b2252;">"~/Dropbox/config/ac-comphist.dat"</span>)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">n&#25991;&#23383;&#20197;&#19978;&#12391;&#35036;&#23436;&#34920;&#31034;&#12377;&#12427;&#65288;"&lt;s TAB" &#12398;&#22580;&#21512; yasnippet &#12364;&#21628;&#12400;&#12428;&#12427;&#65289;</span>
    (<span style="color: #a020f0;">setq</span> ac-auto-start 4)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">n&#31186;&#24460;&#12395;&#12513;&#12491;&#12517;&#12540;&#12434;&#34920;&#31034;</span>
    (<span style="color: #a020f0;">setq</span> ac-auto-show-menu 2.0)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12484;&#12540;&#12523;&#12481;&#12483;&#12503;&#12398;&#34920;&#31034;</span>
    (<span style="color: #a020f0;">setq</span> ac-use-quick-help t)
    (<span style="color: #a020f0;">setq</span> ac-quick-help-delay 2.0)
    (<span style="color: #a020f0;">setq</span> ac-quick-help-height 10)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">C-n/C-p &#12391;&#12513;&#12491;&#12517;&#12540;&#12434;&#12383;&#12393;&#12427;</span>
    (<span style="color: #a020f0;">setq</span> ac-use-menu-map t)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">TAB &#12391;&#35036;&#23436;&#65288;org-mode &#12391;&#12418;&#21177;&#12367;&#12424;&#12358;&#12395;&#12377;&#12427;&#65289;</span>
    (define-key ac-completing-map [tab] 'ac-complete)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">RET &#12391;&#12398;&#35036;&#23436;&#12434;&#31105;&#27490;</span>
    (define-key ac-completing-map <span style="color: #8b2252;">"\r"</span> nil)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35036;&#23436;&#12513;&#12491;&#12517;&#12540;&#12398;&#34920;&#31034;&#31934;&#24230;&#12434;&#39640;&#12417;&#12427;</span>
    (<span style="color: #a020f0;">setq</span> popup-use-optimized-column-computation nil)
    <span style="color: #b22222;">;;</span><span style="color: #b22222;">(setq ac-candidate-max 10)</span>

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">ac-org-mode-setup</span> ()
      <span style="color: #b22222;">;;            </span><span style="color: #b22222;">(message " &gt;&gt; ac-org-mode-setup")</span>
      (<span style="color: #a020f0;">setq</span> ac-sources '(
                         ac-source-abbrev <span style="color: #b22222;">; </span><span style="color: #b22222;">Emacs &#12398;&#30053;&#35486;</span>
                                   <span style="color: #b22222;">;;; </span><span style="color: #b22222;">ac-source-css-property ; heavy</span>
                         ac-source-dictionary <span style="color: #b22222;">; </span><span style="color: #b22222;">&#36766;&#26360;</span>
                         ac-source-features
                         ac-source-filename
                         ac-source-files-in-current-dir
                         ac-source-functions
                                   <span style="color: #b22222;">;;; </span><span style="color: #b22222;">ac-source-gtags</span>
                                   <span style="color: #b22222;">;;; </span><span style="color: #b22222;">ac-source-imenu</span>
                                   <span style="color: #b22222;">;;; </span><span style="color: #b22222;">ac-source-semantic</span>
                         ac-source-symbols
                         ac-source-variables
                                   <span style="color: #b22222;">;;; </span><span style="color: #b22222;">ac-source-yasnippet</span>
                         )))

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">ac-default-setup</span> ()
      <span style="color: #b22222;">;;            </span><span style="color: #b22222;">(message " &gt;&gt; ac-default-setup")</span>
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">ac-source-words-in-same-mode-buffers</span>
      (<span style="color: #a020f0;">setq</span> ac-sources '(ac-source-filename
                         ac-source-abbrev
                         ac-source-dictionary
                         )))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5eeafdf" class="outline-3">
<h3 id="org5eeafdf"><span class="section-number-3">9.7</span> [auto-complete-clang.el] オムニ補完</h3>
<div class="outline-text-3" id="text-9-7">
<p>
C++バッファでメソッドを補完対象とする．try-catch を使っている場合， <code>-fcxx-exceptions</code> オプションが必要で，これはプリコンパイルヘッダを生成する時も同じだ．ここ示す設定では， <code>~/.emacs.d/</code> 以下に <code>stdafx.pch</code> を生成する必要があり，以下のコマンドを用いてプリコンパイルヘッダを生成する．ヘッダファイルのパスを適切に与えれば，Boostや自作のライブラリも補完対象に設定できる．<br />
</p>

<p>
現状では，補完直後にデフォルトの引数がすべて書き込まれてしまう．なんかうまいことしたいものだ．<br />
</p>

<div class="org-src-container">
<pre class="src src-sh">clang -cc1 -x c++-header -fcxx-exceptions -std=c++14 -stdlib=libstdc++ -emit-pch ~/.emacs.d/stdafx.h -o ~/.emacs.d/stdafx.pch -I/opt/local/include -I/opt/local/include/netpbm -I/Users/taka/devel/icp/lib
</pre>
</div>

<p>
以下の設定は，先に <code>auto-complete.el</code> に関する設定を読み込んでいることを前提としている．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(auto-complete ac-cc-mode-setup)
       <span style="color: #8b2252;">"auto-complete"</span> nil t)

  (add-hook 'c-mode-common-hook #'ac-cc-mode-setup)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"auto-complete"</span>
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">auto-complete-clang</span> nil t)
      (<span style="color: #a020f0;">setq</span> ac-clang-executable (executable-find <span style="color: #8b2252;">"clang"</span>))
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">ac-cc-mode-setup &#12398;&#12458;&#12540;&#12496;&#12540;&#12521;&#12452;&#12489;</span>
      (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">ac-cc-mode-setup</span> ()
        (<span style="color: #a020f0;">setq</span> ac-clang-prefix-header <span style="color: #8b2252;">"~/.emacs.d/stdafx.pch"</span>)
        (<span style="color: #a020f0;">setq</span> ac-clang-flags '(<span style="color: #8b2252;">"-std=c++14"</span> <span style="color: #8b2252;">"-w"</span> <span style="color: #8b2252;">"-ferror-limit"</span> <span style="color: #8b2252;">"1"</span>
                               <span style="color: #8b2252;">"-fcxx-exceptions"</span>))
        (<span style="color: #a020f0;">setq</span> ac-sources '(ac-source-clang
                           ac-source-yasnippet
                           ac-source-gtags))))))
</pre>
</div>

<p>
次のコードを hoge.cpp として保存し， <code>v</code> と <code>t</code> について補完できれば， <code>STL</code> と <code>Boost</code> のプリコンパイルヘッダが有効になっていることを確認できる．<br />
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span style="color: #483d8b;">#include</span> <span style="color: #8b2252;">&lt;iostream&gt;</span>
<span style="color: #483d8b;">#include</span> <span style="color: #8b2252;">&lt;vector&gt;</span>
<span style="color: #483d8b;">#include</span> <span style="color: #8b2252;">&lt;boost/timer.hpp&gt;</span>

<span style="color: #228b22;">int</span> <span style="color: #0000ff;">main</span>(){
  <span style="color: #008b8b;">std</span>::<span style="color: #228b22;">vector</span>&lt;<span style="color: #228b22;">int</span>&gt; <span style="color: #a0522d;">v</span>;
  v; <span style="color: #b22222;">// </span><span style="color: #b22222;">&#12371;&#12371;</span>
  <span style="color: #008b8b;">boost</span>::<span style="color: #228b22;">timer</span> <span style="color: #a0522d;">t</span>;
  cout &lt;&lt; t; <span style="color: #b22222;">// </span><span style="color: #b22222;">&#12371;&#12371;</span>
  <span style="color: #a020f0;">return</span> 1;
}
</pre>
</div>
</div>

<div id="outline-container-org99c466d" class="outline-4">
<h4 id="org99c466d"><span class="section-number-4">9.7.1</span> References</h4>
<div class="outline-text-4" id="text-9-7-1">
<ul class="org-ul">
<li><a href="http://d.hatena.ne.jp/kenbell1988/20120428/1335609313">http://d.hatena.ne.jp/kenbell1988/20120428/1335609313</a><br /></li>
<li><a href="http://d.hatena.ne.jp/whitypig/20110306/1299416655">http://d.hatena.ne.jp/whitypig/20110306/1299416655</a><br /></li>
<li><a href="http://d.hatena.ne.jp/yano-htn/?of=30">http://d.hatena.ne.jp/yano-htn/?of=30</a><br /></li>
<li><a href="http://www.nomtats.com/2010/11/auto-completeelemacs.html">http://www.nomtats.com/2010/11/auto-completeelemacs.html</a><br /></li>
<li><a href="http://www.plugmasters.com.br/plugfeed/post/73768/awesome-cc-autocompletion-in-emacs">http://www.plugmasters.com.br/plugfeed/post/73768/awesome-cc-autocompletion-in-emacs</a><br /></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org1488cec" class="outline-3">
<h3 id="org1488cec"><span class="section-number-3">9.8</span> [hideshowvis.el] 関数の表示／非表示</h3>
<div class="outline-text-3" id="text-9-8">
<ul class="org-ul">
<li><a href="http://www.emacswiki.org/emacs/hideshowvis.el">http://www.emacswiki.org/emacs/hideshowvis.el</a><br /></li>
<li>org.el（約2万行）を開くために約2分必要なため，最近は使っていません．<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (memq window-system '(mac ns))
           (&gt; emacs-major-version 23))
  (<span style="color: #a020f0;">when</span> (autoload-if-found
         '(hideshowvis-enable hideshowvis-minor-mode)
         <span style="color: #8b2252;">"hideshowvis"</span> nil t)

    (<span style="color: #a020f0;">dolist</span> (hook (list 'perl-mode-hook 'c-mode-common-hook))
      (add-hook hook #'hideshowvis-enable))

    (add-hook 'emacs-lisp-mode-hook
              #'(lambda () (<span style="color: #a020f0;">unless</span> (equal <span style="color: #8b2252;">"*scratch*"</span> (buffer-name))
                             (hideshowvis-enable))))

    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"hideshowvis"</span>
      (define-key hideshowvis-mode-map (kbd <span style="color: #8b2252;">"C-("</span>) 'hs-hide-block)
      (define-key hideshowvis-mode-map (kbd <span style="color: #8b2252;">"C-)"</span>) 'hs-show-block))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org1da8027" class="outline-3">
<h3 id="org1da8027"><span class="section-number-3">9.9</span> [origami.el] 関数の折りたたみ</h3>
<div class="outline-text-3" id="text-9-9">
<ul class="org-ul">
<li><code>hideshowvis.el</code> よりも軽い印象なので，現在は <code>origami.el</code> を使用中．<br /></li>
<li><a href="https://github.com/gregsexton/origami.el">gregsexton/origami.el: A folding minor mode for Emacs</a><br /></li>
<li><a href="https://github.com/zenozeng/yafolding.el">zenozeng/yafolding.el: Yet another folding extension for Emacs</a><br /></li>
<li><a href="https://github.com/tj64/outline-magic/blob/master/outline-magic.el">outline-magic/outline-magic.el at master · tj64/outline-magic</a><br /></li>
<li>後発として <a href="https://github.com/tarsius/bicycle">bicycle.el</a> があります．<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(origami-mode origami-toggle-node)
       <span style="color: #8b2252;">"origami"</span> nil t)

  (<span style="color: #a020f0;">dolist</span> (hook '(emacs-lisp-mode-hook c-mode-common-hook yatex-mode-hook))
    (add-hook hook #'origami-mode))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"origami"</span>
    (define-key origami-mode-map (kbd <span style="color: #8b2252;">"C-t"</span>) #'origami-toggle-node)
    (define-key origami-mode-map (kbd <span style="color: #8b2252;">"C-u C-t"</span>)
      #'origami-toggle-all-nodes)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5692731" class="outline-3">
<h3 id="org5692731"><span class="section-number-3">9.10</span> [quickrun.el] お手軽ビルド</h3>
<div class="outline-text-3" id="text-9-10">
<p>
カレントバッファで編集中のソースコードをビルド・実行して，別バッファに結果を得ます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(quickrun)
       <span style="color: #8b2252;">"quickrun"</span> nil t)

  (add-hook 'c-mode-common-hook
            #'(lambda () (define-key c++-mode-map (kbd <span style="color: #8b2252;">"&lt;f5&gt;"</span>) 'quickrun)))
  (add-hook 'python-mode-hook
            #'(lambda () (define-key python-mode-map (kbd <span style="color: #8b2252;">"&lt;f5&gt;"</span>) 'quickrun)))
  (add-hook 'perl-mode-hook
            #'(lambda () (define-key perl-mode-map (kbd <span style="color: #8b2252;">"&lt;f5&gt;"</span>) 'quickrun)))
  (add-hook 'gnuplot-mode-hook
            #'(lambda () (define-key gnuplot-mode-map (kbd <span style="color: #8b2252;">"&lt;f5&gt;"</span>) 'quickrun))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0c7b453" class="outline-3">
<h3 id="org0c7b453"><span class="section-number-3">9.11</span> [ggtags.el] タグジャンプ</h3>
<div class="outline-text-3" id="text-9-11">
<ul class="org-ul">
<li><a href="http://tasuwo.github.io/blog/2016/03/04/c-c-plus-plus/">EmacsにおけるC,C++の環境を整える - tasuwo blog</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">if</span> (not (executable-find <span style="color: #8b2252;">"gtags"</span>))
    (message <span style="color: #8b2252;">"--- gtags is NOT installed in this system."</span>)

  (<span style="color: #a020f0;">when</span> (autoload-if-found
         '(ggtags-mode)
         <span style="color: #8b2252;">"ggtags"</span> nil t)

    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"ggtags"</span>
      (<span style="color: #a020f0;">setq</span> ggtags-completing-read-function t)
      (define-key ggtags-mode-map (kbd <span style="color: #8b2252;">"M-]"</span>) nil))

    (<span style="color: #a020f0;">dolist</span> (hook (list 'c-mode-common-hook))
      (add-hook hook #'(lambda () (ggtags-mode 1)))))

  (<span style="color: #a020f0;">when</span> (autoload-if-found
         '(helm-gtags-mode)
         <span style="color: #8b2252;">"helm-gtags"</span> nil t)

    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"helm-gtags"</span>
      (custom-set-variables
       '(helm-gtags-mode-name <span style="color: #8b2252;">""</span>)))

    (add-hook 'c-mode-common-hook #'helm-gtags-mode)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbf8af0d" class="outline-3">
<h3 id="orgbf8af0d"><span class="section-number-3">9.12</span> [0xc] N進数変換</h3>
<div class="outline-text-3" id="text-9-12">
<ul class="org-ul">
<li>実施頻度の高い16進数と10進数の相互変換に重宝します．<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(0xc-convert 0xc-convert-point my-decimal-to-hex my-hex-to-decimal)
       <span style="color: #8b2252;">"0xc"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-c f h"</span>) '0xc-convert))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"0xc"</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-decimal-to-hex</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (0xc-convert 16 (word-at-point)))
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-hex-to-decimal</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (0xc-convert 10 (word-at-point)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7d3424e" class="outline-3">
<h3 id="org7d3424e"><span class="section-number-3">9.13</span> <span class="todo TODO">TODO</span> [EditorConfig] コードスタイルの強制</h3>
<div class="outline-text-3" id="text-9-13">
<ul class="org-ul">
<li><a href="http://editorconfig.org/#contributing">EditorConfig</a><br /></li>
<li><a href="https://github.com/editorconfig/editorconfig-emacs#readme">editorconfig/editorconfig-emacs: EditorConfig plugin for emacs</a><br /></li>
<li><a href="https://github.com/10sr/editorconfig-charset-extras-el">10sr/editorconfig-charset-extras-el: Extra EditorConfig Charset Support</a><br /></li>
</ul>

<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">if</span> (executable-find <span style="color: #8b2252;">"editorconfig"</span>)
      (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">editorconfig</span> nil t)
        (<span style="color: #a020f0;">unless</span> batch-build
          (postpone-message <span style="color: #8b2252;">"editorconfig"</span>)
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-to-list 'editorconfig-exclude-modes 'org-mode)</span>
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">(when (require 'editorconfig-charset-extras nil t)</span>
          <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(add-hook 'editorconfig-custom-hooks</span>
          <span style="color: #b22222;">;;             </span><span style="color: #b22222;">'editorconfig-charset-extras))</span>
          (editorconfig-mode 1)))
    (message <span style="color: #8b2252;">"editorconfig is NOT installed."</span>)))
</pre>
</div>

<p>
例えば，次のようなファイルを共有プロジェクトに保存しておきます． <code>.editorconfig</code> として配置します．<br />
</p>

<div class="org-src-container">
<pre class="src src-conf"><span style="color: #a0522d;">root</span> = true

[<span style="color: #228b22;">*</span>]
<span style="color: #a0522d;">charset</span> = utf-8
<span style="color: #a0522d;">end_of_line</span> = lf
<span style="color: #a0522d;">insert_final_newline</span> = true
<span style="color: #a0522d;">indent_style</span> = space
<span style="color: #a0522d;">indent_size</span> = 2
<span style="color: #a0522d;">trim_trailing_whitespace</span> = true
</pre>
</div>
</div>
</div>

<div id="outline-container-orga87c1c2" class="outline-3">
<h3 id="orga87c1c2"><span class="section-number-3">9.14</span> [uuid.el] UUID の生成</h3>
<div class="outline-text-3" id="text-9-14">
<ul class="org-ul">
<li><a href="https://github.com/nicferrier/emacs-uuid">nicferrier/emacs-uuid: The UUID module from the EmacsWiki, initially by someone called James Mastros.</a><br /></li>
</ul>

<p>
新しい <code>UUID</code> を生成してカーソル位置に書き出すように <code>my-uuid-string</code> を定義しています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(uuid-string my-uuid-string)
       <span style="color: #8b2252;">"uuid"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"uuid"</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-uuid-string</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (insert (uuid-string)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbd7da30" class="outline-3">
<h3 id="orgbd7da30"><span class="section-number-3">9.15</span> [hexl.el] バイナリファイルを開く</h3>
<div class="outline-text-3" id="text-9-15">
<p>
ビルトインの <code>hexl-mode</code> を使います．<br />
</p>

<ul class="org-ul">
<li><a href="https://ayatakesi.github.io/emacs/24.5/Editing-Binary-Files.html">GNU Emacs Manual(Japanese Translation): Editing Binary Files</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"hexl"</span>
  (custom-set-variables
   '(hexl-bits 8)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0246b99" class="outline-3">
<h3 id="org0246b99"><span class="section-number-3">9.16</span> [package-lint.el] MEPLA登録用Lint</h3>
<div class="outline-text-3" id="text-9-16">
<p>
MELPAへの登録を目指す emacslisp パッケージの実装で，所定の書式で記述されているかを確認できます．<br />
</p>

<ul class="org-ul">
<li><a href="https://github.com/purcell/package-lint">https://github.com/purcell/package-lint</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(autoload-if-found '(package-lint-current-buffer) <span style="color: #8b2252;">"package-lint"</span> nil t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org2b9fc39" class="outline-3">
<h3 id="org2b9fc39"><span class="section-number-3">9.17</span> <span class="todo TODO">TODO</span> [cov] カバレッジの状態をフリンジで確認</h3>
<div class="outline-text-3" id="text-9-17">
<p>
<code>gcov</code> の結果をフリンジに表示します．<br />
</p>

<ul class="org-ul">
<li><a href="https://github.com/adamniederer/cov">https://github.com/adamniederer/cov</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(autoload-if-found '(cov-mode) <span style="color: #8b2252;">"cov"</span> nil t)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd3c7d93" class="outline-3">
<h3 id="orgd3c7d93"><span class="section-number-3">9.18</span> <span class="todo TODO">TODO</span> [projectile.el] ディレクトリ単位でファイル群をプロジェクト扱いする</h3>
<div class="outline-text-3" id="text-9-18">
<ul class="org-ul">
<li>プロジェクト内に限定して検索をかける時に重宝する．<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(projectile-mode)
       <span style="color: #8b2252;">"projectile"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"projectile-mode"</span>)
      (<span style="color: #a020f0;">setq</span> projectile-keymap-prefix (kbd <span style="color: #8b2252;">"C-c p"</span>))
      (projectile-mode 1)))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"neotree"</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x helm-projectile-switch-project (C-c p p)</span>
    (<span style="color: #a020f0;">setq</span> projectile-switch-project-action 'neotree-projectile-action)

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:neotree-dir</span> (path)
      <span style="color: #8b2252;">"Extension to change the frame width automatically."</span>
      (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"DDirectory: "</span>)
      (<span style="color: #a020f0;">unless</span> (neo-global--window-exists-p)
        (neotree-show))
      (neo-global--open-dir path)
      (neo-global--select-window))
    (advice-add 'neotree-dir <span style="color: #483d8b;">:override</span> #'advice:neotree-dir))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"projectile"</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:projectile-visit-project-tags-table</span> ()
      <span style="color: #8b2252;">"Extensions to skip calling `</span><span style="color: #008b8b;">visit-tags-table</span><span style="color: #8b2252;">'."</span>
      nil)
    (advice-add 'projectile-visit-project-tags-table <span style="color: #483d8b;">:override</span>
                #'advice:projectile-visit-project-tags-table)

    (<span style="color: #a020f0;">setq</span> projectile-tags-command <span style="color: #8b2252;">"gtags"</span>)
    (<span style="color: #a020f0;">setq</span> projectile-tags-backend 'ggtags)
    (<span style="color: #a020f0;">setq</span> projectile-tags-file-name <span style="color: #8b2252;">"GTAGS"</span>)

    (<span style="color: #a020f0;">setq</span> projectile-use-git-grep t)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq projectile-mode-line</span>
    <span style="color: #b22222;">;;       </span><span style="color: #b22222;">'(:eval (format " P:%s" (projectile-project-name))))</span>
    (<span style="color: #a020f0;">setq</span> projectile-mode-line <span style="color: #8b2252;">""</span>)

    (<span style="color: #a020f0;">setq</span> icon-title-format
          (<span style="color: #a020f0;">setq</span> frame-title-format
                '((<span style="color: #483d8b;">:eval</span>
                   (<span style="color: #a020f0;">let</span> ((project-name (projectile-project-name)))
                     (<span style="color: #a020f0;">unless</span> (string= <span style="color: #8b2252;">"-"</span> project-name)
                       (format <span style="color: #8b2252;">"(%s) - "</span> project-name))))
                  <span style="color: #8b2252;">"%b"</span>)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org2206b51" class="outline-3">
<h3 id="org2206b51"><span class="section-number-3">9.19</span> <span class="todo TODO">TODO</span> [magit.el] Gitクライアント</h3>
<div class="outline-text-3" id="text-9-19">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(magit-status)
       <span style="color: #8b2252;">"magit"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-c m"</span>) 'magit-status)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7f080d4" class="outline-3">
<h3 id="org7f080d4"><span class="section-number-3">9.20</span> <span class="todo TODO">TODO</span> [format-all.el] コード整形</h3>
<div class="outline-text-3" id="text-9-20">
<ul class="org-ul">
<li><a href="https://melpa.org/#/format-all">format-all - MELPA</a><br /></li>
</ul>

<p>
様々なプログラミング言語に対して，共通のコード整形のトリガー（ <code>M-x format-all-buffer</code> ）を提供します．整形するために使うフォーマッタは，原則的に言語ごとに異なる外部ツールを呼び出すので，必要に応じてそれらのツールのインストールが別途必要です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">format-all</span> nil t))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org2fca60c" class="outline-2">
<h2 id="org2fca60c"><span class="section-number-2">10</span> Org Mode</h2>
<div class="outline-text-2" id="text-10">
</div>
<div id="outline-container-org065390f" class="outline-3">
<h3 id="org065390f"><span class="section-number-3">10.1</span> 基本設定</h3>
<div class="outline-text-3" id="text-10-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(org-mode)
       <span style="color: #8b2252;">"org"</span> <span style="color: #8b2252;">"Org Mode"</span> t)

  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"\\.txt$"</span> . org-mode) auto-mode-alist)
  (global-set-key (kbd <span style="color: #8b2252;">"C-M-o"</span>)
                  #'(lambda () (<span style="color: #a020f0;">interactive</span>)
                      (show-org-buffer <span style="color: #8b2252;">"next.org"</span>)))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-c l"</span>) 'org-store-link)
    (global-set-key (kbd <span style="color: #8b2252;">"C-c a"</span>) 'org-agenda)
    (global-set-key (kbd <span style="color: #8b2252;">"C-c r"</span>) 'org-capture)
    (global-set-key (kbd <span style="color: #8b2252;">"C-M-c"</span>)
                    #'(lambda () (<span style="color: #a020f0;">interactive</span>)
                        (show-org-buffer <span style="color: #8b2252;">"org-ical.org"</span>))))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
    (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-habit</span> nil t)
    (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-mobile</span> nil t)
    (add-to-list 'org-modules 'org-id)
    (add-to-list 'org-modules 'ox-odt)
    (<span style="color: #a020f0;">when</span> (version&lt; <span style="color: #8b2252;">"9.1.4"</span> (org-version))
      (add-to-list 'org-modules 'org-tempo))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">C-c &amp; &#12364; yasnippet &#12395;&#12458;&#12540;&#12496;&#12540;&#12521;&#12452;&#12489;&#12373;&#12428;&#12390;&#12356;&#12427;&#12398;&#12434;&#24373;&#12426;&#26367;&#12360;&#12427;</span>
    (define-key org-mode-map (kbd <span style="color: #8b2252;">"C-c 4"</span>) 'org-mark-ring-goto)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Set checksum program path for windows</span>
    (<span style="color: #a020f0;">when</span> (eq window-system 'w32)
      (<span style="color: #a020f0;">setq</span> org-mobile-checksum-binary <span style="color: #8b2252;">"~/Dropbox/do/cksum.exe"</span>))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">org &#12501;&#12449;&#12452;&#12523;&#12398;&#38598;&#20013;&#31649;&#29702;</span>
    (<span style="color: #a020f0;">setq</span> org-directory <span style="color: #8b2252;">"~/Dropbox/org/"</span>)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Set default table export format</span>
    (<span style="color: #a020f0;">setq</span> org-table-export-default-format <span style="color: #8b2252;">"orgtbl-to-csv"</span>)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Toggle inline images display at startup</span>
    (<span style="color: #a020f0;">setq</span> org-startup-with-inline-images t)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">dvipng</span>
    (<span style="color: #a020f0;">setq</span> org-export-with-LaTeX-fragments t)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25968;&#24335;&#12434;&#12495;&#12452;&#12521;&#12452;&#12488;</span>
    (<span style="color: #a020f0;">setq</span> org-highlight-latex-and-related '(latex entities))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">org&#12496;&#12483;&#12501;&#12449;&#20869;&#12398;&#20840;&#12390;&#12398;&#21205;&#30340;&#12502;&#12525;&#12483;&#12463;&#12434;&#20445;&#23384;&#30452;&#21069;&#12395;&#22793;&#26356;&#12377;&#12427;</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-hook 'before-save-hook #'org-update-all-dblocks)</span>

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12450;&#12540;&#12459;&#12452;&#12502;&#12501;&#12449;&#12452;&#12523;&#12398;&#21517;&#31216;&#12434;&#25351;&#23450;</span>
    (<span style="color: #a020f0;">setq</span> org-archive-location <span style="color: #8b2252;">"%s_archive::"</span>)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12479;&#12452;&#12512;&#12473;&#12479;&#12531;&#12503;&#12395;&#12424;&#12427;&#12525;&#12464;&#21454;&#38598;&#35373;&#23450;</span>
    (<span style="color: #a020f0;">setq</span> org-log-done 'time) <span style="color: #b22222;">; </span><span style="color: #b22222;">'time &#12391;&#12399;&#12394;&#12367;&#65292;'(done), '(state) &#12434;&#25351;&#23450;&#12391;&#12365;&#12427;</span>

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12525;&#12464;&#12434;&#12489;&#12525;&#12450;&#12540;&#12395;&#20837;&#12428;&#12427;</span>
    (<span style="color: #a020f0;">setq</span> org-log-into-drawer t)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12450;&#12531;&#12480;&#12540;&#12473;&#12467;&#12450;&#12434;&#12456;&#12463;&#12473;&#12509;&#12540;&#12488;&#12375;&#12394;&#12356;&#65288;_{}&#12391;&#26126;&#31034;&#30340;&#12395;&#34920;&#29694;&#12391;&#12365;&#12427;&#65289;</span>
    (<span style="color: #a020f0;">setq</span> org-export-with-sub-superscripts nil)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">#+OPTIONS: \n:t &#12392;&#21516;&#12376;</span>
    (<span style="color: #a020f0;">setq</span> org-export-preserve-breaks t)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12479;&#12452;&#12510;&#12540;&#12398;&#38899;</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(lsetq org-clock-sound "");</span>

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">org-clock &#12398;&#35336;&#28204;&#26178;&#38291;&#12434;&#12514;&#12540;&#12489;&#12521;&#12452;&#12531;&#12391;&#12399;&#12394;&#12367;&#12479;&#12452;&#12488;&#12523;&#12395;&#34920;&#31034;&#12377;&#12427;</span>
    (<span style="color: #a020f0;">setq</span> org-clock-clocked-in-display 'frame-title)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">1&#20998;&#26410;&#28288;&#12399;&#35352;&#37682;&#12375;&#12394;&#12356;</span>
    (<span style="color: #a020f0;">setq</span> org-clock-out-remove-zero-time-clocks t)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">helm &#12434;&#31435;&#12385;&#19978;&#12370;&#12427;</span>
    (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">helm-config</span> nil t)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">org-eldoc &#12434;&#35501;&#12415;&#36796;&#12416;</span>
    (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-eldoc</span> nil t)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">emms &#12398;&#12522;&#12531;&#12463;&#12395;&#23550;&#24540;&#12373;&#12379;&#12427;</span>
    (<span style="color: #a020f0;">unless</span> batch-build
      (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-emms</span> nil t))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#38750;&#34920;&#31034;&#29366;&#24907;&#12398;&#38936;&#22495;&#12408;&#12398;&#26360;&#12365;&#36796;&#12415;&#12434;&#38450;&#12368;</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">"Editing in invisible areas is prohibited, make them visible first"</span>
    (<span style="color: #a020f0;">setq</span> org-catch-invisible-edits 'show-and-error)
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:org-return</span> (f <span style="color: #228b22;">&amp;optional</span> arg)
      <span style="color: #8b2252;">"An extension for checking invisible editing when you hit the enter."</span>
      (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"P"</span>)
      (org-check-before-invisible-edit 'insert)
      (apply f arg))
    (advice-add 'org-return <span style="color: #483d8b;">:around</span> #'advice:org-return)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">- &#12434;&#20778;&#20808;&#65294;&#35242;&#12398;&#12502;&#12522;&#12483;&#12484;&#34920;&#31034;&#12434;&#32153;&#25215;&#12373;&#12379;&#12394;&#12356;</span>
    (<span style="color: #a020f0;">setq</span> org-list-demote-modify-bullet
          '((<span style="color: #8b2252;">"+"</span> . <span style="color: #8b2252;">"-"</span>)
            (<span style="color: #8b2252;">"*"</span> . <span style="color: #8b2252;">"-"</span>)
            (<span style="color: #8b2252;">"1."</span> . <span style="color: #8b2252;">"-"</span>)
            (<span style="color: #8b2252;">"1)"</span> . <span style="color: #8b2252;">"-"</span>)
            (<span style="color: #8b2252;">"A)"</span> . <span style="color: #8b2252;">"-"</span>)
            (<span style="color: #8b2252;">"B)"</span> . <span style="color: #8b2252;">"-"</span>)
            (<span style="color: #8b2252;">"a)"</span> . <span style="color: #8b2252;">"-"</span>)
            (<span style="color: #8b2252;">"b)"</span> . <span style="color: #8b2252;">"-"</span>)
            (<span style="color: #8b2252;">"A."</span> . <span style="color: #8b2252;">"-"</span>)
            (<span style="color: #8b2252;">"B."</span> . <span style="color: #8b2252;">"-"</span>)
            (<span style="color: #8b2252;">"a."</span> . <span style="color: #8b2252;">"-"</span>)
            (<span style="color: #8b2252;">"b."</span> . <span style="color: #8b2252;">"-"</span>)))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#23436;&#20102;&#12375;&#12383;&#12479;&#12473;&#12463;&#12398;&#37197;&#33394;&#12434;&#22793;&#12360;&#12427;</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">https://fuco1.github.io/2017-05-25-Fontify-done-checkbox-items-in-org-mode.html</span>
    (font-lock-add-keywords
     'org-mode
     `((<span style="color: #8b2252;">"^[ \t]*</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">(?:</span><span style="color: #8b2252;">[-+*]</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">|</span><span style="color: #8b2252;">[0-9]+[).]</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">)</span><span style="color: #8b2252;">[ \t]+</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">(</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">(?:</span><span style="color: #8b2252;">\\[@</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">(?:</span><span style="color: #8b2252;">start:</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">)</span><span style="color: #8b2252;">?[0-9]+\\][ \t]*</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">)</span><span style="color: #8b2252;">?\\[</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">(?:</span><span style="color: #8b2252;">X</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">|</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">(</span><span style="color: #8b2252;">[0-9]+</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">)</span><span style="color: #8b2252;">/\\2</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">)</span><span style="color: #8b2252;">\\][</span><span style="color: #8b2252;">^</span><span style="color: #8b2252;">\n]*\n</span><span style="color: #66CC99;">\\</span><span style="color: #9966CC;">)</span><span style="color: #8b2252;">"</span>
        1 'org-headline-done prepend))
     'append)

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-do-org-update-staistics-cookies</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (message <span style="color: #8b2252;">"Update statistics ..."</span>)
      (do-org-update-statistics-cookies))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(org-transpose-element) &#12364;&#21106;&#12426;&#24403;&#12390;&#12425;&#12428;&#12390;&#12356;&#12427;&#12398;&#12391;&#21462;&#12426;&#36820;&#12377;&#65294;</span>
    (org-defkey org-mode-map <span style="color: #8b2252;">"\C-\M-t"</span> 'beginning-of-buffer)
    (define-key org-mode-map (kbd <span style="color: #8b2252;">"C-c f 2"</span>)
      'my-do-org-update-staistics-cookies))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org-clock"</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-org-clock-out-and-save-when-exit</span> ()
      <span style="color: #8b2252;">"Save buffers and stop clocking when kill emacs."</span>
      (<span style="color: #a020f0;">when</span> (org-clocking-p)
        (org-clock-out)
        (save-some-buffers t)))
    (add-hook 'kill-emacs-hook #'my-org-clock-out-and-save-when-exit)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0b8263d" class="outline-3">
<h3 id="org0b8263d"><span class="section-number-3">10.2</span> contribution を使う</h3>
<div class="outline-text-3" id="text-10-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">setq</span> load-path (append '(<span style="color: #8b2252;">"~/devel/git/org-mode/contrib/lisp"</span>) load-path))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb63a2d2" class="outline-3">
<h3 id="orgb63a2d2"><span class="section-number-3">10.3</span> iCal との連携</h3>
<div class="outline-text-3" id="text-10-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">~/Dropbox/Public &#12399;&#31532;&#19977;&#32773;&#12395;&#25506;&#32034;&#12373;&#12428;&#12427;&#21487;&#33021;&#24615;&#12364;&#12354;&#12427;&#12398;&#12391;&#35201;&#27880;&#24847;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">default = ~/org.ics</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">C-c C-e i org-export-icalendar-this-file</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">C-c C-e I org-export-icalendar-all-agenda-files</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">C-c C-e c org-export-icalendar-all-combine-agenda-files</span>
(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(my-ox-icalendar my-ox-icalendar-cleanup)
       <span style="color: #8b2252;">"ox-icalendar"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
    (define-key org-mode-map (kbd <span style="color: #8b2252;">"C-c f 1"</span>) 'my-ox-icalendar))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"ox-icalendar"</span>
    (<span style="color: #a020f0;">setq</span> org-icalendar-combined-agenda-file <span style="color: #8b2252;">"~/Desktop/org-ical.ics"</span>)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">iCal &#12398;&#35500;&#26126;&#25991;</span>
    (<span style="color: #a020f0;">setq</span> org-icalendar-combined-description <span style="color: #8b2252;">"OrgMode&#12398;&#12473;&#12465;&#12472;&#12517;&#12540;&#12523;&#20986;&#21147;"</span>)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12459;&#12524;&#12531;&#12480;&#12540;&#12395;&#36969;&#20999;&#12394;&#12479;&#12452;&#12512;&#12478;&#12540;&#12531;&#12434;&#35373;&#23450;&#12377;&#12427;&#65288;google &#29992;&#12395;&#12399; nil &#12364;&#24517;&#35201;&#65289;</span>
    (<span style="color: #a020f0;">setq</span> org-icalendar-timezone <span style="color: #8b2252;">"Asia/Tokyo"</span>)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">DONE &#12395;&#12394;&#12387;&#12383; TODO &#12399;&#12450;&#12472;&#12455;&#12531;&#12480;&#12363;&#12425;&#38500;&#22806;&#12377;&#12427;</span>
    (<span style="color: #a020f0;">setq</span> org-icalendar-include-todo t)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#65288;&#36890;&#24120;&#12399;&#65292;&lt;&gt;--&lt;&gt; &#12391;&#21306;&#38291;&#20184;&#12365;&#20104;&#23450;&#12434;&#12388;&#12367;&#12427;&#65294;&#38750;&#25913;&#34892;&#20837;&#21147;&#12391;&#26085;&#20184;&#12364;Note&#12395;&#20837;&#12425;&#12394;&#12356;&#65289;</span>
    (<span style="color: #a020f0;">setq</span> org-icalendar-use-scheduled '(event-if-todo))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">DL &#20184;&#12365;&#12391;&#32066;&#26085;&#20104;&#23450;&#12395;&#12377;&#12427;&#65306;&#32224;&#12417;&#20999;&#12426;&#26085;&#65288;&#12473;&#12479;&#12531;&#12503;&#12391;&#26178;&#38291;&#12434;&#25351;&#23450;&#12375;&#12394;&#12356;&#12371;&#12392;&#65289;</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq org-icalendar-use-deadline '(event-if-todo event-if-not-todo))</span>
    (<span style="color: #a020f0;">setq</span> org-icalendar-use-deadline '(event-if-todo))

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-ox-icalendar</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">let</span> ((message-log-max nil)
            (temp-agenda-files org-agenda-files))
        (<span style="color: #a020f0;">setq</span> org-agenda-files '(<span style="color: #8b2252;">"~/Dropbox/org/org-ical.org"</span>))
        <span style="color: #b22222;">;; </span><span style="color: #b22222;">org-icalendar-export-to-ics &#12434;&#20351;&#12358;&#12392;&#12463;&#12522;&#12483;&#12503;&#12508;&#12540;&#12489;&#12364;&#33618;&#12428;&#12427;</span>
        (org-icalendar-combine-agenda-files)
        (<span style="color: #a020f0;">setq</span> org-agenda-files temp-agenda-files)
        <span style="color: #b22222;">;; </span><span style="color: #b22222;">Dropbox/Public &#12398;&#12501;&#12457;&#12523;&#12480;&#12395;&#20844;&#38283;&#12377;&#12427;</span>
        <span style="color: #b22222;">;;           </span><span style="color: #b22222;">(shell-command</span>
        <span style="color: #b22222;">;;            </span><span style="color: #b22222;">(concat "cp " org-icalendar-combined-agenda-file " "</span>
        <span style="color: #b22222;">;;                    </span><span style="color: #b22222;">org-icalendar-dropbox-agenda-file))</span>
        (<span style="color: #a020f0;">if</span> (eq 0 (shell-command
                   (concat <span style="color: #8b2252;">"scp -o ConnectTimeout=5 "</span>
                           org-icalendar-combined-agenda-file <span style="color: #8b2252;">" "</span>
                           org-ical-file-in-orz-server)))
            (message <span style="color: #8b2252;">"Uploading... [DONE]"</span>)
          (message <span style="color: #8b2252;">"Uploading... [MISS]"</span>))
        (my-ox-icalendar-cleanup)))

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-ox-icalendar-cleanup</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">when</span> (file-exists-p
             (expand-file-name org-icalendar-combined-agenda-file))
        (shell-command-to-string
         (concat <span style="color: #8b2252;">"rm -rf "</span> org-icalendar-combined-agenda-file))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga382265" class="outline-3">
<h3 id="orga382265"><span class="section-number-3">10.4</span> スピードコマンド</h3>
<div class="outline-text-3" id="text-10-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  (<span style="color: #a020f0;">setq</span> org-use-speed-commands t)
  (add-to-list 'org-speed-commands-user '(<span style="color: #8b2252;">"d"</span> org-todo <span style="color: #8b2252;">"DONE"</span>))
  (add-to-list 'org-speed-commands-user '(<span style="color: #8b2252;">"D"</span> my-org-todo-complete-no-repeat <span style="color: #8b2252;">"DONE"</span>))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-to-list 'org-speed-commands-user '("N" org-shiftmetadown))</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-to-list 'org-speed-commands-user '("P" org-shiftmetaup))</span>
  (add-to-list 'org-speed-commands-user '(<span style="color: #8b2252;">"!"</span> my-org-set-created-property))
  (add-to-list 'org-speed-commands-user
               '(<span style="color: #8b2252;">"$"</span> call-interactively 'org-archive-subtree))

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-org-todo-complete-no-repeat</span> (<span style="color: #228b22;">&amp;optional</span> ARG)
    (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"P"</span>)
    (<span style="color: #a020f0;">when</span> (org-get-repeat)
      (org-cancel-repeater))
    (org-todo ARG)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgef5f93e" class="outline-3">
<h3 id="orgef5f93e"><span class="section-number-3">10.5</span> face 関連</h3>
<div class="outline-text-3" id="text-10-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Font lock &#12434;&#20351;&#12358;</span>
  (global-font-lock-mode 1)
  (add-hook 'org-mode-hook #'turn-on-font-lock)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12454;&#12451;&#12531;&#12489;&#12454;&#12398;&#31471;&#12391;&#25240;&#12426;&#36820;&#12377;</span>
  (<span style="color: #a020f0;">setq</span> org-startup-truncated nil)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12469;&#12502;&#12484;&#12522;&#12540;&#20197;&#19979;&#12398; * &#12434;&#30053;&#24335;&#34920;&#31034;&#12377;&#12427;</span>
  (<span style="color: #a020f0;">setq</span> org-hide-leading-stars t)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Color setting for TODO keywords</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Color for priorities</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq org-priority-faces</span>
  <span style="color: #b22222;">;;  </span><span style="color: #b22222;">'(("?A" :foreground "</span><span style="color: #ffffff; background-color: #E01B4C;">#E01B4C</span><span style="color: #b22222;">" :background "</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #b22222;">" :weight bold)</span>
  <span style="color: #b22222;">;;    </span><span style="color: #b22222;">("?B" :foreground "</span><span style="color: #ffffff; background-color: #1739BF;">#1739BF</span><span style="color: #b22222;">" :background "</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #b22222;">" :weight bold)</span>
  <span style="color: #b22222;">;;    </span><span style="color: #b22222;">("?C" :foreground "</span><span style="color: #ffffff; background-color: #575757;">#575757</span><span style="color: #b22222;">" :background "</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #b22222;">" :weight bold)))</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Color setting for Tags</span>

  <span style="color: #b22222;">;; </span><span style="color: #ffffff; background-color: #CC3333;">#CC3333</span>
  (<span style="color: #a020f0;">setq</span> org-todo-keyword-faces
        '((<span style="color: #8b2252;">"FOCUS"</span>    <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #FF0000;">#FF0000</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFCC66;">#FFCC66</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"BUG"</span>      <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #FF0000;">#FF0000</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFCC66;">#FFCC66</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"CHECK"</span>    <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FF9900;">#FF9900</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFF0F0;">#FFF0F0</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:underline</span> t)
          (<span style="color: #8b2252;">"ICAL"</span>     <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #33CC66;">#33CC66</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"APPROVED"</span> <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #66CC66;">#66CC66</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"QUESTION"</span> <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #FF0000;">#FF0000</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"WAIT"</span>     <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #CCCCCC;">#CCCCCC</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #666666;">#666666</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"MAIL"</span>     <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #CC3300;">#CC3300</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFEE99;">#FFEE99</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"PLAN"</span>     <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #FF6600;">#FF6600</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"PLAN2"</span>    <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #FF6600;">#FF6600</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"REV1"</span>     <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #3366FF;">#3366FF</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"REV2"</span>     <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #3366FF;">#3366FF</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #99CCFF;">#99CCFF</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"REV3"</span>     <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #3366FF;">#3366FF</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"SLEEP"</span>    <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #9999CC;">#9999CC</span><span style="color: #8b2252;">"</span>)))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(:foreground "</span><span style="color: #ffffff; background-color: #0000FF;">#0000FF</span><span style="color: #b22222;">" :bold t)     ; default. do NOT put this bottom</span>
  (<span style="color: #a020f0;">setq</span> org-tag-faces
        '((<span style="color: #8b2252;">"Achievement"</span> <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #66CC66;">#66CC66</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"Bug"</span>         <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #FF0000;">#FF0000</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"Report"</span>      <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #66CC66;">#66CC66</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"Background"</span>  <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #66CC99;">#66CC99</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"Chore"</span>       <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #6699CC;">#6699CC</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"Domestic"</span>    <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #6666CC;">#6666CC</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"BeMerged"</span>    <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #6666CC;">#6666CC</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"Doing"</span>       <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #FF0000;">#FF0000</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"Draft"</span>       <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #9933CC;">#9933CC</span><span style="color: #8b2252;">"</span>) <span style="color: #b22222;">;; </span><span style="color: #b22222;">Draft(r1,r2,r3)-&gt;Review(1,2)</span>
          (<span style="color: #8b2252;">"Review"</span>      <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #6633CC;">#6633CC</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"Revisit"</span>     <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #6633CC;">#6633CC</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"Redmine"</span>     <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #CC6666;">#CC6666</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"Ongoing"</span>     <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #CC6666;">#CC6666</span><span style="color: #8b2252;">"</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">for non scheduled/reminder</span>
          (<span style="color: #8b2252;">"Repeat"</span>      <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #CC9999;">#CC9999</span><span style="color: #8b2252;">"</span>) <span style="color: #b22222;">; </span><span style="color: #b22222;">for interval tasks</span>
          (<span style="color: #8b2252;">"Mag"</span>         <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #9966CC;">#9966CC</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"buy"</span>         <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #9966CC;">#9966CC</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"pay"</span>         <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #CC6699;">#CC6699</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"try"</span>         <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #FF3366;">#FF3366</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"secret"</span>      <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #FF0000;">#FF0000</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"emacs"</span>       <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #6633CC;">#6633CC</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"note"</span>        <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #6633CC;">#6633CC</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"print"</span>       <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #6633CC;">#6633CC</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"Study"</span>       <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #6666CC;">#6666CC</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"Implements"</span>  <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #CC9999;">#CC9999</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:weight</span> bold)
          (<span style="color: #8b2252;">"Coding"</span>      <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #CC9999;">#CC9999</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"Editing"</span>     <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #CC9999;">#CC9999</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:weight</span> bold)
          (<span style="color: #8b2252;">"work"</span>        <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #CC9999;">#CC9999</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:weight</span> bold)
          (<span style="color: #8b2252;">"Survey"</span>      <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #CC9999;">#CC9999</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:weight</span> bold)
          (<span style="color: #8b2252;">"Home"</span>        <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #CC9999;">#CC9999</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:weight</span> bold)
          (<span style="color: #8b2252;">"Open"</span>        <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #CC9999;">#CC9999</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:weight</span> bold)
          (<span style="color: #8b2252;">"Blog"</span>        <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #9966CC;">#9966CC</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"story"</span>       <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FF7D7D;">#FF7D7D</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"Test"</span>        <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #FF0000;">#FF0000</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:weight</span> bold)
          (<span style="color: #8b2252;">"Attach"</span>      <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #FF0000;">#FF0000</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:underline</span> t <span style="color: #483d8b;">:weight</span> bold)
          (<span style="color: #8b2252;">"drill"</span>       <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #66BB66;">#66BB66</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:underline</span> t)
          (<span style="color: #8b2252;">"DEBUG"</span>       <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #9966CC;">#9966CC</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"EVENT"</span>       <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #9966CC;">#9966CC</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"Thinking"</span>    <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #96A9FF;">#96A9FF</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"Schedule"</span>    <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FF7D7D;">#FF7D7D</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"INPUT"</span>       <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #CC6666;">#CC6666</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"OUTPUT"</span>      <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #66CC99;">#66CC99</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"CYCLE"</span>       <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #6699CC;">#6699CC</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"weekend"</span>     <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #CC6666;">#CC6666</span><span style="color: #8b2252;">"</span>)
          (<span style="color: #8b2252;">"Log"</span>         <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #008500;">#008500</span><span style="color: #8b2252;">"</span>))))
<span style="color: #b22222;">;;</span><span style="color: #000000; background-color: #5BDF8D;">#5BDF8D</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga6f468b" class="outline-3">
<h3 id="orga6f468b"><span class="section-number-3">10.6</span> TODOキーワードのカスタマイズ</h3>
<div class="outline-text-3" id="text-10-6">
<p>
キーワードには日本語も使えます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  (<span style="color: #a020f0;">setq</span> org-todo-keywords
        '((sequence <span style="color: #8b2252;">"TODO(t)"</span> <span style="color: #8b2252;">"PLAN(p)"</span> <span style="color: #8b2252;">"PLAN2(P)"</span> <span style="color: #8b2252;">"|"</span> <span style="color: #8b2252;">"DONE(d)"</span>)
          (sequence <span style="color: #8b2252;">"FOCUS(f)"</span> <span style="color: #8b2252;">"CHECK(C)"</span> <span style="color: #8b2252;">"ICAL(c)"</span>  <span style="color: #8b2252;">"|"</span> <span style="color: #8b2252;">"DONE(d)"</span>)
          (sequence <span style="color: #8b2252;">"WAIT(w)"</span> <span style="color: #8b2252;">"SLEEP(s)"</span> <span style="color: #8b2252;">"QUESTION(q)"</span> <span style="color: #8b2252;">"|"</span> <span style="color: #8b2252;">"DONE(d)"</span>)
          (sequence <span style="color: #8b2252;">"REV1(1)"</span> <span style="color: #8b2252;">"REV2(2)"</span> <span style="color: #8b2252;">"REV3(3)"</span> <span style="color: #8b2252;">"|"</span> <span style="color: #8b2252;">"APPROVED(a@/!)"</span>)))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Global counting of TODO items</span>
  (<span style="color: #a020f0;">setq</span> org-hierarchical-todo-statistics nil)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Global counting of checked TODO items</span>
  (<span style="color: #a020f0;">setq</span> org-hierarchical-checkbox-statistics nil)

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">block-update-time</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">org-dblock-write:block-update-time</span> (params)
    (<span style="color: #a020f0;">let</span> ((fmt (<span style="color: #a020f0;">or</span> (plist-get params <span style="color: #483d8b;">:format</span>) <span style="color: #8b2252;">"%Y-%m-%d"</span>)))
      (insert <span style="color: #8b2252;">""</span> (format-time-string fmt (current-time)))))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12377;&#12409;&#12390;&#12398;&#12481;&#12455;&#12483;&#12463;&#12508;&#12483;&#12463;&#12473;&#12398; cookies &#12434;&#26356;&#26032;&#12377;&#12427;</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">do-org-update-statistics-cookies</span> ()
    (<span style="color: #a020f0;">interactive</span>)
    (org-update-statistics-cookies 'all)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org087df16" class="outline-3">
<h3 id="org087df16"><span class="section-number-3">10.7</span> ImageMagick を使って様々な画像をインライン表示する</h3>
<div class="outline-text-3" id="text-10-7">
<p>
システムに OpenJPEG と ImageMagick がインストールされていれば，JPEG 2000 などの画像形式もバッファに表示できます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  (<span style="color: #a020f0;">setq</span> org-image-actual-width '(256))
  (add-to-list 'image-file-name-extensions <span style="color: #8b2252;">"jp2"</span>)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-to-list 'image-file-name-extensions "j2c")</span>
  (add-to-list 'image-file-name-extensions <span style="color: #8b2252;">"bmp"</span>)
  (add-to-list 'image-file-name-extensions <span style="color: #8b2252;">"psd"</span>))
</pre>
</div>

<p>
次の例では，同じ画像を2度インライン表示しようと指定ますが，前者は横幅が128ピクセルで表示され，後者は <code>org-image-actual-width</code> で指定した256ピクセルで表示されます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">#+ATTR_HTML: <span style="color: #483d8b;">:width</span> 128
[[~/Desktop/lena_std.jp2]]

[[~/Desktop/lena_std.jp2]]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(org-toggle-inline-images)
</pre>
</div>
</div>
</div>

<div id="outline-container-org7c47f48" class="outline-3">
<h3 id="org7c47f48"><span class="section-number-3">10.8</span> [org-agenda] タスク／予定管理</h3>
<div class="outline-text-3" id="text-10-8">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org-agenda"</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">sorting strategy</span>
  (<span style="color: #a020f0;">setq</span> org-agenda-sorting-strategy
        '((agenda habit-down time-up timestamp-up priority-down category-keep)
          (todo priority-down category-keep)
          (tags priority-down category-keep)
          (search category-keep)))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Set the view span as day in an agenda view, the default is week</span>
  (<span style="color: #a020f0;">setq</span> org-agenda-span 'day)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12450;&#12472;&#12455;&#12531;&#12480;&#12395;&#35686;&#21578;&#12434;&#34920;&#31034;&#12377;&#12427;&#26399;&#38291;</span>
  (<span style="color: #a020f0;">setq</span> org-deadline-warning-days 0)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#26178;&#38291;&#24133;&#12364;&#26126;&#31034;&#30340;&#12395;&#25351;&#23450;&#12373;&#12428;&#12394;&#12356;&#22580;&#21512;&#12398;&#12487;&#12501;&#12457;&#12523;&#12488;&#20516;&#65288;&#20998;&#25351;&#23450;&#65289;</span>
  (<span style="color: #a020f0;">setq</span> org-agenda-default-appointment-duration 60)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12450;&#12472;&#12455;&#12531;&#12480;&#12499;&#12517;&#12540;&#12391;FOLLOW&#12434;&#35373;&#23450;&#65288;&#33258;&#21205;&#30340;&#12395;&#21029;&#12496;&#12483;&#12501;&#12449;&#12395;&#24403;&#35442;&#12479;&#12473;&#12463;&#12434;&#34920;&#31034;&#65289;</span>
  (<span style="color: #a020f0;">setq</span> org-agenda-start-with-follow-mode t)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Customized Time Grid</span>
  (<span style="color: #a020f0;">setq</span> org-agenda-time-grid <span style="color: #b22222;">;; </span><span style="color: #b22222;">Format is changed from 9.1</span>
        '((daily today require-timed)
          (0800 1000 1200 1400 1600 1800 2000 2200 2400)
          <span style="color: #8b2252;">"......"</span>
          <span style="color: #8b2252;">"----------------"</span>
          ))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq org-agenda-current-time-string "&lt;  d('- ' &#65394;&#65423;&#65402;&#65402;)")</span>
  (<span style="color: #a020f0;">setq</span> org-agenda-current-time-string <span style="color: #8b2252;">"&lt; &lt; &lt; &lt; &lt; &lt; &lt; &lt; &lt; &lt; &lt; &lt; &lt; &lt; &lt; &lt; &#65394;&#65423;&#65402;&#65402;"</span>)
  (<span style="color: #a020f0;">setq</span> org-agenda-timegrid-use-ampm t)

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12450;&#12472;&#12455;&#12531;&#12480;&#20316;&#25104;&#23550;&#35937;&#65288;&#25351;&#23450;&#12375;&#12394;&#12356;&#12392;agenda&#12364;&#29983;&#25104;&#12373;&#12428;&#12394;&#12356;&#65289;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12371;&#12371;&#12434;&#38291;&#36949;&#12358;&#12392;&#65292;MobileOrg, iCal export &#12418;&#12358;&#12414;&#12367;&#12356;&#12363;&#12394;&#12356;</span>
  (<span style="color: #a020f0;">setq</span> org-agenda-files
        '(<span style="color: #8b2252;">"~/Dropbox/org/org-ical.org"</span> <span style="color: #8b2252;">"~/Dropbox/org/next.org"</span> <span style="color: #8b2252;">"~/Dropbox/org/db/cooking.org"</span>
          <span style="color: #8b2252;">"~/Dropbox/org/db/daily.org"</span> <span style="color: #8b2252;">"~/Dropbox/org/minutes/wg1.org"</span>
          <span style="color: #8b2252;">"~/Dropbox/org/tr/work.org"</span> <span style="color: #8b2252;">"~/Dropbox/org/academic.org"</span>
          <span style="color: #8b2252;">"~/Dropbox/org/db/trigger.org"</span> <span style="color: #8b2252;">"~/Dropbox/org/org2ja.org"</span>))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"moom"</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Expand the frame width temporarily during org-agenda is activated.</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-agenda-frame-width</span> ()
      (moom-change-frame-width
       (floor (* 1.2 moom-frame-width-single))))
    (add-hook 'org-agenda-mode-hook #'my-agenda-frame-width)
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:org-agenda--quit</span> (<span style="color: #228b22;">&amp;optional</span> _bury)
      (moom-change-frame-width))
    (advice-add 'org-agenda--quit <span style="color: #483d8b;">:after</span> #'advice:org-agenda--quit))

  (add-hook 'org-finalize-agenda-hook #'my-org-agenda-to-appt)

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#31227;&#21205;&#30452;&#24460;&#12395;agenda&#12496;&#12483;&#12501;&#12449;&#12434;&#38281;&#12376;&#12427;&#65288;&#12484;&#12522;&#12540;&#12398;&#20869;&#23481;&#12399;SPACE&#12391;&#30906;&#35469;&#21487;&#65289;</span>
  (org-defkey org-agenda-mode-map [(tab)]
              #'(lambda () (<span style="color: #a020f0;">interactive</span>)
                  (org-agenda-goto)
                  (<span style="color: #a020f0;">with-current-buffer</span> <span style="color: #8b2252;">"*Org Agenda*"</span>
                    (org-agenda-quit))))

  (custom-set-faces
   <span style="color: #b22222;">;; </span><span style="color: #b22222;">'(org-agenda-clocking ((t (:background "</span><span style="color: #ffffff; background-color: #300020;">#300020</span><span style="color: #b22222;">"))))</span>
   '(org-agenda-structure ((t (<span style="color: #483d8b;">:underline</span> t <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #6873ff;">#6873ff</span><span style="color: #8b2252;">"</span>))))
   '(org-agenda-date-today ((t (<span style="color: #483d8b;">:weight</span> bold <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #4a6aff;">#4a6aff</span><span style="color: #8b2252;">"</span>))))
   '(org-agenda-date ((t (<span style="color: #483d8b;">:weight</span> bold <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #6ac214;">#6ac214</span><span style="color: #8b2252;">"</span>))))
   '(org-agenda-date-weekend ((t (<span style="color: #483d8b;">:weight</span> bold <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #ff8d1e;">#ff8d1e</span><span style="color: #8b2252;">"</span>))))
   '(org-time-grid ((t (<span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #0a4796;">#0a4796</span><span style="color: #8b2252;">"</span>))))
   '(org-warning ((t (<span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #ff431a;">#ff431a</span><span style="color: #8b2252;">"</span>))))
   '(org-upcoming-deadline ((t (<span style="color: #483d8b;">:inherit</span> font-lock-keyword-face))))
   )

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25152;&#23450;&#12398;&#26178;&#21051;&#12395;&#24375;&#21046;&#30340;&#12395;Agenda&#12434;&#34920;&#31034;</span>
  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-org-agenda-auto-popup-list</span>
    '(<span style="color: #8b2252;">"01:00"</span> <span style="color: #8b2252;">"11:00"</span> <span style="color: #8b2252;">"14:00"</span> <span style="color: #8b2252;">"17:00"</span> <span style="color: #8b2252;">"20:00"</span> <span style="color: #8b2252;">"23:00"</span>))
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-popup-agenda</span> ()
    (<span style="color: #a020f0;">interactive</span>)
    (<span style="color: #a020f0;">let</span> ((status use-dialog-box))
      (<span style="color: #a020f0;">setq</span> use-dialog-box nil)
      (<span style="color: #a020f0;">when</span> (y-or-n-p-with-timeout <span style="color: #8b2252;">"Popup agenda now?"</span> 10 nil)
        (org-agenda-list))
      (message <span style="color: #8b2252;">""</span>)
      (<span style="color: #a020f0;">setq</span> use-dialog-box status)))
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-popup-agenda-set-timers</span> ()
    (<span style="color: #a020f0;">interactive</span>)
    (cancel-function-timers 'my-popup-agenda)
    (<span style="color: #a020f0;">dolist</span> (triger my-org-agenda-auto-popup-list)
      (<span style="color: #a020f0;">unless</span> (passed-clock-p triger)
        (run-at-time triger nil 'my-popup-agenda))))
  (my-popup-agenda-set-timers)
  (run-at-time <span style="color: #8b2252;">"24:00"</span> nil 'my-popup-agenda-set-timers)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">for next day</span>

(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>

  (define-key org-mode-map (kbd <span style="color: #8b2252;">"&lt;f11&gt;"</span>) 'my-toggle-doing-tag)
  (define-key org-mode-map (kbd <span style="color: #8b2252;">"C-&lt;f11&gt;"</span>) 'my-sparse-doing-tree)

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#29305;&#23450;&#12479;&#12464;&#12434;&#25345;&#12388;&#12484;&#12522;&#12540;&#12522;&#12473;&#12488;&#12434;&#19968;&#30330;&#31227;&#21205;&#65288;org-tags-view, org-tree-slide&#65289;</span>
  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-doing-tag</span> <span style="color: #8b2252;">"Doing"</span>)
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-sparse-doing-tree</span> ()
    (<span style="color: #a020f0;">interactive</span>)
    (org-tags-view nil my-doing-tag))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Doing&#12479;&#12464;&#12434;&#12488;&#12464;&#12523;&#12377;&#12427;</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-toggle-doing-tag</span> ()
    (<span style="color: #a020f0;">interactive</span>)
    (<span style="color: #a020f0;">when</span> (eq major-mode 'org-mode)
      (<span style="color: #a020f0;">save-excursion</span>
        (<span style="color: #a020f0;">save-restriction</span>
          (org-back-to-heading t)
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">before 9</span>
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">(unless (org-at-heading-p)</span>
          <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(outline-previous-heading))</span>
          (org-toggle-tag my-doing-tag
                          (<span style="color: #a020f0;">if</span> (string-match
                               (concat <span style="color: #8b2252;">":"</span> my-doing-tag <span style="color: #8b2252;">":"</span>)
                               (org-get-tags-string))
                              'off 'on))))
      (org-reveal)))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12388;&#12356;&#12391;&#12395; calendar.app &#12418;&#23450;&#26399;&#30340;&#12395;&#24375;&#21046;&#36215;&#21205;&#12377;&#12427;</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-popup-calendar</span> ()
    (<span style="color: #a020f0;">interactive</span>)
    (<span style="color: #a020f0;">if</span> (window-focus-p)
        (shell-command-to-string <span style="color: #8b2252;">"open -a calendar.app"</span>)
      (message <span style="color: #8b2252;">"--- input focus is currently OUT."</span>)))
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-popup-calendar-set-timers</span> ()
    (<span style="color: #a020f0;">interactive</span>)
    (cancel-function-timers 'my-popup-calendar)
    (<span style="color: #a020f0;">dolist</span> (triger my-org-agenda-auto-popup-list)
      (<span style="color: #a020f0;">unless</span> (passed-clock-p triger)
        (run-at-time triger nil 'my-popup-calendar))))
  (<span style="color: #a020f0;">when</span> (memq window-system '(mac ns))
    (my-popup-calendar-set-timers)
    (run-at-time <span style="color: #8b2252;">"24:00"</span> nil 'my-popup-calendar-set-timers))) <span style="color: #b22222;">;; </span><span style="color: #b22222;">for next day</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf9053c5" class="outline-3">
<h3 id="orgf9053c5"><span class="section-number-3">10.9</span> <span class="todo TODO">TODO</span> [orgbox.el] スケジュール追加のわかりやすい入力</h3>
<div class="outline-text-3" id="text-10-9">
<p>
<code>C-c C-s</code> をオーバーライドして <code>orgbox-schedule</code> を実行する．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">orgbox</span> nil t))
</pre>
</div>
</div>
</div>

<div id="outline-container-org87c9b3f" class="outline-3">
<h3 id="org87c9b3f"><span class="section-number-3">10.10</span> <span class="todo TODO">TODO</span> [org-review.el] レビューフローのサポート</h3>
<div class="outline-text-3" id="text-10-10">
<ul class="org-ul">
<li><a href="https://github.com/brabalan/org-review">https://github.com/brabalan/org-review</a><br /></li>
<li>以下の設定では， <code>org-agenda</code> 使用時に <code>C-c C-r r</code> で発動<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org-agenda"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-review</span> nil t)
    (add-to-list 'org-agenda-custom-commands
                 '(<span style="color: #8b2252;">"r"</span> <span style="color: #8b2252;">"Review projects"</span> tags-todo <span style="color: #8b2252;">"-CANCELLED/"</span>
                   ((org-agenda-overriding-header <span style="color: #8b2252;">"Reviews Scheduled"</span>)
                    (org-agenda-skip-function 'org-review-agenda-skip)
                    (org-agenda-cmp-user-defined 'org-review-compare)
                    (org-agenda-sorting-strategy '(user-defined-down)))))
    (org-defkey org-agenda-mode-map <span style="color: #8b2252;">"\C-c\C-r"</span>
                'org-review-insert-last-review)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org24ce624" class="outline-3">
<h3 id="org24ce624"><span class="section-number-3">10.11</span> [appt.el] アラーム設定</h3>
<div class="outline-text-3" id="text-10-11">
<ul class="org-ul">
<li>Growl や <a href="https://github.com/julienXX/terminal-notifier/releases">Terminal Notifier</a> と連携していると，Emacsがバックグラウンドにあってもアラームに気づける．<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(appt my-org-agenda-to-appt advice:appt-display-message
              advice:appt-disp-window)
       <span style="color: #8b2252;">"appt"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-c f 3"</span>) #'my-org-agenda-to-appt))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"appt"</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">window &#12434; &#12501;&#12524;&#12540;&#12512;&#20869;&#12395;&#34920;&#31034;&#12377;&#12427;</span>
    (<span style="color: #a020f0;">setq</span> appt-display-format 'echo)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">window &#12434;&#32153;&#32154;&#34920;&#31034;&#12377;&#12427;&#26178;&#38291;[s]</span>
    (<span style="color: #a020f0;">setq</span> appt-display-duration 5)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12499;&#12540;&#12503;&#38899;&#12398;&#26377;&#28961;</span>
    (<span style="color: #a020f0;">setq</span> appt-audible nil)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20309;&#20998;&#21069;&#12363;&#12425;&#35686;&#21578;&#34920;&#31034;&#12434;&#38283;&#22987;&#12377;&#12427;&#12363;[m]</span>
    (<span style="color: #a020f0;">setq</span> appt-message-warning-time 20)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#35686;&#21578;&#34920;&#31034;&#38283;&#22987;&#12363;&#12425;&#20309;&#20998;&#12372;&#12392;&#12395;&#12522;&#12510;&#12452;&#12531;&#12489;&#12377;&#12427;&#12363;[m]</span>
    (<span style="color: #a020f0;">setq</span> appt-display-interval 1)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">appt-display-format &#12364; 'echo &#12391;&#12418; appt-disp-window-function &#12434;&#21628;&#12406;</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:appt-display-message</span> (string mins)
      <span style="color: #8b2252;">"Display a reminder about an appointment.</span>
<span style="color: #8b2252;">The string STRING describes the appointment, due in integer MINS minutes.</span>
<span style="color: #8b2252;">The arguments may also be lists, where each element relates to a</span>
<span style="color: #8b2252;">separate appointment.  The variable `</span><span style="color: #008b8b;">appt-display-format</span><span style="color: #8b2252;">' controls</span>
<span style="color: #8b2252;">the format of the visible reminder.  If `</span><span style="color: #008b8b;">appt-audible</span><span style="color: #8b2252;">' is non-nil,</span>
<span style="color: #8b2252;">also calls `</span><span style="color: #008b8b;">beep</span><span style="color: #8b2252;">' for an audible reminder."</span>
      (<span style="color: #a020f0;">if</span> appt-audible (beep 1))
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">Backwards compatibility: avoid passing lists to a-d-w-f if not necessary.</span>
      (<span style="color: #a020f0;">and</span> (listp mins)
           (= (length mins) 1)
           (<span style="color: #a020f0;">setq</span> mins (car mins)
                 string (car string)))
      (<span style="color: #a020f0;">when</span> (memq appt-display-format '(window echo))
        (<span style="color: #a020f0;">let</span> ((time (format-time-string <span style="color: #8b2252;">"%a %b %e "</span>))
              err)
          (<span style="color: #a020f0;">condition-case</span> err
              (funcall appt-disp-window-function
                       (<span style="color: #a020f0;">if</span> (listp mins)
                           (mapcar 'number-to-string mins)
                         (number-to-string mins))
                       time string)
            (wrong-type-argument
             (<span style="color: #a020f0;">if</span> (not (listp mins))
                 (<span style="color: #ff0000; font-weight: bold;">signal</span> (car err) (cdr err))
               (message <span style="color: #8b2252;">"Argtype error in `</span><span style="color: #008b8b;">appt-disp-window-function</span><span style="color: #8b2252;">' - \</span>
<span style="color: #8b2252;">update it for multiple appts?"</span>)
               <span style="color: #b22222;">;; </span><span style="color: #b22222;">Fallback to just displaying the first appt, as we used to.</span>
               (funcall appt-disp-window-function
                        (number-to-string (car mins)) time
                        (car string)))))
          err))
      (<span style="color: #a020f0;">cond</span> ((eq appt-display-format 'window)
             <span style="color: #b22222;">;; </span><span style="color: #b22222;">TODO use calendar-month-abbrev-array rather than %b?</span>
             (run-at-time (format <span style="color: #8b2252;">"%d sec"</span> appt-display-duration)
                          nil
                          appt-delete-window-function))
            ((eq appt-display-format 'echo)
             (message <span style="color: #8b2252;">"%s"</span> (<span style="color: #a020f0;">if</span> (listp string)
                               (mapconcat 'identity string <span style="color: #8b2252;">"\n"</span>)
                             string)))))
    (advice-add 'appt-display-message <span style="color: #483d8b;">:override</span> #'advice:appt-display-message)
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:appt-disp-window</span> (min-to-app _new-time appt-msg)
      <span style="color: #8b2252;">"Extension to support appt-disp-window."</span>
      (<span style="color: #a020f0;">if</span> (string= min-to-app <span style="color: #8b2252;">"0"</span>)
          (my-desktop-notification <span style="color: #8b2252;">"### Expired! ###"</span> appt-msg t <span style="color: #8b2252;">"Glass"</span>)
        (my-desktop-notification
         (concat <span style="color: #8b2252;">"in "</span> min-to-app <span style="color: #8b2252;">" min."</span>) appt-msg nil <span style="color: #8b2252;">"Tink"</span>)))
    (<span style="color: #a020f0;">cond</span>
     ((eq appt-display-format 'echo)
      (<span style="color: #a020f0;">setq</span> appt-disp-window-function 'advice:appt-disp-window))
     ((eq appt-display-format 'window)
      (advice-add 'appt-disp-window <span style="color: #483d8b;">:before</span> #'advice:appt-disp-window))))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12450;&#12521;&#12540;&#12512;&#34920;&#31034;&#12434;&#26377;&#21177;&#12395;&#12377;&#12427;</span>
    (<span style="color: #a020f0;">unless</span> batch-build
      (add-hook 'org-agenda-mode-hook #'my-org-agenda-to-appt) <span style="color: #b22222;">;; </span><span style="color: #b22222;">init</span>
      (appt-activate 1))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">org-agenda &#12398;&#20869;&#23481;&#12434;&#12450;&#12521;&#12540;&#12512;&#12395;&#30331;&#37682;&#12377;&#12427;</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#23450;&#26399;&#30340;&#12395;&#26356;&#26032;&#12377;&#12427;</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-org-agenda-to-appt</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (org-agenda-to-appt t '((headline <span style="color: #8b2252;">"TODO"</span>))))
    (run-with-idle-timer 500 t 'my-org-agenda-to-appt)
    (add-hook 'org-capture-before-finalize-hook #'my-org-agenda-to-appt)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org827379e" class="outline-3">
<h3 id="org827379e"><span class="section-number-3">10.12</span> [org-capture] 高速にメモを取る</h3>
<div class="outline-text-3" id="text-10-12">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(org-capture)
       <span style="color: #8b2252;">"org-capture"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12461;&#12515;&#12503;&#12481;&#12515;&#26178;&#12395;&#20316;&#25104;&#26085;&#26178;&#12434;&#12503;&#12525;&#12497;&#12486;&#12451;&#12395;&#20837;&#12428;&#12427;</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Thanks to https://emacs.stackexchange.com/questions/21291/add-created-timestamp-to-logbook</span>
    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-org-created-property-name</span> <span style="color: #8b2252;">"CREATED"</span>
      <span style="color: #8b2252;">"The name of the org-mode property.</span>

<span style="color: #8b2252;">This user property stores the creation date of the entry"</span>)
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-org-set-created-property</span> (<span style="color: #228b22;">&amp;optional</span> active NAME)
      <span style="color: #8b2252;">"Set a property on the entry giving the creation time.</span>

<span style="color: #8b2252;">By default the property is called CREATED. If given the `</span><span style="color: #008b8b;">NAME</span><span style="color: #8b2252;">'</span>
<span style="color: #8b2252;">argument will be used instead. If the property already exists, it</span>
<span style="color: #8b2252;">will not be modified."</span>
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">let*</span> ((created (<span style="color: #a020f0;">or</span> NAME my-org-created-property-name))
             (fmt (<span style="color: #a020f0;">if</span> active <span style="color: #8b2252;">"&lt;%s&gt;"</span> <span style="color: #8b2252;">"[%s]"</span>))
             (now  (format fmt (format-time-string <span style="color: #8b2252;">"%Y-%m-%d %a %H:%M"</span>))))
        (<span style="color: #a020f0;">unless</span> (org-entry-get (point) created nil)
          (org-set-property created now)))))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org-capture"</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-org-toggle-block-visibility</span> ()
      <span style="color: #8b2252;">"Testing..."</span>
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">when</span> (looking-at org-drawer-regexp)
        (org-flag-drawer    <span style="color: #b22222;">; </span><span style="color: #b22222;">toggle block visibility</span>
         (not (get-char-property (match-end 0) 'invisible)))))

    (add-hook 'org-capture-before-finalize-hook #'my-org-set-created-property)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">2010-06-13 &#12398;&#24418;&#24335;&#12391;&#12399;&#65292;&#12479;&#12464;&#12392;&#12375;&#12390;&#35469;&#35672;&#12373;&#12428;&#12394;&#12356;</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">get-current-date-tags</span> () (format-time-string <span style="color: #8b2252;">"%Y%m%d"</span>))
    (<span style="color: #a020f0;">setq</span> org-default-notes-file (concat org-directory <span style="color: #8b2252;">"next.org"</span>))
    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">org-capture-academic-file</span> (concat org-directory <span style="color: #8b2252;">"academic.org"</span>))
    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">org-capture-ical-file</span> (concat org-directory <span style="color: #8b2252;">"org-ical.org"</span>))
    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">org-capture-buffer-file</span> (concat org-directory <span style="color: #8b2252;">"db/buffer.org"</span>))
    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">org-capture-notes-file</span> (concat org-directory <span style="color: #8b2252;">"db/note.org"</span>))
    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">org-capture-english-file</span> (concat org-directory <span style="color: #8b2252;">"db/english.org"</span>))
    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">org-capture-diary-file</span> (concat org-directory <span style="color: #8b2252;">"log/diary.org"</span>))
    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">org-capture-article-file</span> (concat org-directory <span style="color: #8b2252;">"db/article.org"</span>))
    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">org-capture-blog-file</span>
      (concat org-directory <span style="color: #8b2252;">"blog/entries/default.org"</span>))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">see org.pdf:p73</span>
    (<span style="color: #a020f0;">setq</span> org-capture-templates
          `((<span style="color: #8b2252;">"t"</span> <span style="color: #8b2252;">"TODO &#38917;&#30446;&#12434; INBOX &#12395;&#36028;&#12426;&#20184;&#12369;&#12427;"</span> entry
             (file+headline ,org-default-notes-file <span style="color: #8b2252;">"INBOX"</span>) <span style="color: #8b2252;">"** TODO %?\n\t"</span>)
            (<span style="color: #8b2252;">"a"</span> <span style="color: #8b2252;">"&#35352;&#20107;&#12522;&#12473;&#12488;&#12395;&#12456;&#12531;&#12488;&#12522;&#12540;"</span> entry
             (file+headline ,org-capture-article-file <span style="color: #8b2252;">"INBOX"</span>)
             <span style="color: #8b2252;">"** READ %?\n\t"</span>)
            (<span style="color: #8b2252;">"c"</span> <span style="color: #8b2252;">"&#21516;&#26399;&#12459;&#12524;&#12531;&#12480;&#12540;&#12395;&#12456;&#12531;&#12488;&#12522;&#12540;"</span> entry
             (file+headline ,org-capture-ical-file <span style="color: #8b2252;">"Scheduled"</span>)
             <span style="color: #8b2252;">"** TODO %?\n\t"</span>)
            (<span style="color: #8b2252;">"d"</span> <span style="color: #8b2252;">"Doing&#12479;&#12464;&#20184;&#12365;&#12398;&#12479;&#12473;&#12463;&#12434;Inbox&#12395;&#25237;&#12370;&#12427;"</span> entry
             (file+headline ,org-default-notes-file <span style="color: #8b2252;">"INBOX"</span>)
             <span style="color: #8b2252;">"** TODO %? :Doing:\n  - \n"</span>)
            (<span style="color: #8b2252;">"l"</span> <span style="color: #8b2252;">"&#26412;&#26085;&#12398;&#12481;&#12455;&#12483;&#12463;&#12522;&#12473;&#12488;"</span> entry
             (file+headline ,org-capture-diary-file <span style="color: #8b2252;">"Today"</span>)
             <span style="color: #8b2252;">"** FOCUS &#26412;&#26085;&#12398;&#12481;&#12455;&#12483;&#12463;&#12522;&#12473;&#12488; %T\n&#65288;&#36215;&#24202;&#26178;&#38291;&#12398;&#35352;&#37682;&#65289;[[http://www.hayaoki-seikatsu.com/users/takaxp/][&#26089;&#36215;&#12365;&#26085;&#35352;]] \n&#65288;&#26397;&#39135;&#65289;\n  - [ ] %?\n&#65288;&#26172;&#39135;&#65289;\n&#65288;&#24112;&#23429;&#65295;&#22805;&#39135;&#65289;\n----\n&#65288;&#30740;&#31350;&#36895;&#22577;&#65289;\n  - [ ] \n"</span>)
            (<span style="color: #8b2252;">"i"</span> <span style="color: #8b2252;">"&#12450;&#12452;&#12487;&#12451;&#12450;&#12434;&#26360;&#12365;&#36796;&#12416;"</span> entry (file+headline ,org-default-notes-file <span style="color: #8b2252;">"INBOX"</span>)
             <span style="color: #8b2252;">"** %?\n  - \n\t%U"</span>)
            (<span style="color: #8b2252;">"b"</span> <span style="color: #8b2252;">"Create new post for imadenale blog"</span> entry
             (file+headline ,org-capture-blog-file ,(format-time-string <span style="color: #8b2252;">"%Y"</span>))
             <span style="color: #8b2252;">"** TODO \n:PROPERTIES:\n:EXPORT_FILE_NAME: %?\n:EXPORT_HUGO_TAGS: \n:END:\n"</span>)
            (<span style="color: #8b2252;">"B"</span> <span style="color: #8b2252;">"Create new post for imadenale blog (UUID)"</span> entry
             (file+headline ,org-capture-blog-file ,(format-time-string <span style="color: #8b2252;">"%Y"</span>))
             <span style="color: #8b2252;">"** TODO %?\n:PROPERTIES:\n:EXPORT_FILE_NAME: %(uuid-string)\n:EXPORT_HUGO_TAGS: \n:END:\n"</span>)
            <span style="color: #b22222;">;; </span><span style="color: #b22222;">("b" "Bug &#12479;&#12464;&#20184;&#12365;&#12398; TODO &#38917;&#30446;&#12434;&#36028;&#12426;&#20184;&#12369;&#12427;" entry</span>
            <span style="color: #b22222;">;;  </span><span style="color: #b22222;">(file+headline ,org-default-notes-file "INBOX")</span>
            <span style="color: #b22222;">;;  </span><span style="color: #b22222;">"** TODO %? :bug:\n %i\n %a %t")</span>
            (<span style="color: #8b2252;">"T"</span> <span style="color: #8b2252;">"&#26178;&#38291;&#20184;&#12365;&#12456;&#12531;&#12488;&#12522;&#12540;"</span> entry (file+headline ,org-default-notes-file <span style="color: #8b2252;">"INBOX"</span>)
             <span style="color: #8b2252;">"** %? %T--\n"</span>)
            (<span style="color: #8b2252;">"n"</span> <span style="color: #8b2252;">"&#12494;&#12540;&#12488;&#12392;&#12375;&#12390;INBOX&#12395;&#36028;&#12426;&#20184;&#12369;&#12427;"</span> entry
             (file+headline ,org-default-notes-file <span style="color: #8b2252;">"INBOX"</span>)
             <span style="color: #8b2252;">"** %? :note:\n\t%U"</span>)
            (<span style="color: #8b2252;">"D"</span> <span style="color: #8b2252;">"&#12300;&#12489;&#12521;&#12483;&#12459;&#12540;365&#12398;&#37329;&#35328;&#12301;&#12434;&#12494;&#12540;&#12488;&#12377;&#12427;"</span> entry
             (file+headline ,org-capture-notes-file <span style="color: #8b2252;">"The Daily Drucker"</span>)
             <span style="color: #8b2252;">"** &#12300;%?&#12301;\nDrucker) \n  - \n  - \nACTION POINT:\n  - \nQUESTION:\n  - \n"</span>)
            (<span style="color: #8b2252;">"r"</span> ,(concat <span style="color: #8b2252;">"&#30740;&#31350;&#12494;&#12540;&#12488;&#12434; "</span> org-capture-academic-file
                          <span style="color: #8b2252;">" &#12395;&#26360;&#12365;&#36796;&#12416;"</span>)
             entry (file+headline ,org-capture-academic-file <span style="color: #8b2252;">"Survey"</span>)
             <span style="color: #8b2252;">"** %? :note:\n# \n  - \n\t%U"</span>)
            (<span style="color: #8b2252;">"`"</span> ,(concat <span style="color: #8b2252;">"&#12494;&#12540;&#12488;&#12434;&#12496;&#12483;&#12501;&#12449; "</span> org-capture-buffer-file
                          <span style="color: #8b2252;">" &#12395;&#26360;&#12365;&#36796;&#12416;"</span>)
             entry (file+headline ,org-capture-buffer-file <span style="color: #8b2252;">"Buffers"</span>)
             <span style="color: #8b2252;">"** %(get-random-string 16) %U\n\n%?\n\n----"</span>)
            (<span style="color: #8b2252;">"w"</span> ,(concat <span style="color: #8b2252;">"&#33521;&#21336;&#35486;&#12434; "</span> org-capture-english-file
                          <span style="color: #8b2252;">" &#12395;&#26360;&#12365;&#36796;&#12416;"</span>) <span style="color: #ff0000; font-weight: bold;">entry</span>
                          (file+headline ,org-capture-english-file <span style="color: #8b2252;">"WORDS"</span>)
                          <span style="color: #8b2252;">"** %? :%(get-current-date-tags):\n&#12300;&#12301;\n  - "</span>)
            (<span style="color: #8b2252;">"g"</span> ,(concat <span style="color: #8b2252;">"&#33521;&#35486;&#12494;&#12540;&#12488;&#12434; "</span> org-capture-english-file
                          <span style="color: #8b2252;">" &#12395;&#26360;&#12365;&#36796;&#12416;"</span>)
             entry (file+headline ,org-capture-english-file <span style="color: #8b2252;">"GRAMMER"</span>)
             <span style="color: #8b2252;">"** %? :%(get-current-date-tags):\n\n%U"</span>)
            ))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0d105a9" class="outline-3">
<h3 id="org0d105a9"><span class="section-number-3">10.13</span> [org-refile] orgツリーの高速移動</h3>
<div class="outline-text-3" id="text-10-13">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#23653;&#27508;&#12364;&#29983;&#25104;&#12373;&#12428;&#12427;&#12398;&#12434;&#25233;&#21046;&#65294;</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">[2/3]&#12398;&#12424;&#12358;&#12394;&#23436;&#20102;&#25968;&#12364;&#35211;&#20986;&#12375;&#12395;&#12354;&#12427;&#26178;&#12395;&#36578;&#36865;&#20808;&#20505;&#35036;&#12364;&#37325;&#35079;&#34920;&#31034;&#12373;&#12428;&#12427;&#12383;&#12417;&#65294;</span>

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:org-refile</span> (f <span style="color: #228b22;">&amp;optional</span> arg default-buffer rfloc msg)
    <span style="color: #8b2252;">"Extension to support keeping org-refile-history empty."</span>
    (<span style="color: #a020f0;">let</span> ((l (org-outline-level))
          (b (buffer-name)))
      (apply f arg default-buffer rfloc msg)
      (<span style="color: #a020f0;">save-excursion</span>
        (<span style="color: #a020f0;">save-restriction</span>
          (<span style="color: #a020f0;">if</span> (&gt; l (org-outline-level))
              (outline-backward-same-level 1)
            (outline-up-heading 1))
          (org-update-statistics-cookies nil) <span style="color: #b22222;">;; </span><span style="color: #b22222;">Update in source</span>
          (org-refile-goto-last-stored)
          (org-update-parent-todo-statistics) <span style="color: #b22222;">;; </span><span style="color: #b22222;">Update in destination</span>
          (<span style="color: #a020f0;">unless</span> (equal b (buffer-name))
            (switch-to-buffer b)))))
    (<span style="color: #a020f0;">setq</span> org-refile-history nil)
    (org-refile-cache-clear))
  (advice-add 'org-refile <span style="color: #483d8b;">:around</span> #'advice:org-refile)

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12522;&#12501;&#12449;&#12452;&#12523;&#20808;&#12391;&#12469;&#12502;&#12487;&#12451;&#12524;&#12463;&#12488;&#12522;&#12434;&#25351;&#23450;&#12377;&#12427;&#12383;&#12417;&#12395;&#19968;&#37096;&#12501;&#12523;&#12497;&#12473;&#21270;</span>
  (<span style="color: #a020f0;">let</span> ((dir (expand-file-name org-directory)))
    (<span style="color: #a020f0;">setq</span> org-refile-targets
          `((<span style="color: #8b2252;">"next.org"</span> <span style="color: #483d8b;">:level</span> . 1)
            (<span style="color: #8b2252;">"org-ical.org"</span> <span style="color: #483d8b;">:level</span> . 1)
            (<span style="color: #8b2252;">"academic.org"</span> <span style="color: #483d8b;">:level</span> . 1)
            (,(concat dir <span style="color: #8b2252;">"tr/work.org"</span>) <span style="color: #483d8b;">:level</span> . 1)
            (,(concat dir <span style="color: #8b2252;">"minutes/wg1.org"</span>) <span style="color: #483d8b;">:level</span> . 1)
            (,(concat dir <span style="color: #8b2252;">"db/article.org"</span>) <span style="color: #483d8b;">:level</span> . 1)
            (,(concat dir <span style="color: #8b2252;">"db/maybe.org"</span>) <span style="color: #483d8b;">:level</span> . 1)
            (,(concat dir <span style="color: #8b2252;">"db/english.org"</span>) <span style="color: #483d8b;">:level</span> . 1)
            (,(concat dir <span style="color: #8b2252;">"db/money.org"</span>) <span style="color: #483d8b;">:level</span> . 1)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org731e369" class="outline-3">
<h3 id="org731e369"><span class="section-number-3">10.14</span> [org-babel] 基本設定</h3>
<div class="outline-text-3" id="text-10-14">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"ob-core"</span>
  (<span style="color: #a020f0;">setq</span> org-edit-src-content-indentation 0)
  (<span style="color: #a020f0;">setq</span> org-src-fontify-natively t)
  (<span style="color: #a020f0;">setq</span> org-src-tab-acts-natively t)
  (<span style="color: #a020f0;">setq</span> org-confirm-babel-evaluate nil)
  (<span style="color: #a020f0;">setq</span> org-src-window-setup 'current-window)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">org-src-window-setup (current-window, other-window, other-frame)</span>
  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ob-http</span> nil t)
  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ob-gnuplot</span> nil t)

  (<span style="color: #a020f0;">unless</span> (executable-find <span style="color: #8b2252;">"ditaa"</span>)
    (message <span style="color: #8b2252;">"--- ditaa is NOT installed."</span>))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Add ":results output" after program name</span>
  (org-babel-do-load-languages
   'org-babel-load-languages
   '((dot . t)
     (C . t)
     (ditaa . t)
     (gnuplot . t)
     (perl . t)
     (shell . t)
     (latex . t)
     (sqlite . t)
     (R . t)
     (python . t)))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(require 'ob-C nil t)</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(require 'ob-perl nil t)</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(require 'ob-sh nil t)</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(require 'ob-python nil t)</span>

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#23455;&#35013;&#28168;&#12415;&#12398;&#35328;&#35486;&#12395;&#22909;&#12365;&#12394;&#21517;&#21069;&#12434;&#32016;&#20184;&#12369;&#12427;</span>
  (add-to-list 'org-src-lang-modes '(<span style="color: #8b2252;">"cs"</span> . csharp))
  (add-to-list 'org-src-lang-modes '(<span style="color: #8b2252;">"zsh"</span> . sh)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org86adf84" class="outline-3">
<h3 id="org86adf84"><span class="section-number-3">10.15</span> [org-babel] ソースブロックの入力キーをカスタマイズ</h3>
<div class="outline-text-3" id="text-10-15">
<p>
ソースブロックを入力するときは， &lt;+ <code>TAB</code> でテンプレートを高速に入力できます．しかし，利用する言語までは指定できないので，特定の内容について対応するコマンドを割り当てて起きます．以下の例を設定として追加すると， &lt;S+ <code>TAB</code> で <code>emacs-lisp</code> を， &lt;C+ <code>TAB</code> でコメントブロックを指定できます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  (add-to-list 'org-structure-template-alist
               (<span style="color: #a020f0;">if</span> (version&lt; <span style="color: #8b2252;">"9.1.4"</span> (org-version))
                   '(<span style="color: #8b2252;">"S"</span> . <span style="color: #8b2252;">"src emacs-lisp"</span>)
                 '(<span style="color: #8b2252;">"S"</span> <span style="color: #8b2252;">"#+BEGIN_SRC emacs-lisp\n?\n#+END_SRC"</span> <span style="color: #8b2252;">"&lt;src lang=\"emacs-lisp\"&gt;\n\n&lt;/src&gt;"</span>))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org14348b9" class="outline-3">
<h3 id="org14348b9"><span class="section-number-3">10.16</span> [MobileOrg] iOS との連携</h3>
<div class="outline-text-3" id="text-10-16">
<ul class="org-ul">
<li><a href="http://orgmode.org/manual/Setting-up-the-staging-area.html">http://orgmode.org/manual/Setting-up-the-staging-area.html</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  <span style="color: #b22222;">;;</span><span style="color: #b22222;">(setq org-mobile-files '("~/Dropbox/org/next.org" "1.org" "2.org"))</span>
  (<span style="color: #a020f0;">setq</span> org-mobile-files '(<span style="color: #8b2252;">"~/Dropbox/org/next.org"</span>))
  <span style="color: #b22222;">;;</span><span style="color: #b22222;">(setq org-mobile-force-id-on-agenda-items nil)</span>

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Set a file to capture data from iOS devices</span>
  (<span style="color: #a020f0;">setq</span> org-mobile-inbox-for-pull (concat org-directory <span style="color: #8b2252;">"captured.org"</span>))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Upload location stored org files (index.org will be created)</span>
  (<span style="color: #a020f0;">setq</span> org-mobile-directory <span style="color: #8b2252;">"~/Dropbox/Apps/MobileOrg/"</span>)

  <span style="color: #b22222;">;;; </span><span style="color: #b22222;">Menu to push or pull org files using MobileOrg</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">org-mobile-sync</span> ()
    (<span style="color: #a020f0;">interactive</span>)
    (<span style="color: #a020f0;">let</span>
        (org-mobile-sync-type
         (read-from-minibuffer
          <span style="color: #8b2252;">"How do you sync the org files? (pull or push) "</span>))
      (message <span style="color: #8b2252;">"%s"</span> org-mobile-sync-type)
      (<span style="color: #a020f0;">cond</span>
       ((string= <span style="color: #8b2252;">"pull"</span> org-mobile-sync-type) (org-mobile-pull))
       ((string= <span style="color: #8b2252;">"push"</span> org-mobile-sync-type) (org-mobile-push))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd72b299" class="outline-3">
<h3 id="orgd72b299"><span class="section-number-3">10.17</span> [org-tree-slide] Org Modeでプレゼンテーション</h3>
<div class="outline-text-3" id="text-10-17">
<ul class="org-ul">
<li><a href="https://pxaka.tokyo/wiki/doku.php?id=emacs:org-tree-slide">https://pxaka.tokyo/wiki/doku.php?id=emacs:org-tree-slide</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(org-tree-slide-mode)
       <span style="color: #8b2252;">"org-tree-slide"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"&lt;f8&gt;"</span>) 'org-tree-slide-mode)
    (global-set-key (kbd <span style="color: #8b2252;">"S-&lt;f8&gt;"</span>) 'org-tree-slide-skip-done-toggle))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org-tree-slide"</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&lt;f8&gt;/&lt;f9&gt;/&lt;f10&gt;/&lt;f11&gt; are assigned to control org-tree-slide</span>
    (define-key org-tree-slide-mode-map (kbd <span style="color: #8b2252;">"&lt;f9&gt;"</span>)
      'org-tree-slide-move-previous-tree)
    (define-key org-tree-slide-mode-map (kbd <span style="color: #8b2252;">"&lt;f10&gt;"</span>)
      'org-tree-slide-move-next-tree)
    (<span style="color: #a020f0;">unless</span> batch-build
      (org-tree-slide-narrowing-control-profile))
    (<span style="color: #a020f0;">setq</span> org-tree-slide-modeline-display 'outside)
    (<span style="color: #a020f0;">setq</span> org-tree-slide-skip-outline-level 5)
    (<span style="color: #a020f0;">setq</span> org-tree-slide-skip-done nil)))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">(require 'use-package nil t)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(use-package org-tree-slide</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">:bind (("&lt;f8&gt;" . org-tree-slide-mode)</span>
<span style="color: #b22222;">;;          </span><span style="color: #b22222;">("S-&lt;f8&gt;" . org-tree-slide-skip-done-toggle))</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">:defer t</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">:init</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">:config</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(define-key org-tree-slide-mode-map (kbd "&lt;f9&gt;")</span>
<span style="color: #b22222;">;;     </span><span style="color: #b22222;">'org-tree-slide-move-previous-tree)</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(define-key org-tree-slide-mode-map (kbd "&lt;f10&gt;")</span>
<span style="color: #b22222;">;;     </span><span style="color: #b22222;">'org-tree-slide-move-next-tree)</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(org-tree-slide-narrowing-control-profile)</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(setq org-tree-slide-modeline-display 'outside)</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(setq org-tree-slide-skip-outline-level 5)</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(setq org-tree-slide-skip-done nil))</span>
</pre>
</div>

<p>
<code>Doing</code> タグのトグルに <code>f11</code> を割り当てたので，コンテンツモードへの切り替えは，異なるキーバインドに変更．<br />
</p>
</div>
</div>

<div id="outline-container-org580b52c" class="outline-3">
<h3 id="org580b52c"><span class="section-number-3">10.18</span> [org-tree-slide] クロックインとアウトを自動化する</h3>
<div class="outline-text-3" id="text-10-18">
<p>
特定のファイルを編集している時， <code>org-tree-slide</code> でフォーカスしたら <code>org-clock-in</code> で時間計測を始めて，ナローイングを解く時や次のツリーに移る時に <code>org-clock-out</code> で計測を停止するように設定しています．基本的に <code>org-tree-slide</code> にあるhookに色々とぶら下げるだけです．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org-tree-slide"</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-tree-slide-autoclockin-p</span> ()
    (<span style="color: #a020f0;">save-excursion</span>
      (<span style="color: #a020f0;">save-restriction</span>
        (widen)
        (goto-char 1)
        (<span style="color: #a020f0;">let</span> ((keyword <span style="color: #8b2252;">"TREE_SLIDE:"</span>)
              (value <span style="color: #8b2252;">"autoclockin"</span>)
              (result nil))
          (<span style="color: #a020f0;">while</span>
              (<span style="color: #a020f0;">and</span> (re-search-forward (concat <span style="color: #8b2252;">"^#\\+"</span> keyword <span style="color: #8b2252;">"[ \t]*"</span>) nil t)
                   (re-search-forward value (point-at-eol) t))
            (<span style="color: #a020f0;">setq</span> result t))
          result))))

  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-clock</span> nil t)
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-org-clock-in</span> ()
      (<span style="color: #a020f0;">setq</span> vc-display-status nil) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12514;&#12540;&#12489;&#12521;&#12452;&#12531;&#31680;&#32004;</span>
      (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (my-tree-slide-autoclockin-p)
                 (looking-at (concat <span style="color: #8b2252;">"^\\*+ "</span> org-not-done-regexp))
                 (memq (org-outline-level) '(1 2 3 4)))
        (org-clock-in)))

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-org-clock-out</span> ()
      (<span style="color: #a020f0;">setq</span> vc-display-status t) <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12514;&#12540;&#12489;&#12521;&#12452;&#12531;&#31680;&#32004;&#35299;&#38500;</span>
      (<span style="color: #a020f0;">when</span> (org-clocking-p)
        (org-clock-out)))

    (add-hook 'org-tree-slide-before-move-next-hook #'my-org-clock-out)
    (add-hook 'org-tree-slide-before-move-previous-hook #'my-org-clock-out)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-hook 'org-tree-slide-before-content-view-hook #'my-org-clock-out)</span>
    (add-hook 'org-tree-slide-mode-stop-hook #'my-org-clock-out)
    (add-hook 'org-tree-slide-after-narrow-hook #'my-org-clock-in)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga5b1ada" class="outline-3">
<h3 id="orga5b1ada"><span class="section-number-3">10.19</span> [org-tree-slide] 特定のツリーをプロポーショナルフォントで表示する</h3>
<div class="outline-text-3" id="text-10-19">
<p>
ツリーのプロパティに，プロポーショナルで表示するか否かの制御フラグを加えます．ツリーにフォーカス時にPROPORTIONAL指定がプロパティにあると，そのツリーを動的にプロポーショナルフォントでレンダリングします．変更は下位ツリーの全てに継承しています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(org-tree-slide-mode my-proportional-font-toggle)
       <span style="color: #8b2252;">"org-tree-slide"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org-tree-slide"</span>
    (<span style="color: #a020f0;">defcustom</span> <span style="color: #a0522d;">use-proportional-font</span> nil
      <span style="color: #8b2252;">"The status of FONT property"</span>
      <span style="color: #483d8b;">:type</span> 'boolean
      <span style="color: #483d8b;">:group</span> 'org-mode)

    (set-face-attribute 'variable-pitch nil
                        <span style="color: #483d8b;">:family</span> <span style="color: #8b2252;">"Verdana"</span>
                        <span style="color: #b22222;">;; </span><span style="color: #b22222;">:family "Comic Sans MS"</span>
                        <span style="color: #483d8b;">:height</span> 125)

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-proportional-font-toggle</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">setq</span> use-proportional-font (not use-proportional-font))
      (<span style="color: #a020f0;">if</span> use-proportional-font
          (org-entry-put nil <span style="color: #8b2252;">"FONT"</span> <span style="color: #8b2252;">"PROPORTIONAL"</span>)
        (org-delete-property <span style="color: #8b2252;">"FONT"</span>)))

    (add-hook 'org-tree-slide-before-narrow-hook
              #'(lambda ()
                  (<span style="color: #a020f0;">if</span> (equal <span style="color: #8b2252;">"PROPORTIONAL"</span>
                             (org-entry-get-with-inheritance <span style="color: #8b2252;">"FONT"</span>))
                      (buffer-face-set 'variable-pitch)
                    (buffer-face-mode 0))))
    (add-hook 'org-tree-slide-stop-hook
              #'(lambda ()
                  (buffer-face-mode 0)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga94947a" class="outline-3">
<h3 id="orga94947a"><span class="section-number-3">10.20</span> [org-tree-slide] ヘッドラインをリッチにする</h3>
<div class="outline-text-3" id="text-10-20">
<p>
<code>org-tree-slide</code> が有効な時だけ <code>org-bullets</code> を有効にして，ヘッドラインをリッチにします．元ネタは， <code>org-beautify-theme.el</code> です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(org-bullets-mode)
       <span style="color: #8b2252;">"org-bullets"</span> nil t)

  (add-hook 'org-tree-slide-play-hook #'(lambda () (org-bullets-mode 1)))
  (add-hook 'org-tree-slide-stop-hook #'(lambda () (org-bullets-mode -1))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orge7c2545" class="outline-3">
<h3 id="orge7c2545"><span class="section-number-3">10.21</span> <span class="todo TODO">TODO</span> [org-tree-slide] BEGIN_SRCとEND_SRCを消して背景色を変える</h3>
<div class="outline-text-3" id="text-10-21">
<p>
<code>hide-lines.el</code> を使うことで，プレゼン時に <code>BEGIN_SRC</code> と <code>ENC_SRC</code> を非表示にしてすっきりさせます．さらに，ソースブロックの背景色を変えます（以下の例では， <code>emacs-lisp</code> を言語で指定している場合に限定）．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(org-tree-slide-mode)
       <span style="color: #8b2252;">"org-tree-slide"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org-tree-slide"</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">FIXME &#35079;&#25968;&#12398;&#12496;&#12483;&#12501;&#12449;&#12391;&#20006;&#34892;&#21205;&#20316;&#12373;&#12379;&#12427;&#12392;&#12362;&#12363;&#12375;&#12367;&#12394;&#12427;&#65294;hide-lines &#12398;&#21839;&#38988;&#65311;</span>
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> nil (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">hide-lines</span> nil t))
      (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-org-src-block-faces</span> nil)
      (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-show-headers</span> ()
        (<span style="color: #a020f0;">setq</span> org-src-block-faces 'my-org-src-block-faces)
        (hide-lines-show-all))
      (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-hide-headers</span> ()
        (<span style="color: #a020f0;">setq</span> my-org-src-block-faces 'org-src-block-faces)
        (<span style="color: #a020f0;">setq</span> org-src-block-faces
              '((<span style="color: #8b2252;">"emacs-lisp"</span> (<span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #fff8dc;">cornsilk</span><span style="color: #8b2252;">"</span>))))
        (hide-lines-matching <span style="color: #8b2252;">"#\\+BEGIN_SRC"</span>)
        (hide-lines-matching <span style="color: #8b2252;">"#\\+END_SRC"</span>))
      (add-hook 'org-tree-slide-play-hook #'my-hide-headers)
      (add-hook 'org-tree-slide-stop-hook #'my-show-headers)

      <span style="color: #b22222;">;; </span><span style="color: #b22222;">(defun advice:org-edit-src-code (&amp;optional code edit-buffer-name)</span>
      (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:org-edit-src-code</span> ()
        (<span style="color: #a020f0;">interactive</span>)
        (my-show-headers))
      (advice-add 'org-edit-src-code <span style="color: #483d8b;">:before</span> #'advice:org-edit-src-code)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">Block &#22806;&#12391;&#21628;&#12400;&#12428;&#12427;&#12392;&#65292;my-show-headers &#12364;&#21628;&#12400;&#12428;&#12390;&#12375;&#12414;&#12358;</span>
      (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:org-edit-src-exit</span> ()
        (<span style="color: #a020f0;">interactive</span>)
        (my-hide-headers))
      (advice-add 'org-edit-src-exit <span style="color: #483d8b;">:after</span> #'advice:org-edit-src-exit))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3b4eb8e" class="outline-3">
<h3 id="org3b4eb8e"><span class="section-number-3">10.22</span> <span class="todo TODO">TODO</span> [org-fstree] ディレクトリ構造を読み取る</h3>
<div class="outline-text-3" id="text-10-22">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-fstree</span> nil t))
</pre>
</div>
</div>
</div>

<div id="outline-container-org80c8e1d" class="outline-3">
<h3 id="org80c8e1d"><span class="section-number-3">10.23</span> [calfw-org] calfw に org の予定を表示する</h3>
<div class="outline-text-3" id="text-10-23">
<p>
org-mode の表のようにフェイスを統一しています． <code>calfw</code> を起動する時に，自動的にフレームサイズを拡大するような独自関数をぶら下げています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(my-cfw-open-org-calendar cfw:open-org-calendar)
       <span style="color: #8b2252;">"calfw-org"</span> <span style="color: #8b2252;">"Rich calendar for org-mode"</span> t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-c f c w"</span>) 'my-cfw-open-org-calendar))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"calfw-org"</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">icalendar &#12392;&#12398;&#36899;&#32080;</span>
    (custom-set-variables
     '(cfw:org-icalendars '(<span style="color: #8b2252;">"~/Dropbox/org/org-ical.org"</span>))
     '(cfw:fchar-junction ?+) <span style="color: #b22222;">;; </span><span style="color: #b22222;">org &#12391;&#20351;&#12358;&#34920;&#12395;&#12501;&#12455;&#12452;&#12473;&#12434;&#32113;&#19968;</span>
     '(cfw:fchar-vertical-line ?|)
     '(cfw:fchar-horizontal-line ?-)
     '(cfw:fchar-left-junction ?|)
     '(cfw:fchar-right-junction ?|)
     '(cfw:fchar-top-junction ?+)
     '(cfw:fchar-top-left-corner ?|)
     '(cfw:fchar-top-right-corner ?|))

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-org-mark-ring-goto-calfw</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (org-mark-ring-goto))

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-cfw-open-org-calendar</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (moom-change-frame-width-double)
      (cfw:open-org-calendar))

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-cfw-burry-buffer</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (bury-buffer)
      (moom-change-frame-width-single))

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">cfw:org-goto-date</span> ()
      <span style="color: #8b2252;">"Move the cursor to the specified date."</span>
      (<span style="color: #a020f0;">interactive</span>)
      (cfw:navi-goto-date
       (cfw:emacs-to-calendar (org-read-date nil 'to-time))))

    (define-key cfw:calendar-mode-map (kbd <span style="color: #8b2252;">"j"</span>) 'cfw:org-goto-date)
    (define-key cfw:org-schedule-map (kbd <span style="color: #8b2252;">"q"</span>) 'my-cfw-burry-buffer)))

<span style="color: #b22222;">;;         </span><span style="color: #b22222;">(add-hook 'window-configuration-change-hook 'cfw:resize-calendar)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(defun cfw:resize-calendar ()</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(interactive)</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(when (eq major-mode 'cfw:calendar-mode)</span>
<span style="color: #b22222;">;;     </span><span style="color: #b22222;">(cfw:refresh-calendar-buffer nil)</span>
<span style="color: #b22222;">;;     </span><span style="color: #b22222;">(message "Calendar resized.")))</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">(defun open-calfw-agenda-org ()</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(interactive)</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(cfw:open-org-calendar))</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq org-agenda-custom-commands</span>
<span style="color: #b22222;">;;       </span><span style="color: #b22222;">'(("w" todo "FOCUS")</span>
<span style="color: #b22222;">;;         </span><span style="color: #b22222;">("G" open-calfw-agenda-org "Graphical display in calfw"))))))</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org617be4f" class="outline-3">
<h3 id="org617be4f"><span class="section-number-3">10.24</span> [org-export-generic] エクスポート機能を拡張する</h3>
<div class="outline-text-3" id="text-10-24">
<p>
<code>org-set-generic-type</code> を使うことで，エクスポート機能を好みに拡張できる．contrib の中の <code>org-export-generic.el</code> が必要なので注意する．<br />
</p>

<p>
（注意）次の設定は古い内容．動かないかもしれません．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  (org-set-generic-type
   <span style="color: #8b2252;">"textile"</span>
   '(<span style="color: #483d8b;">:file-suffix</span>
     <span style="color: #8b2252;">".textile"</span>
     <span style="color: #483d8b;">:key-binding</span> ?T
     <span style="color: #483d8b;">:title-format</span>    <span style="color: #8b2252;">"Title: %s\n\n"</span>
     <span style="color: #b22222;">;;   </span><span style="color: #b22222;">:date-format     "Date: %s\n"</span>
     <span style="color: #483d8b;">:date-export</span> nil
     <span style="color: #483d8b;">:toc-export</span>      nil
     <span style="color: #483d8b;">:author-export</span>   nil
     <span style="color: #483d8b;">:tags-export</span>     nil
     <span style="color: #483d8b;">:drawers-export</span>  nil
     <span style="color: #483d8b;">:date-export</span>     t
     <span style="color: #483d8b;">:timestamps-export</span>  t
     <span style="color: #483d8b;">:priorities-export</span>  nil
     <span style="color: #483d8b;">:todo-keywords-export</span> t
     <span style="color: #483d8b;">:body-line-fixed-format</span> <span style="color: #8b2252;">"\t%s\n"</span>
                                        <span style="color: #b22222;">;</span><span style="color: #b22222;">:body-list-prefix "\n"</span>
     <span style="color: #483d8b;">:body-list-format</span> <span style="color: #8b2252;">"* %s"</span>
     <span style="color: #483d8b;">:body-list-suffix</span> <span style="color: #8b2252;">"\n"</span>
     <span style="color: #483d8b;">:body-bullet-list-prefix</span> (<span style="color: #8b2252;">"* "</span> <span style="color: #8b2252;">"** "</span> <span style="color: #8b2252;">"*** "</span> <span style="color: #8b2252;">"**** "</span> <span style="color: #8b2252;">"***** "</span>)
     <span style="color: #483d8b;">:body-number-list-format</span> <span style="color: #8b2252;">"# %s"</span>
     <span style="color: #483d8b;">:body-number-list-suffix</span> <span style="color: #8b2252;">"\n"</span>
     <span style="color: #483d8b;">:header-prefix</span> (<span style="color: #8b2252;">""</span> <span style="color: #8b2252;">""</span> <span style="color: #8b2252;">"### "</span> <span style="color: #8b2252;">"#### "</span> <span style="color: #8b2252;">"##### "</span> <span style="color: #8b2252;">"###### "</span>)
     <span style="color: #483d8b;">:body-section-header-prefix</span> (<span style="color: #8b2252;">"h1. "</span> <span style="color: #8b2252;">"h2. "</span> <span style="color: #8b2252;">"h3. "</span> <span style="color: #8b2252;">"h4. "</span> <span style="color: #8b2252;">"h5. "</span> <span style="color: #8b2252;">"h6. "</span>)
     <span style="color: #483d8b;">:body-section-header-format</span> <span style="color: #8b2252;">"%s"</span>
     <span style="color: #483d8b;">:body-section-header-suffix</span> (<span style="color: #8b2252;">"\n\n"</span>)
     <span style="color: #483d8b;">:body-header-section-numbers</span> nil
     <span style="color: #483d8b;">:body-header-section-number-format</span> <span style="color: #8b2252;">"%s) "</span>
     <span style="color: #483d8b;">:body-line-format</span> <span style="color: #8b2252;">"%s\n"</span>
     <span style="color: #483d8b;">:body-newline-paragraph</span> <span style="color: #8b2252;">"\n"</span>
     <span style="color: #483d8b;">:bold-format</span> <span style="color: #8b2252;">"*%s*"</span>
     <span style="color: #483d8b;">:italic-format</span> <span style="color: #8b2252;">"_%s_"</span>
     <span style="color: #483d8b;">:underline-format</span> <span style="color: #8b2252;">"+%s+"</span>
     <span style="color: #483d8b;">:strikethrough-format</span> <span style="color: #8b2252;">"-%s-"</span>
     <span style="color: #483d8b;">:verbatim-format</span> <span style="color: #8b2252;">"`%s`"</span>
     <span style="color: #483d8b;">:code-format</span> <span style="color: #8b2252;">"@%s@"</span>
     <span style="color: #483d8b;">:body-line-wrap</span>   75
     <span style="color: #483d8b;">:blockquote-start</span> <span style="color: #8b2252;">"\n&lt;pre&gt;\n"</span>
     <span style="color: #483d8b;">:blockquote-end</span> <span style="color: #8b2252;">"\n&lt;/pre&gt;\n"</span>
     ))

  (org-set-generic-type
   <span style="color: #8b2252;">"markdown"</span>
   '(<span style="color: #483d8b;">:file-suffix</span>
     <span style="color: #8b2252;">".markdown"</span>
     <span style="color: #483d8b;">:key-binding</span>     ?M
     <span style="color: #483d8b;">:title-format</span>    <span style="color: #8b2252;">"Title: %s\n"</span>
     <span style="color: #483d8b;">:date-format</span>     <span style="color: #8b2252;">"Date: %s\n"</span>
     <span style="color: #483d8b;">:toc-export</span>      nil
     <span style="color: #483d8b;">:author-export</span>   t
     <span style="color: #483d8b;">:tags-export</span>     nil
     <span style="color: #483d8b;">:drawers-export</span>  nil
     <span style="color: #483d8b;">:date-export</span>     t
     <span style="color: #483d8b;">:timestamps-export</span>  t
     <span style="color: #483d8b;">:priorities-export</span>  nil
     <span style="color: #483d8b;">:todo-keywords-export</span> t
     <span style="color: #483d8b;">:body-line-fixed-format</span> <span style="color: #8b2252;">"\t%s\n"</span>
     <span style="color: #b22222;">;;</span><span style="color: #b22222;">:body-list-prefix "\n"</span>
     <span style="color: #483d8b;">:body-list-format</span> <span style="color: #8b2252;">"- %s"</span>
     <span style="color: #483d8b;">:body-list-suffix</span> <span style="color: #8b2252;">"\n"</span>
     <span style="color: #483d8b;">:header-prefix</span> (<span style="color: #8b2252;">""</span> <span style="color: #8b2252;">""</span> <span style="color: #8b2252;">"### "</span> <span style="color: #8b2252;">"#### "</span> <span style="color: #8b2252;">"##### "</span> <span style="color: #8b2252;">"###### "</span>)
     <span style="color: #483d8b;">:body-section-header-prefix</span> (<span style="color: #8b2252;">""</span> <span style="color: #8b2252;">""</span> <span style="color: #8b2252;">"### "</span> <span style="color: #8b2252;">"#### "</span> <span style="color: #8b2252;">"##### "</span> <span style="color: #8b2252;">"###### "</span>)
     <span style="color: #483d8b;">:body-section-header-format</span> <span style="color: #8b2252;">"%s\n"</span>
     <span style="color: #483d8b;">:body-section-header-suffix</span> (?= ?- <span style="color: #8b2252;">""</span>)
     <span style="color: #483d8b;">:body-header-section-numbers</span> nil
     <span style="color: #483d8b;">:body-header-section-number-format</span> <span style="color: #8b2252;">"%s) "</span>
     <span style="color: #483d8b;">:body-line-format</span> <span style="color: #8b2252;">"%s\n"</span>
     <span style="color: #483d8b;">:body-newline-paragraph</span> <span style="color: #8b2252;">"\n"</span>
     <span style="color: #483d8b;">:bold-format</span> <span style="color: #8b2252;">"**%s**"</span>
     <span style="color: #483d8b;">:italic-format</span> <span style="color: #8b2252;">"_%s_"</span>
     <span style="color: #483d8b;">:verbatim-format</span> <span style="color: #8b2252;">"`%s`"</span>
     <span style="color: #483d8b;">:code-format</span> <span style="color: #8b2252;">"`%s`"</span>
     <span style="color: #483d8b;">:body-line-wrap</span>   75
     )))
</pre>
</div>

<p>
<code>org-set-generic-type</code> を <code>.emacs</code> に追記した後， <code>C-c C-e g &lt;key-binding&gt;</code> とすればよい． <code>&lt;key-binding&gt;</code> は <code>org-set-generic-type</code> で設定する値である．2つ目は，Markdown へのエクスポーターである．<br />
</p>
</div>
</div>

<div id="outline-container-org4b08bea" class="outline-3">
<h3 id="org4b08bea"><span class="section-number-3">10.25</span> <span class="todo TODO">TODO</span> [ox] 出力形式の拡張</h3>
<div class="outline-text-3" id="text-10-25">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"ox"</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq org-export-default-language "ja")</span>
  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ox-pandoc</span> nil t)
  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ox-qmd</span> nil t) <span style="color: #b22222;">;; </span><span style="color: #b22222;">Quita-style</span>
  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ox-gfm</span> nil t)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">Github-style</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2484037" class="outline-3">
<h3 id="org2484037"><span class="section-number-3">10.26</span> [org-odt] ODT形式に出力</h3>
<div class="outline-text-3" id="text-10-26">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(ox-odt)
       <span style="color: #8b2252;">"ox-odt"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"ox-odt"</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-to-list 'org-odt-data-dir</span>
    <span style="color: #b22222;">;;              </span><span style="color: #b22222;">(concat (getenv "HOME") "/Dropbox/emacs.d/config/"))</span>
    (<span style="color: #a020f0;">setq</span> org-odt-styles-file
          (concat (getenv <span style="color: #8b2252;">"HOME"</span>) <span style="color: #8b2252;">"/Dropbox/emacs.d/config/style.odt"</span>))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq org-odt-content-template-file</span>
    <span style="color: #b22222;">;;       </span><span style="color: #b22222;">(concat (getenv "HOME") "/Dropbox/emacs.d/config/style.ott"))</span>
    (<span style="color: #a020f0;">setq</span> org-odt-preferred-output-format <span style="color: #8b2252;">"pdf"</span>) <span style="color: #b22222;">;; </span><span style="color: #b22222;">docx</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">;; ox-odt.el &#12398; &#33258;&#20316;&#12497;&#12483;&#12481;&#12398;&#22793;&#25968;&#65288;DOCSTRING&#12364;&#35352;&#36848;&#12373;&#12428;&#12390;&#12356;&#12394;&#12356;&#65289;</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq org-odt-apply-custom-punctuation t)</span>
    (<span style="color: #a020f0;">setq</span> org-odt-convert-processes
          '((<span style="color: #8b2252;">"LibreOffice"</span>
             <span style="color: #8b2252;">"/Applications/LibreOffice.app/Contents/MacOS/soffice --headless --convert-to %f%x --outdir %d %i"</span>)
            (<span style="color: #8b2252;">"unoconv"</span> <span style="color: #8b2252;">"unoconv -f %f -o %d %i"</span>)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org43b04fd" class="outline-3">
<h3 id="org43b04fd"><span class="section-number-3">10.27</span> [ox-twbs] Twitter Bootstrap 互換のHTML出力</h3>
<div class="outline-text-3" id="text-10-27">
<ul class="org-ul">
<li><a href="https://github.com/marsmining/ox-twbs">marsmining/ox-twbs: Export org-mode docs as HTML compatible with Twitter Bootstrap.</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"ox"</span>
  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ox-twbs</span> nil t))
</pre>
</div>

<p>
次のようなファイルを準備して org ファイルのヘッダで指定（ <code>#+SETUPFILE: theme-readtheorg.setup</code> ）するだけで， <a href="https://takaxp.github.io/">https://takaxp.github.io/</a> のような HTML 出力もできます．<br />
</p>

<ul class="org-ul">
<li><a href="https://lists.gnu.org/archive/html/emacs-orgmode/2016-06/msg00119.html">{O} Org HTML export (ReadTheOrg)</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-org" id="orge1724e1"><span style="color: #b22222;"># -*- mode: org; -*-</span>

<span style="color: #b22222;">#+HTML_HEAD: &lt;link rel="stylesheet" type="text/css" href="<a href="https://www.pirilampo.org/styles/readtheorg/css/htmlize.css&quot;/">https://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/</a>&gt;</span>
<span style="color: #b22222;">#+HTML_HEAD: &lt;link rel="stylesheet" type="text/css" href="<a href="https://www.pirilampo.org/styles/readtheorg/css/readtheorg.css&quot;/">https://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/</a>&gt;</span>

<span style="color: #b22222;">#+HTML_HEAD: &lt;script src="<a href="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js">https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js</a>"&gt;&lt;/script&gt;</span>
<span style="color: #b22222;">#+HTML_HEAD: &lt;script src="<a href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js">https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js</a>"&gt;&lt;/script&gt;</span>
<span style="color: #b22222;">#+HTML_HEAD: &lt;script type="text/javascript" src="<a href="https://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.min.js">https://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.min.js</a>"&gt;&lt;/script&gt;</span>
<span style="color: #b22222;">#+HTML_HEAD: &lt;script type="text/javascript" src="<a href="https://www.pirilampo.org/styles/readtheorg/js/readtheorg.js">https://www.pirilampo.org/styles/readtheorg/js/readtheorg.js</a>"&gt;&lt;/script&gt;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgabe413a" class="outline-3">
<h3 id="orgabe413a"><span class="section-number-3">10.28</span> [org-crypt] ツリーを暗号化する</h3>
<div class="outline-text-3" id="text-10-28">
<p>
<code>M-x org-encrypt-entry</code> でカーソル位置のツリーを暗号化できます．復号は， <code>M-x org-decrypt-entry</code> にて．ただし，バッファのバックアップファイルが生成されていることに気をつけてください．自分の場合は，バックアップファイルは外部ホストに同期されない設定にしてあるので，とりあえず問題なしと考えています．<br />
</p>

<p>
<code>M-x org-encrypt-entries</code> で，特定のタグが付けられたツリーを一括処理することもできますが，私は安全性を考慮して使っていません．<br />
</p>

<p>
なお，実戦投入には十分なテストをしてからの方がよいでしょう．org バッファを外部ホストと同期している場合，転送先のホストでも暗号化／復号ができるかを確認するべきです．他方のホストでツリーにドロワーが付くと，復号できなくなったりします．その時は慌てずにプロパティのドロワーを削除すればOKです．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-crypt</span> nil t)
    (<span style="color: #a020f0;">setq</span> org-crypt-key <span style="color: #8b2252;">"&lt;insert your key&gt;"</span>)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">org-encrypt-entries &#12398;&#24433;&#38911;&#12434;&#21463;&#12369;&#12427;&#12479;&#12464;&#12434;&#25351;&#23450;</span>
    (<span style="color: #a020f0;">setq</span> org-tags-exclude-from-inheritance (<span style="color: #a020f0;">quote</span> (<span style="color: #8b2252;">"secret"</span>)))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#33258;&#21205;&#20445;&#23384;&#12398;&#30906;&#35469;&#12434;&#28961;&#21177;&#12395;</span>
    (<span style="color: #a020f0;">setq</span> org-crypt-disable-auto-save 'nil)
    (define-key org-mode-map (kbd <span style="color: #8b2252;">"C-c f c e"</span>) 'org-encrypt-entry)
    (define-key org-mode-map (kbd <span style="color: #8b2252;">"C-c f c d"</span>) 'org-decrypt-entry)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org41f2bc1" class="outline-3">
<h3 id="org41f2bc1"><span class="section-number-3">10.29</span> [org-mac-link] 外部アプリから情報を取る</h3>
<div class="outline-text-3" id="text-10-29">
<p>
<code>org-mac-link</code> を使うと，外部アプリの表示状態をリンクとして取得して，orgバッファに流し込めます．Mac環境用です．簡単な例ではURLで，取得したリンクを <code>C-c C-o</code> で開けばブラウザが起動してリンク先が表示できます．同じ話を，ファインダーで表示しているディレクトリ，メーラーで表示していた特定のメール，PDFビューアで表示していた特定のファイルの特定のページなどで実施できます．対応している外部アプリは，Finder, Mail.app, Outlook, Addressbook, Safari, Firefox, Chrome, そして Skimです．<br />
</p>

<p>
次のように設定すると，org-modeの時に <code>C-c c</code> すればミニバッファにどのアプリからリンク情報を取るか選べます．Chrome には <code>c</code> が当たっているので，ブラウジング中に記になる記事があったらEmacsに切り替えて， <code>C-c c c</code> とすると，URLが自動でバッファに入ります．単なるURLではなく，タイトルで表示されるのでわかりやすいです．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-to-list 'org-modules 'org-mac-iCal)</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-to-list 'org-modules 'org-mac-link) ;; includes org-mac-message</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-mac-iCal</span> nil t)
             (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-mac-link</span> nil t))
    (define-key org-mode-map (kbd <span style="color: #8b2252;">"C-c c"</span>) 'org-mac-grab-link)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga21b4c9" class="outline-3">
<h3 id="orga21b4c9"><span class="section-number-3">10.30</span> <span class="todo TODO">TODO</span> Parers3.app からリンクを取得する</h3>
<div class="outline-text-3" id="text-10-30">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org-mac-link"</span>
  (<span style="color: #a020f0;">defcustom</span> <span style="color: #a0522d;">org-mac-grab-Papers-app-p</span> t
    <span style="color: #8b2252;">"Add menu option [P]apers to grab links from the Papers.app."</span>
    <span style="color: #483d8b;">:tag</span> <span style="color: #8b2252;">"Grab Papers.app links"</span>
    <span style="color: #483d8b;">:group</span> 'org-mac-link
    <span style="color: #483d8b;">:type</span> 'boolean)

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">org-mac-papers-insert-frontmost-paper-link</span> ()
    (<span style="color: #a020f0;">interactive</span>)
    (<span style="color: #a020f0;">let</span> ((result (org-mac-papers-get-frontmost-paper-link)))
      (<span style="color: #a020f0;">if</span> result
          (insert result)
        (message <span style="color: #8b2252;">"Please open Papers.app and select a paper."</span>))))

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">org-mac-papers-get-frontmost-paper-link</span> ()
    (<span style="color: #a020f0;">interactive</span>)
    (message <span style="color: #8b2252;">"Applescript: Getting Papers link..."</span>)
    (<span style="color: #a020f0;">let</span> ((result (org-as-mac-papers-get-paper-link)))
      (<span style="color: #a020f0;">if</span> (<span style="color: #a020f0;">or</span> (eq result nil) (string= result <span style="color: #8b2252;">""</span>))
          nil
        (org-mac-paste-applescript-links result))))

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">org-as-mac-papers-get-paper-link</span> ()
    (do-applescript
     (concat
      <span style="color: #8b2252;">"if application \"Papers\" is running then\n"</span>
      <span style="color: #8b2252;">" tell application \"Papers\" to activate\n"</span>
      <span style="color: #8b2252;">" delay 0.3\n"</span>
      <span style="color: #8b2252;">" set the clipboard to \"\"\n"</span>
      <span style="color: #8b2252;">" tell application \"System Events\" to tell process \"Papers\"\n"</span>
      <span style="color: #8b2252;">"   keystroke \"l\" using {command down, shift down}\n"</span>
      <span style="color: #8b2252;">" end tell\n"</span>
      <span style="color: #8b2252;">" delay 0.2\n"</span>
      <span style="color: #8b2252;">" set aLink to the clipboard\n"</span>
      <span style="color: #8b2252;">" tell application \"System Events\" to tell process \"Papers\"\n"</span>
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">"    keystroke \"c\" using {command down, alt down\}\n"</span>
      <span style="color: #8b2252;">"   keystroke \"m\" using {command down, option down</span><span style="color: #ff0000; font-weight: bold;">\</span><span style="color: #8b2252;">}\n"</span>
      <span style="color: #8b2252;">" end tell\n"</span>
      <span style="color: #8b2252;">" delay 0.2\n"</span>
      <span style="color: #8b2252;">" set aName to the clipboard\n"</span>
      <span style="color: #8b2252;">" tell application \"Emacs\" to activate\n"</span>
      <span style="color: #8b2252;">" return (get aLink) &amp; \"::split::\" &amp; (get aName) as string\n"</span>
      <span style="color: #8b2252;">"else\n"</span>
      <span style="color: #8b2252;">" return\n"</span>
      <span style="color: #8b2252;">"end if\n"</span>)))

  (add-to-list 'org-mac-link-descriptors
               `(<span style="color: #8b2252;">"P"</span> <span style="color: #8b2252;">"apers"</span> org-mac-papers-insert-frontmost-paper-link
                 ,org-mac-grab-Papers-app-p) <span style="color: #ff0000; font-weight: bold;">t))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8ce50e4" class="outline-3">
<h3 id="org8ce50e4"><span class="section-number-3">10.31</span> <span class="todo TODO">TODO</span> Papers3.app のリンクを開けるようにする</h3>
<div class="outline-text-3" id="text-10-31">
<p>
Papers3.app は，各文献に <code>papers3://</code> で始まるURIを割り当てています．このリンクを org バッファにペーストし， <code>org-open-at-point</code> (C-c C-o) で開けるようにします．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  (<span style="color: #a020f0;">when</span> (eq system-type 'darwin)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Open `</span><span style="color: #008b8b;">papers3://</span><span style="color: #b22222;">' link by C-c C-o.</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(org-add-link-type will be obsoleted from Org 9.</span>
    (org-link-set-parameters
     <span style="color: #8b2252;">"papers3"</span>
     <span style="color: #483d8b;">:follow</span> (<span style="color: #a020f0;">lambda</span> (path)
               (<span style="color: #a020f0;">let</span> ((cmd (concat <span style="color: #8b2252;">"open papers3:"</span> path)))
                 (shell-command-to-string cmd)
                 (message <span style="color: #8b2252;">"%s"</span> cmd))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org3d43c2f" class="outline-3">
<h3 id="org3d43c2f"><span class="section-number-3">10.32</span> <span class="todo TODO">TODO</span> [org-attach] 外部ファイルを紐付ける</h3>
<div class="outline-text-3" id="text-10-32">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(org-attach du-org-attachments)
       <span style="color: #8b2252;">"org-attach"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org-attach"</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">org-insert-link &#12391;&#28155;&#20184;&#12501;&#12449;&#12452;&#12523;&#12408;&#12398;&#12522;&#12531;&#12463;&#12434;&#12506;&#12540;&#12473;&#12488;&#12391;&#12365;&#12427;&#12424;&#12358;&#12395;&#12377;&#12427;</span>
    (<span style="color: #a020f0;">setq</span> org-attach-store-link-p t)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#33258;&#21205;&#20184;&#19982;&#12373;&#12428;&#12427;&#12479;&#12464;&#12398;&#21517;&#21069;&#12434;&#22793;&#26356;</span>
    (<span style="color: #a020f0;">setq</span> org-attach-auto-tag <span style="color: #8b2252;">"Attach"</span>)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">git-annex &#12434;&#20351;&#29992;&#12375;&#12394;&#12356;</span>
    (<span style="color: #a020f0;">setq</span> org-attach-git-annex-cutoff nil)

    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">org-attach-directory-absolute</span>
      (concat (getenv <span style="color: #8b2252;">"HOME"</span>)
              <span style="color: #8b2252;">"/Dropbox/org/"</span>
              (<span style="color: #a020f0;">if</span> (boundp 'org-attach-directory)
                  <span style="color: #8b2252;">"data/"</span>)))

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">du-org-attachments</span> ()
      <span style="color: #8b2252;">"Show directory size for org-attachments."</span>
      (<span style="color: #a020f0;">interactive</span>)
      (message <span style="color: #8b2252;">"--- %s"</span>
               (chomp (shell-command-to-string
                       (concat <span style="color: #8b2252;">"/usr/bin/du -sh "</span>
                               org-attach-directory-absolute)))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgad5a5d2" class="outline-3">
<h3 id="orgad5a5d2"><span class="section-number-3">10.33</span> <span class="todo REV2">REV2</span> [org-screenshot] スクリーンショットを貼り付ける</h3>
<div class="outline-text-3" id="text-10-33">
<ul class="org-ul">
<li><a href="https://github.com/dfeich/org-screenshot">dfeich/org-screenshot: screenshots integrated with emacs org mode attachments</a><br /></li>
<li>macOSの場合， <code>screencapture</code> コマンドをキャプチャコマンドとして指定し，オプションに <code>-w</code> を付ければ，任意のウィンドウを指定してキャプチャし，それを保存，orgバッファに添付できる．<br /></li>
<li class="on"><code>[X]</code> ファイル名が挿入されない（./.pngになる）<br /></li>
<li class="off"><code>[&#xa0;]</code> org-attach の git ハンドリングと同期していない<br /></li>
</ul>


<div class="figure">
<p><img src="data/4B/8A23F1-81EE-445B-8982-54B5FAB13645/screenshot-20180315-164532.png" alt="screenshot-20180315-164532.png" /><br />
</p>
</div>

<p>
（How？）<br />
</p>
<ul class="org-ul">
<li class="on"><code>[X]</code> 所定のウィンドウだけをキャプチャする方法<br /></li>
<li class="on"><code>[X]</code> Emacs バッファを抜いてキャプチャする方法<br /></li>
<li class="on"><code>[X]</code> Emacs だけキャプチャする方法<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(org-attach-screenshot)
       <span style="color: #8b2252;">"org-attach-screenshot"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org-attach-screenshot"</span>
    (<span style="color: #a020f0;">when</span> (executable-find <span style="color: #8b2252;">"screencapture"</span>)
      (<span style="color: #a020f0;">setq</span> org-attach-screenshot-command-line <span style="color: #8b2252;">"screencapture -w %f"</span>))
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-org-attach-screenshot</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (org-attach-screenshot t (format-time-string
                                <span style="color: #8b2252;">"screenshot-%Y%m%d-%H%M%S.png"</span>)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orge2012c2" class="outline-3">
<h3 id="orge2012c2"><span class="section-number-3">10.34</span> [org-download] org バッファにD&amp;Dでファイルを保存</h3>
<div class="outline-text-3" id="text-10-34">
<p>
<code>org-attach</code> とペアで使うのが良いでしょう．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-download</span> nil t)
    (<span style="color: #a020f0;">setq</span> org-download-screenshot-method 'screencapture)
    (<span style="color: #a020f0;">setq</span> org-download-method 'attach)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org4a2fbc5" class="outline-3">
<h3 id="org4a2fbc5"><span class="section-number-3">10.35</span> [alerter] イベント通知</h3>
<div class="outline-text-3" id="text-10-35">
<p>
ここでは， <code>terminal-notifier</code> ではなく，事実上，後継アプリと言える <code>alerter</code> を使う設定です．<br />
</p>

<p>
Mac の通知機能を使って，Emacsで発生するイベントをユーザに通知します． <code>org-show-notification-handler</code> に <code>terminal-notifier.app</code> を呼ぶ関数をぶら下げることで， <code>org-notify</code> で簡単に通知機能を使えるようになります． <code>appt-disp-window</code> をカスタマイズすれば， appt を経由して TODOのアイテムも通知されます．<br />
</p>

<p>
<code>ns-notification-sound</code> に OSで定められたアラーム音を設定できます．音楽を流したい時は， <code>org-show-notification-handler</code> の引数で指定すると設定できます．<br />
</p>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">sticky</th>
<th scope="col" class="org-left">sound</th>
<th scope="col" class="org-left">Function</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">pomodoro</td>
<td class="org-left">nil</td>
<td class="org-left">Glass</td>
<td class="org-left">my-pomodoro-notify</td>
</tr>

<tr>
<td class="org-left">org-notify</td>
<td class="org-left">t</td>
<td class="org-left">default</td>
<td class="org-left">my-desktop-notification-handler</td>
</tr>

<tr>
<td class="org-left">trigger.org</td>
<td class="org-left">select</td>
<td class="org-left">default</td>
<td class="org-left">my-desktop-notify</td>
</tr>

<tr>
<td class="org-left">appt</td>
<td class="org-left">select</td>
<td class="org-left">Glass/Pop</td>
<td class="org-left">advice:appt-disp-window</td>
</tr>
</tbody>
</table>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">pomodoro</td>
<td class="org-left">pomodoro loop</td>
</tr>

<tr>
<td class="org-left">org-notify</td>
<td class="org-left">orgからの通知</td>
</tr>

<tr>
<td class="org-left">trigger.org</td>
<td class="org-left">Alarms on a table</td>
</tr>

<tr>
<td class="org-left">appt</td>
<td class="org-left">TODO items with deadline</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Select from Preferences: { Funk | Glass | ... | Purr | Pop ... }</span>
  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">ns-default-notification-sound</span> <span style="color: #8b2252;">"Pop"</span>)

  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">ns-alerter-command</span>
    (executable-find <span style="color: #8b2252;">"/Users/taka/Dropbox/bin/alerter"</span>)
    <span style="color: #8b2252;">"Path to alerter command. see https://github.com/vjeantet/alerter"</span>)

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-desktop-notification</span> (title message <span style="color: #228b22;">&amp;optional</span> sticky sound timeout)
    <span style="color: #8b2252;">"Show a message by `</span><span style="color: #008b8b;">alerter</span><span style="color: #8b2252;">' command."</span>
    (start-process
     <span style="color: #8b2252;">"notification"</span> <span style="color: #8b2252;">"*notification*"</span>
     ns-alerter-command
     <span style="color: #8b2252;">"-title"</span> title
     <span style="color: #8b2252;">"-message"</span> message
     <span style="color: #8b2252;">"-sender"</span> <span style="color: #8b2252;">"org.gnu.Emacs"</span>
     <span style="color: #8b2252;">"-timeout"</span> (format <span style="color: #8b2252;">"%s"</span> (<span style="color: #a020f0;">if</span> sticky 0 (<span style="color: #a020f0;">or</span> timeout 7)))
     <span style="color: #8b2252;">"-sound"</span> (<span style="color: #a020f0;">or</span> sound ns-default-notification-sound)))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">eval (org-notify "hoge") to test this setting</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-desktop-notification-handler</span> (message)
    (my-desktop-notification <span style="color: #8b2252;">"Message from org-mode"</span> message t))
  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
    (<span style="color: #a020f0;">when</span> ns-alerter-command
      (<span style="color: #a020f0;">setq</span> org-show-notification-handler #'my-desktop-notification-handler))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd9a75ac" class="outline-3">
<h3 id="orgd9a75ac"><span class="section-number-3">10.36</span> [org-grep] org ファイルを grep する</h3>
<div class="outline-text-3" id="text-10-36">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(org-grep)
       <span style="color: #8b2252;">"org-grep"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-M-g"</span>) 'org-grep))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org-grep"</span>
    (<span style="color: #a020f0;">setq</span> org-grep-extensions '(<span style="color: #8b2252;">".org"</span> <span style="color: #8b2252;">".org_archive"</span>))
    (add-to-list 'org-grep-directories <span style="color: #8b2252;">"~/.emacs.d"</span>)
    (add-to-list 'org-grep-directories <span style="color: #8b2252;">"~/.emacs.d/.cask/package"</span>)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">"q"&#25276;&#19979;&#12398;&#25369;&#21205;&#12434;&#35519;&#25972;</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">org-grep-quit</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (delete-window))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">for macOS</span>
    (<span style="color: #a020f0;">when</span> (memq window-system '(mac ns))
      (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">org-grep-from-org-shell-command</span> (regexp)
        (<span style="color: #a020f0;">if</span> org-grep-directories
            (concat <span style="color: #8b2252;">"find -E "</span>
                    (<span style="color: #a020f0;">if</span> org-grep-directories
                        (mapconcat #'identity org-grep-directories <span style="color: #8b2252;">" "</span>)
                      org-directory)
                    (<span style="color: #a020f0;">and</span> org-grep-extensions
                         (concat <span style="color: #8b2252;">" -regex '.*("</span>
                                 (mapconcat #'regexp-quote org-grep-extensions <span style="color: #8b2252;">"|"</span>)
                                 <span style="color: #8b2252;">")$'"</span>))
                    <span style="color: #8b2252;">" -print0 | xargs -0 grep "</span> org-grep-grep-options
                    <span style="color: #8b2252;">" -n -- "</span> (shell-quote-argument regexp))
          <span style="color: #8b2252;">":"</span>)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org930ec66" class="outline-3">
<h3 id="org930ec66"><span class="section-number-3">10.37</span> [ox-reveal] ナイスなHTML5プレゼンテーション出力</h3>
<div class="outline-text-3" id="text-10-37">
<p>
<code>C-c C-e R</code> エクスポータを呼び出せます．続けて <code>B</code> を押せば，ブラウザで出力後の見た目を確認できます．ただし別途 <a href="https://github.com/hakimel/reveal.js">reveal.js</a> が使える状態にないとダメです． <code>org-reveal-root</code> を設定すれば，clone した reveal.js の場所を指定できます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"ox"</span>
  (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ox-reveal</span> nil t)
  (<span style="color: #a020f0;">when</span> (version&lt; <span style="color: #8b2252;">"9.1.4"</span> (org-version))
    (<span style="color: #a020f0;">setq</span> org-reveal-note-key-char ?n)))
</pre>
</div>

<p>
それ以外にも <a href="https://github.com/cybercode/org-slides">ox-s5</a>，<a href="https://github.com/coldnew/org-ioslide">org-ioslide</a> があります．<br />
</p>
</div>
</div>

<div id="outline-container-orgbf32a55" class="outline-3">
<h3 id="orgbf32a55"><span class="section-number-3">10.38</span> README を常に org-mode で開く</h3>
<div class="outline-text-3" id="text-10-38">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(org-mode)
       <span style="color: #8b2252;">"org"</span> nil t)

  (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"[rR][eE][aA][dD][mM][eE]"</span> . org-mode) auto-mode-alist))
</pre>
</div>
</div>
</div>

<div id="outline-container-org2442ee1" class="outline-3">
<h3 id="org2442ee1"><span class="section-number-3">10.39</span> org-mode でアラーム管理</h3>
<div class="outline-text-3" id="text-10-39">
<p>
<del>（注）Growlnotify の代わりに <code>terminal-notifier</code> を使うこともできます．</del><br />
</p>

<p>
<span class="timestamp-wrapper"><span class="timestamp">[2018-03-19 Mon]</span></span>: alerter に統一しました．<br />
</p>

<p>
通知アプリと org-mode のバッファを組み合わせてアラームリストを管理しています．アラームをorgバッファに書き込むだけなので，とても楽です．機能としては，特定のorgバッファに，時刻とアラームの内容を表の形式として保存しておくだけで，Emacs が起動している限りにおいて通知アプリがそのアラームをデスクトップに表示してくれます．つまり，アラームリストは org-mode の表で一覧化されているので，管理も楽ですし，見た目もわかりやすいです．<br />
</p>

<p>
アラームとして解釈される表は，オプション，時刻（HH:MM形式），アラーム内容の3列で構成していればOKです．オプションの列にXを入れておくと，通知アプリがStickyモードで動作するので，アラームを見逃しません．<br />
</p>

<p>
アラームは複数登録することができます．不要になったアラームを削除するのは，単純に表から当該の行を削除するだけで済みます．実際のところは，バッファが保存される時にアラームリストの変更が自動的にシステムに反映されるので，余計な作業は不要です．<br />
</p>

<p>
<code>my-set-alarms-from-file</code> は，<a href="https://pxaka.tokyo/wiki/doku.php?id=emacs:utility.el">utility.el</a>に記述した関数です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">utility</span> nil t)
    (<span style="color: #a020f0;">let</span> ((trigger-file <span style="color: #8b2252;">"~/Dropbox/org/db/trigger.org"</span>))
      (<span style="color: #a020f0;">when</span> (file-exists-p trigger-file)
        (my-set-alarms-from-file <span style="color: #8b2252;">"~/Dropbox/org/db/trigger.org"</span>) <span style="color: #b22222;">;; </span><span style="color: #b22222;">init</span>
        (add-hook 'after-save-hook #'my-update-alarms-from-file))))) <span style="color: #b22222;">;; </span><span style="color: #b22222;">update</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org95433c7" class="outline-3">
<h3 id="org95433c7"><span class="section-number-3">10.40</span> org-mode の latex エクスポート関数をオーバーライド</h3>
<div class="outline-text-3" id="text-10-40">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;; </span><span style="color: #b22222;">Tex export (org-mode -&gt; tex with beamer class) ;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq org-export-latex-classes</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">'(("article"</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">"\\documentclass[11pt]{article}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage[AUTO]{inputenc}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage[T1]{fontenc}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{graphicx}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{longtable}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{float}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{wrapfig}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{soul}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{amssymb}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{hyperref}"</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">("\\section{%s}" . "\\section*{%s}")</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">("\\subsection{%s}" . "\\subsection*{%s}")</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">("\\subsubsection{%s}" . "\\subsubsection*{%s}")</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">("\\paragraph{%s}" . "\\paragraph*{%s}")</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">("\\subparagraph{%s}" . "\\subparagraph*{%s}"))</span>
<span style="color: #b22222;">;;     </span><span style="color: #b22222;">("report"</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">"\\documentclass[11pt]{report}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage[AUTO]{inputenc}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage[T1]{fontenc}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{graphicx}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{longtable}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{float}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{wrapfig}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{soul}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{amssymb}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{hyperref}"</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">("\\part{%s}" . "\\part*{%s}")</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">("\\chapter{%s}" . "\\chapter*{%s}")</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">("\\section{%s}" . "\\section*{%s}")</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">("\\subsection{%s}" . "\\subsection*{%s}")</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">("\\subsubsection{%s}" . "\\subsubsection*{%s}"))</span>
<span style="color: #b22222;">;;     </span><span style="color: #b22222;">("book"</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">"\\documentclass[11pt]{book}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage[AUTO]{inputenc}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage[T1]{fontenc}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{graphicx}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{longtable}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{float}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{wrapfig}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{soul}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{amssymb}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{hyperref}"</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">("\\part{%s}" . "\\part*{%s}")</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">("\\chapter{%s}" . "\\chapter*{%s}")</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">("\\section{%s}" . "\\section*{%s}")</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">("\\subsection{%s}" . "\\subsection*{%s}")</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">("\\subsubsection{%s}" . "\\subsubsection*{%s}"))</span>
<span style="color: #b22222;">;;     </span><span style="color: #b22222;">("beamer"</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">"\\documentclass{beamer}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage[AUTO]{inputenc}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{graphicx}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{longtable}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{float}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{wrapfig}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{amssymb}</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">\\usepackage{hyperref}"</span>
<span style="color: #b22222;">;;      </span><span style="color: #b22222;">org-beamer-sectioning)))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1139fac" class="outline-3">
<h3 id="org1139fac"><span class="section-number-3">10.41</span> [org-autolist] ブリッツの入力を簡単に</h3>
<div class="outline-text-3" id="text-10-41">
<p>
ブリッツの入力や削除を Microsoft Word 的にします．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(org-autolist-mode)
       <span style="color: #8b2252;">"org-autolist"</span> nil t)

  (add-hook 'org-mode-hook #'(lambda () (org-autolist-mode))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org21f10e8" class="outline-3">
<h3 id="org21f10e8"><span class="section-number-3">10.42</span> [org-dashboard] 進捗をプログレスバーで確認</h3>
<div class="outline-text-3" id="text-10-42">
<ul class="org-ul">
<li><a href="https://github.com/bard/org-dashboard">https://github.com/bard/org-dashboard</a><br /></li>
<li>日本語だとバーの表示位置がずれるので修正．PR反映済み．<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(org-dashboard-display)
       <span style="color: #8b2252;">"org-dashboard"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
    (define-key org-mode-map (kbd <span style="color: #8b2252;">"C-c f y"</span>) 'org-dashboard-display)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7df96b9" class="outline-3">
<h3 id="org7df96b9"><span class="section-number-3">10.43</span> [org-clock-today] 今日の総作業時間をモードラインに表示</h3>
<div class="outline-text-3" id="text-10-43">
<ul class="org-ul">
<li><code>CLOCK_MODELINE_TOTAL</code> を設定するのとは別なアプローチ<br /></li>
<li>clock が動いている時だけモードラインに合計値が表示される<br /></li>
<li><a href="https://github.com/mallt/org-clock-today-mode">mallt/org-clock-today-mode: Emacs minor mode to show the total clocked time of the current day in the mode line</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:org-clock-sum-today</span> (<span style="color: #228b22;">&amp;optional</span> headline-filter)
    <span style="color: #8b2252;">"Sum the times for each subtree for today."</span>
    (<span style="color: #a020f0;">let</span> ((range (org-clock-special-range 'today nil t))) <span style="color: #b22222;">;; </span><span style="color: #b22222;">TZ&#32771;&#24942;</span>
      (org-clock-sum (car range) (cadr range)
                     headline-filter <span style="color: #483d8b;">:org-clock-minutes-today</span>)))
  (advice-add 'org-clock-sum-today <span style="color: #483d8b;">:override</span> #'advice:org-clock-sum-today)

  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">org-clock-today</span> nil t)
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:org-clock-today-update-mode-line</span> ()
      <span style="color: #8b2252;">"Calculate the total clocked time of today and update the mode line."</span>
      (<span style="color: #a020f0;">setq</span> org-clock-today-string
            (<span style="color: #a020f0;">if</span> (org-clock-is-active)
                <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12490;&#12525;&#12540;&#12452;&#12531;&#12464;&#12398;&#24433;&#38911;&#12434;&#25490;&#38500;&#12375;&#65292;subtree&#12395;&#38480;&#23450;&#12375;&#12394;&#12356;&#65294;</span>
                (<span style="color: #a020f0;">save-excursion</span>
                  (<span style="color: #a020f0;">save-restriction</span>
                    (<span style="color: #a020f0;">with-current-buffer</span> (org-clock-is-active)
                      (widen)
                      (<span style="color: #a020f0;">let*</span> ((current-sum (org-clock-sum-today))
                             (open-time-difference (time-subtract
                                                    (float-time)
                                                    (float-time
                                                     org-clock-start-time)))
                             (open-seconds (time-to-seconds open-time-difference))
                             (open-minutes (/ open-seconds 60))
                             (total-minutes (+ current-sum
                                               open-minutes)))
                        (concat <span style="color: #8b2252;">" "</span> (org-minutes-to-clocksum-string
                                     total-minutes))))))
              <span style="color: #8b2252;">""</span>))
      (force-mode-line-update))
    (advice-add 'org-clock-today-update-mode-line
                <span style="color: #483d8b;">:override</span> #'advice:org-clock-today-update-mode-line)
    (<span style="color: #a020f0;">unless</span> batch-build
      (org-clock-today-mode 1))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgccc5422" class="outline-3">
<h3 id="orgccc5422"><span class="section-number-3">10.44</span> <span class="todo TODO">TODO</span> [org-recent-headings] 訪問したツリーを記録し簡単に再訪問可能にする</h3>
<div class="outline-text-3" id="text-10-44">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(org-recent-headings-helm)
       <span style="color: #8b2252;">"org-recent-headings"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-c f r"</span>) 'org-recent-headings-helm))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org-recent-headings"</span>
    (custom-set-variables
     '(org-recent-headings-save-file <span style="color: #8b2252;">"~/.emacs.d/org-recent-headings.dat"</span>))
    (<span style="color: #a020f0;">if</span> shutup-p
        (<span style="color: #a020f0;">shut-up</span> (org-recent-headings-mode 1))
      (org-recent-headings-mode 1))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orge9dabd6" class="outline-3">
<h3 id="orge9dabd6"><span class="section-number-3">10.45</span> <span class="todo TODO">TODO</span> [orgnav] ツリーの検索インタフェース</h3>
<div class="outline-text-3" id="text-10-45">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(orgnav-search-root)
       <span style="color: #8b2252;">"orgnav"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
    (define-key org-mode-map (kbd <span style="color: #8b2252;">"C-c f n"</span>)
      #'(lambda () (<span style="color: #a020f0;">interactive</span>)
          (orgnav-search-root 3 'orgnav--goto-action)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org08c00a6" class="outline-3">
<h3 id="org08c00a6"><span class="section-number-3">10.46</span> [org-random-todo] ランダムにタスクを選ぶ</h3>
<div class="outline-text-3" id="text-10-46">
<ul class="org-ul">
<li>デフォルトで <code>org-agenda-files</code> に登録されたファイルからランダムにタスクを選ぶ<br /></li>
<li>org-random-todo はミニバッファに選択したタスクを表示するだけ．<br /></li>
<li>org-random-todo-goto-current 最後に表示したタスクに移動する．<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(autoload-if-found
 '(org-random-todo org-random-todo-goto-current)
 <span style="color: #8b2252;">"org-random-todo"</span> nil t)
</pre>
</div>
</div>
</div>

<div id="outline-container-orga83ebe8" class="outline-3">
<h3 id="orga83ebe8"><span class="section-number-3">10.47</span> <span class="todo TODO">TODO</span> [toc-org] 目次の挿入</h3>
<div class="outline-text-3" id="text-10-47">
<ul class="org-ul">
<li>ツリーに TOC タグを付けて，`toc-org-insert-toc'を実行すればOK<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(autoload-if-found '(toc-org-insert-toc) <span style="color: #8b2252;">"toc-org"</span> nil t)
</pre>
</div>
</div>
</div>

<div id="outline-container-org93fa23b" class="outline-3">
<h3 id="org93fa23b"><span class="section-number-3">10.48</span> [ox-hugo] OrgファイルからHogoの記事をエクスポートする</h3>
<div class="outline-text-3" id="text-10-48">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"ox"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ox-hugo</span> nil t)
    (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">ox-hugo-auto-export</span> nil t)
    (<span style="color: #a020f0;">setq</span> org-hugo-auto-set-lastmod t)
    (<span style="color: #a020f0;">setq</span> org-hugo-suppress-lastmod-period 86400.0) <span style="color: #b22222;">;; </span><span style="color: #b22222;">1 day</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">never copy files to under /static/ directory</span>
    (<span style="color: #a020f0;">setq</span> org-hugo-external-file-extensions-allowed-for-copying nil)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org51c0da7" class="outline-2">
<h2 id="org51c0da7"><span class="section-number-2">11</span> フレーム／ウィンドウ制御</h2>
<div class="outline-text-2" id="text-11">
</div>
<div id="outline-container-org719e535" class="outline-3">
<h3 id="org719e535"><span class="section-number-3">11.1</span> 起動時の設定</h3>
<div class="outline-text-3" id="text-11-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">cond</span>
 ((memq window-system '(mac ns)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">for Macintosh</span>
  (<span style="color: #a020f0;">setq</span> initial-frame-alist
        (append
         '((top . 23)
           (left . 0)
           (alpha . (100 90))
           <span style="color: #b22222;">;; </span><span style="color: #b22222;">(vertical-scroll-bars . nil)</span>
           <span style="color: #b22222;">;; </span><span style="color: #b22222;">(internal-border-width . 20)</span>
           <span style="color: #b22222;">;; </span><span style="color: #b22222;">(ns-appearance . nil) ;; 26.1 {light, dark}</span>
           (ns-transparent-titlebar . t) <span style="color: #b22222;">;; </span><span style="color: #b22222;">26.1</span>
           ) <span style="color: #ff0000; font-weight: bold;">initial-frame-alist)))</span>

 <span style="color: #b22222;">;; </span><span style="color: #b22222;">for Linux</span>
 ((eq window-system 'x)
  (<span style="color: #a020f0;">setq</span> initial-frame-alist
        (append
         '((vertical-scroll-bars . nil)
           (top . 0)
           (left . 0)
           (width . 80)
           (height . 38)
           ) <span style="color: #ff0000; font-weight: bold;">initial-frame-alist)))</span>

 <span style="color: #b22222;">;; </span><span style="color: #b22222;">for Windows</span>
 (t (<span style="color: #a020f0;">setq</span> initial-frame-alist
          (append
           '((vertical-scroll-bars . nil)
             (top . 0)
             (left . 0)
             (width . 80)
             (height . 26)
             ) <span style="color: #ff0000; font-weight: bold;">initial-frame-alist))))</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">Apply the initial setting to default</span>
(<span style="color: #a020f0;">setq</span> default-frame-alist initial-frame-alist)
(set-face-foreground 'vertical-border (face-background 'default))
(set-face-background 'vertical-border (face-background 'default))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(set-face-background 'fringe (face-background 'default))</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12459;&#12540;&#12477;&#12523;&#12398;&#33394;</span>
(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">my-cursor-color-ime-on</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FF9300;">#FF9300</span><span style="color: #8b2252;">"</span>)
(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">my-cursor-color-ime-off</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #91C3FF;">#91C3FF</span><span style="color: #8b2252;">"</span>) <span style="color: #b22222;">;; </span><span style="color: #000000; background-color: #FF9300;">#FF9300</span><span style="color: #b22222;">, </span><span style="color: #000000; background-color: #999999;">#999999</span><span style="color: #b22222;">, </span><span style="color: #000000; background-color: #749CCC;">#749CCC</span>
(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">my-cursor-type-ime-on</span> '(bar . 2)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">'(hbar . 10)</span>
(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">my-cursor-type-ime-off</span> '(bar . 2)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">'(hbar . 10)</span>

(<span style="color: #a020f0;">cond</span>
 ((<span style="color: #a020f0;">or</span> (eq window-system 'ns)
      (fboundp 'mac-get-current-input-source))
  (<span style="color: #a020f0;">when</span> (fboundp 'mac-set-input-method-parameter)
    (mac-set-input-method-parameter
     <span style="color: #8b2252;">"com.google.inputmethod.Japanese.base"</span> 'title <span style="color: #8b2252;">"&#12354;"</span>))

  (<span style="color: #a020f0;">when</span> (fboundp 'mac-get-current-input-source)
    (<span style="color: #a020f0;">declare-function</span> advice:mac-toggle-input-method <span style="color: #8b2252;">"init"</span> nil)
    (<span style="color: #a020f0;">declare-function</span> my-apply-cursor-config <span style="color: #8b2252;">"init"</span> nil)
    (<span style="color: #a020f0;">declare-function</span> my-ime-on <span style="color: #8b2252;">"init"</span> nil)
    (<span style="color: #a020f0;">declare-function</span> my-ime-off <span style="color: #8b2252;">"init"</span> nil)
    (<span style="color: #a020f0;">declare-function</span> my-ime-active-p <span style="color: #8b2252;">"init"</span> nil)
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-ime-active-p</span> ()
      (not (string-match <span style="color: #8b2252;">"\\.Roman$"</span> (mac-get-current-input-source))))
    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-ime-on-hook</span> nil)
    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-ime-off-hook</span> nil)
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-ime-on</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">when</span> (fboundp 'mac-toggle-input-method)
        (mac-toggle-input-method t))
      (<span style="color: #a020f0;">setq</span> cursor-type my-cursor-type-ime-on)
      (set-cursor-color my-cursor-color-ime-on)
      (run-hooks 'my-ime-on-hook))
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-ime-off</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">when</span> (fboundp 'mac-toggle-input-method)
        (mac-toggle-input-method nil))
      (<span style="color: #a020f0;">setq</span> cursor-type my-cursor-type-ime-off)
      (set-cursor-color my-cursor-color-ime-off)
      (run-hooks 'my-ime-off-hook))
    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-ime-flag</span> nil)
    (add-hook 'activate-mark-hook
              #'(lambda ()
                  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">setq</span> my-ime-flag (my-ime-active-p))
                    (my-ime-off))))
    (add-hook 'deactivate-mark-hook
              #'(lambda ()
                  (<span style="color: #a020f0;">when</span> my-ime-flag
                    (my-ime-on))))
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:mac-toggle-input-method</span> (<span style="color: #228b22;">&amp;optional</span> arg)
      <span style="color: #8b2252;">"Run hooks when IME changes."</span>
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">if</span> arg
          (<span style="color: #a020f0;">progn</span>
            (<span style="color: #a020f0;">setq</span> cursor-type my-cursor-type-ime-on)
            (set-cursor-color my-cursor-color-ime-on)
            (run-hooks 'my-ime-on-hook))
        (<span style="color: #a020f0;">progn</span>
          (<span style="color: #a020f0;">setq</span> cursor-type my-cursor-type-ime-off)
          (set-cursor-color my-cursor-color-ime-off)
          (run-hooks 'my-ime-off-hook))))
    (advice-add 'mac-toggle-input-method
                <span style="color: #483d8b;">:before</span> #'advice:mac-toggle-input-method)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">for init setup</span>
    (<span style="color: #a020f0;">setq-default</span> cursor-type my-cursor-type-ime-on)

    (<span style="color: #a020f0;">when</span> (boundp 'mac-ime-cursor-type) <span style="color: #b22222;">;; </span><span style="color: #b22222;">private patch</span>
      (<span style="color: #a020f0;">setq</span> mac-ime-cursor-type my-cursor-type-ime-on))

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-apply-cursor-config</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">if</span> (my-ime-active-p)
          (<span style="color: #a020f0;">progn</span>
            (<span style="color: #a020f0;">setq</span> cursor-type my-cursor-type-ime-on)
            (set-cursor-color my-cursor-color-ime-on))
        (<span style="color: #a020f0;">setq</span> cursor-type my-cursor-type-ime-off)
        (set-cursor-color my-cursor-color-ime-off)))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(my-apply-cursor-config) will be called later in this file.</span>

    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
      (run-with-idle-timer 3 t #'my-apply-cursor-config))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Enter minibuffer with IME-off, and resture the latest IME</span>
    (add-hook 'minibuffer-setup-hook
              #'(lambda ()
                  (<span style="color: #a020f0;">if</span> (not (my-ime-active-p))
                      (<span style="color: #a020f0;">setq</span> my-ime-flag nil)
                    (<span style="color: #a020f0;">setq</span> my-ime-flag t)
                    (my-ime-off))))
    (add-hook 'minibuffer-exit-hook
              #'(lambda ()
                  (<span style="color: #a020f0;">when</span> my-ime-flag
                    (my-ime-on))))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(defun advice:find-file (FILENAME &amp;optional WILDCARDS)</span>
    <span style="color: #b22222;">;;   </span><span style="color: #b22222;">"Extension to find-file as before-find-file-hook."</span>
    <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(message "--- advice:findfile")</span>
    <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(apply FILENAME WILDCARDS))</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(advice-add #'find-file :around #'advice:find-file)</span>

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">http://tezfm.blogspot.jp/2009/11/cocoa-emacs.html</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12496;&#12483;&#12501;&#12449;&#20999;&#26367;&#26178;&#12395; input method &#12434;&#20999;&#12426;&#26367;&#12360;&#12427;</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(with-eval-after-load "postpone"</span>
    <span style="color: #b22222;">;;   </span><span style="color: #b22222;">(when (and (fboundp 'mac-handle-input-method-change)</span>
    <span style="color: #b22222;">;;              </span><span style="color: #b22222;">(require 'cl nil t))</span>
    <span style="color: #b22222;">;;     </span><span style="color: #b22222;">(add-hook</span>
    <span style="color: #b22222;">;;      </span><span style="color: #b22222;">'post-command-hook</span>
    <span style="color: #b22222;">;;      </span><span style="color: #b22222;">(lexical-let ((previous-buffer nil))</span>
    <span style="color: #b22222;">;;        </span><span style="color: #b22222;">(message "Change IM %S -&gt; %S" previous-buffer (current-buffer))</span>
    <span style="color: #b22222;">;;        </span><span style="color: #b22222;">#'(lambda ()</span>
    <span style="color: #b22222;">;;            </span><span style="color: #b22222;">(unless (eq (current-buffer) previous-buffer)</span>
    <span style="color: #b22222;">;;              </span><span style="color: #b22222;">(when (bufferp previous-buffer)</span>
    <span style="color: #b22222;">;;                </span><span style="color: #b22222;">(mac-handle-input-method-change))</span>
    <span style="color: #b22222;">;;              </span><span style="color: #b22222;">(setq previous-buffer (current-buffer))))))))</span>
    ))

 ((eq window-system 'mac) <span style="color: #b22222;">;; </span><span style="color: #b22222;">EMP: Emacs Mac Port</span>
  (<span style="color: #a020f0;">when</span> (fboundp 'mac-input-source)
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-mac-keyboard-input-source</span> ()
      (<span style="color: #a020f0;">if</span> (string-match <span style="color: #8b2252;">"\\.Roman$"</span> (mac-input-source))
          (<span style="color: #a020f0;">progn</span>
            (<span style="color: #a020f0;">setq</span> cursor-type my-cursor-type-ime-off)
            (add-to-list 'default-frame-alist
                         `(cursor-type . ,my-cursor-type-ime-off))
            (set-cursor-color my-cursor-color-ime-off))
        (<span style="color: #a020f0;">progn</span>
          (<span style="color: #a020f0;">setq</span> cursor-type my-cursor-type-ime-on)
          (add-to-list 'default-frame-alist
                       `(cursor-type . ,my-cursor-type-ime-on))
          (set-cursor-color my-cursor-color-ime-on))))

    (<span style="color: #a020f0;">when</span> (fboundp 'mac-auto-ascii-mode)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">(mac-auto-ascii-mode 1)</span>
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">IME ON/OFF &#12391;&#12459;&#12540;&#12477;&#12523;&#12398;&#31278;&#21029;&#12420;&#33394;&#12434;&#26367;&#12360;&#12427;</span>
      (add-hook 'mac-selected-keyboard-input-source-change-hook
                #'my-mac-keyboard-input-source)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">IME ON &#12398;&#33521;&#35486;&#20837;&#21147;&#65291;&#27770;&#23450;&#24460;&#12391;&#12418;&#12459;&#12540;&#12477;&#12523;&#12398;&#31278;&#21029;&#12420;&#33394;&#12434;&#26367;&#12360;&#12427;</span>
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-hook 'mac-enabled-keyboard-input-sources-change-hook</span>
      <span style="color: #b22222;">;;           </span><span style="color: #b22222;">'my-mac-keyboard-input-source)</span>

      (<span style="color: #a020f0;">declare-function</span> my-mac-keyboard-input-source <span style="color: #8b2252;">"init"</span> nil)
      (my-mac-keyboard-input-source))))

 (t nil))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga2df16e" class="outline-3">
<h3 id="orga2df16e"><span class="section-number-3">11.2</span> 複数フレーム対応</h3>
<div class="outline-text-3" id="text-11-2">
<p>
フレームを複数使う場合の設定です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:make-frame</span> ()
    (my-apply-theme)
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">moom-font</span> nil t)
      (moom-font-resize)))
  (advice-add 'make-frame <span style="color: #483d8b;">:after</span> #'advice:make-frame)
  (global-set-key (kbd <span style="color: #8b2252;">"M-`"</span>) 'other-frame))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbc06ee7" class="outline-3">
<h3 id="orgbc06ee7"><span class="section-number-3">11.3</span> [e2wm.el] 二画面表示</h3>
<div class="outline-text-3" id="text-11-3">
<ol class="org-ol">
<li><a href="http://github.com/kiwanami/emacs-window-manager/raw/master/e2wm.el">http://github.com/kiwanami/emacs-window-manager/raw/master/e2wm.el</a><br /></li>
<li><a href="http://github.com/kiwanami/emacs-window-layout/raw/master/window-layout.el">http://github.com/kiwanami/emacs-window-layout/raw/master/window-layout.el</a><br /></li>
</ol>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(my-e2wm:dp-two e2wm:dp-two e2wm:start-management)
       <span style="color: #8b2252;">"e2wm"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"e2wm"</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-e2wm:dp-two</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (e2wm:dp-two)
      (<span style="color: #a020f0;">setq</span> e2wm:c-two-recipe
            '(- (<span style="color: #483d8b;">:lower-size</span> 10)
                (| left right)
                sub))
      (<span style="color: #a020f0;">setq</span> e2wm:c-two-winfo
            '((<span style="color: #483d8b;">:name</span> left )
              (<span style="color: #483d8b;">:name</span> right )
              (<span style="color: #483d8b;">:name</span> sub <span style="color: #483d8b;">:default-hide</span> t)))

      <span style="color: #b22222;">;; </span><span style="color: #b22222;">left, prev</span>
      (<span style="color: #a020f0;">setq</span> e2wm:c-two-right-default 'left))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#39640;&#12373;&#12434;&#30011;&#38754;&#12398;&#26368;&#22823;&#12395;&#30703;&#27491;</span>
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">moom</span> nil t)
      (<span style="color: #a020f0;">setq</span> moom-frame-height-tall (moom-max-frame-height))
      (<span style="color: #a020f0;">setq</span> moom-frame-height-small moom-frame-height-tall))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#24133;&#12434;&#30011;&#38754;&#12398;&#26368;&#22823;&#12395;&#30703;&#27491;</span>
    (add-hook 'e2wm:pre-start-hook
              #'(lambda ()
                  (set-frame-width
                   (selected-frame)
                   (/ (- (display-pixel-width) 30) (frame-char-width)))))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#24133;&#12434;&#12487;&#12501;&#12457;&#12523;&#12488;&#20516;&#12395;&#25147;&#12377;</span>
    (add-hook 'e2wm:post-stop-hook
              #'(lambda ()
                  (set-frame-width (selected-frame)
                                   moom--frame-width)))

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">To avoid rebooting issue when using desktop.el and recentf.el</span>
    (add-hook 'kill-emacs-hook
              #'(lambda ()
                  (<span style="color: #a020f0;">when</span> (fboundp 'e2wm:stop-management)
                    (e2wm:stop-management))))))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">setting for e2wm</span>
(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(change-frame-double-window
         change-frame-single-window)
       <span style="color: #8b2252;">"frame-ctr-e2wm"</span> nil t)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Set the frame width single size</span>
  <span style="color: #b22222;">;;  </span><span style="color: #b22222;">C-u C-x - =&gt; e2wm OFF, single size width and double height, move center</span>
  (global-set-key (kbd <span style="color: #8b2252;">"C-x -"</span>) 'change-frame-single-window)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Set the frame width double size</span>
  <span style="color: #b22222;">;;  </span><span style="color: #b22222;">C-u C-x = =&gt; e2wm ON, double size width and height, move to the center</span>
  (global-set-key (kbd <span style="color: #8b2252;">"C-x ="</span>) 'change-frame-double-window))
</pre>
</div>
</div>
</div>

<div id="outline-container-org76f74dd" class="outline-3">
<h3 id="org76f74dd"><span class="section-number-3">11.4</span> [moom.el] キーボードでフレームの場所を移す</h3>
<div class="outline-text-3" id="text-11-4">
<p>
(2017-07-30) frame-ctr から moom.el にリネームしました．Moom は，Many Tricks がリリースするソフトウェアで，今後はこのソフトウェアのポーティングを目指します．<br />
</p>

<p>
拙作の <a href="https://github.com/takaxp/moom">moom.el</a> を使います．<br />
</p>

<p>
ビルトインに <code>face-remap</code> があり，アスキーフォントは <code>C-x C--</code> と <code>C-x C-=</code> で拡大縮小を制御できます．以下のキーバインドは，face-remap.el が提供する text-scale-adjust のキーバインドを上書きします． <code>text-scale-adjust</code> をそのまま使っても，日本語フォントが制御されないので，オーバーライドしてしまってもOKだと思います．<br />
</p>

<p>
近しいパッケージに， <code>WindMove</code> と <code>FrameMove</code> がありますが，これらは基本的にカーソルの移動を目的にしています．<br />
</p>

<ul class="org-ul">
<li><a href="https://www.emacswiki.org/emacs/WindMove">{Home} Wind Move</a> (ビルトイン)<br />
<ul class="org-ul">
<li>ウィンドウ間のカーソル移動を改善<br /></li>
</ul></li>
<li><a href="https://www.emacswiki.org/emacs/FrameMove">{Home} Frame Move</a><br />
<ul class="org-ul">
<li>フレーム間のカーソル移動を改善<br /></li>
</ul></li>
</ul>

<p>
また類似のパッケージに <code>frame-cmds</code> があります．<br />
</p>

<ol class="org-ol">
<li><a href="http://www.emacswiki.org/emacs/download/frame-cmds.el">http://www.emacswiki.org/emacs/download/frame-cmds.el</a><br /></li>
<li><a href="http://www.emacswiki.org/emacs/download/frame-fns.el">http://www.emacswiki.org/emacs/download/frame-fns.el</a><br /></li>
</ol>

<p>
<code>moom-autuloads</code> に必要なコマンドを <del>羅列していますが，</del> <code>melpa</code> でインストールする場合は関係ありません．パッケージ内で autoload 指定してあります． <code>with-eval-after-load</code> の中だけを設定すれば十分です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">moom-autoloads</span>
  '(moom-cycle-frame-height
    moom-move-frame-to-edge-top moom-move-frame my-frame-reset
    moom-toggle-frame-maximized
    moom-move-frame-to-center moom-move-frame-right moom-move-frame-left
    moom-fill-display-band moom-move-frame-to-edge-right moom-fill-band
    moom-change-frame-width moom-change-frame-width-double
    moom-change-frame-width-single))

(<span style="color: #a020f0;">when</span> (autoload-if-found moom-autoloads <span style="color: #8b2252;">"moom"</span> nil t)
  (global-set-key (kbd <span style="color: #8b2252;">"&lt;f2&gt;"</span>) 'moom-cycle-frame-height)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"moom"</span>))
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">moom</span> nil t)
               window-system)
      (<span style="color: #a020f0;">setq</span> moom-lighter <span style="color: #8b2252;">"M"</span>)
      (<span style="color: #a020f0;">setq</span> moom-verbose t)
      (moom-recommended-keybindings 'all)
      (moom-mode 1))))

(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(moom-font-increase
         moom-font-decrease moom-font-size-reset moom-font-resize)
       <span style="color: #8b2252;">"moom-font"</span> nil t)

  (add-hook 'moom-font-after-resize-hook #'moom-expand-height)
  (add-hook 'moom-font-after-resize-hook #'moom-move-frame-to-edge-top)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"moom-font"</span>
    (<span style="color: #a020f0;">setq</span> moom-scaling-gradient (/ (float 50) 30))
    (<span style="color: #a020f0;">setq</span> moom-font-table
          '((50 30) (49 29) (48 29) (47 28) (46 28) (45 27) (44 26) (43 26)
            (42 25) (41 25) (40 24) (39 23) (38 23) (37 22) (36 22) (35 21)
            (34 20) (33 20) (32 19) (31 19) (30 18) (29 17) (28 17) (27 16)
            (26 16) (25 15) (24 14) (23 14) (22 13) (21 13) (20 12) (19 11)
            (18 11) (17 10) (16 10) (15 9) (14 8) (13 8) (12 7) (11 7) (10 6)
            (9 5) (8 5) (7 4) (6 4) (5 3)))))
</pre>
</div>
</div>

<div id="outline-container-orge0c880d" class="outline-4">
<h4 id="orge0c880d"><span class="section-number-4">11.4.1</span> 最大化時にモードラインを消す</h4>
<div class="outline-text-4" id="text-11-4-1">
<p>
バッファの切替時にモードラインの状態を引き継ぐこともできますが，とりあえず想定外にしています．代わりに，必要ならば <code>M-x my-moom-toggle-mode-line</code> で表示可能にしています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-moom--mode-line-format</span> nil)
(make-variable-buffer-local 'my-moom--mode-line-format)
(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(my-moom-mode-line-off my-moom-toggle-mode-line)
       <span style="color: #8b2252;">"moom"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"pomodoro"</span>
    (set-default 'my-moom--mode-line-format mode-line-format)
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-moom-mode-line-off</span> ()
      <span style="color: #8b2252;">"Turn off mode line."</span>
      (<span style="color: #a020f0;">setq</span> my-moom--mode-line-format mode-line-format)
      (pomodoro:visualize-stop)
      (<span style="color: #a020f0;">setq</span> mode-line-format nil))

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-moom-toggle-mode-line</span> ()
      <span style="color: #8b2252;">"Toggle mode line."</span>
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">when</span> mode-line-format
        (<span style="color: #a020f0;">setq</span> my-moom--mode-line-format mode-line-format))
      (<span style="color: #a020f0;">if</span> mode-line-format
          (<span style="color: #a020f0;">progn</span>
            (<span style="color: #a020f0;">when</span> (fboundp 'dimmer-mode)
              (dimmer-mode 1))
            (<span style="color: #a020f0;">when</span> (fboundp 'pomodoro:visualize-stop)
              (pomodoro:visualize-stop))
            (<span style="color: #a020f0;">setq</span> mode-line-format nil))
        (<span style="color: #a020f0;">when</span> (fboundp 'dimmer-mode)
          (dimmer-mode -1))
        (<span style="color: #a020f0;">when</span> (fboundp 'pomodoro:visualize-start)
          (pomodoro:visualize-start))
        (<span style="color: #a020f0;">setq</span> mode-line-format my-moom--mode-line-format)
        (redraw-frame))
      (message <span style="color: #8b2252;">"%s"</span> (<span style="color: #a020f0;">if</span> mode-line-format <span style="color: #8b2252;">"( &#9593; &#9697;&#9593;)&#65346; ON !"</span> <span style="color: #8b2252;">"( &#9593; ^&#9593;)&#65360; OFF!"</span>)))

    (<span style="color: #a020f0;">unless</span> batch-build
      (my-moom-toggle-mode-line))
    (define-key moom-mode-map (kbd <span style="color: #8b2252;">"&lt;f5&gt;"</span>) 'my-moom-toggle-mode-line)
    (add-hook 'find-file-hook #'my-moom-mode-line-off))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"moom"</span>
    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-moom-hide-mode-line</span> t)
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:moom-toggle-frame-maximized</span> ()
      (<span style="color: #a020f0;">when</span> mode-line-format
        (<span style="color: #a020f0;">setq</span> my-moom--mode-line-format mode-line-format))
      (<span style="color: #a020f0;">when</span> my-moom-hide-mode-line
        (<span style="color: #a020f0;">setq</span> mode-line-format
              (<span style="color: #a020f0;">if</span> moom--maximized nil my-moom--mode-line-format))
        (message <span style="color: #8b2252;">" "</span>)))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(advice-add 'moom-toggle-frame-maximized</span>
    <span style="color: #b22222;">;;             </span><span style="color: #b22222;">:after #'advice:moom-toggle-frame-maximized)</span>
    ))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org738af7b" class="outline-3">
<h3 id="org738af7b"><span class="section-number-3">11.5</span> [popwin.el] ポップアップウィンドウの制御</h3>
<div class="outline-text-3" id="text-11-5">
<ul class="org-ul">
<li><a href="https://github.com/m2ym/popwin-el/">https://github.com/m2ym/popwin-el/</a><br /></li>
<li>popwin:display-buffer を autoload してもうまくいかない．<br /></li>
<li>現在は緩やかに <code>shackle</code> に移行中です．<br />
<ul class="org-ul">
<li>ただし， <code>dedicated</code> オプションが使えないので，ウィンドウからフォーカスが外れた時に自動的にウィンドウを消すことができません．<br /></li>
</ul></li>
</ul>

<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">for emacs 24.1</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq special-display-function 'popwin:special-display-popup-window)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq display-buffer-function 'popwin:display-buffer)</span>

<span style="color: #b22222;">;; </span><span style="color: #b22222;">for emacs 24.3</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq special-display-alist 'popwin:special-display-popup-window)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq display-buffer-alist 'popwin:display-buffer)</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(push '("*sdic*" :position top) popwin:special-display-config)</span>

(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">popwin</span> nil t)
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"popwin-mode"</span>)
      (popwin-mode 1))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Performed</span>
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"*Help*"</span> <span style="color: #483d8b;">:height</span> 20 <span style="color: #483d8b;">:position</span> top <span style="color: #483d8b;">:dedicated</span> t)
          popwin:special-display-config)
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"*osx-dictionary*"</span> <span style="color: #483d8b;">:height</span> 20 <span style="color: #483d8b;">:position</span> top <span style="color: #483d8b;">:dedicated</span> t)
          popwin:special-display-config)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Checking...</span>
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"*Checkdoc Status*"</span> <span style="color: #483d8b;">:position</span> top <span style="color: #483d8b;">:dedicated</span> t)
          popwin:special-display-config)
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"*frequencies*"</span> <span style="color: #483d8b;">:height</span> 20 <span style="color: #483d8b;">:position</span> bottom <span style="color: #483d8b;">:dedicated</span> t)
          popwin:special-display-config)
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"CAPTURE-next.org"</span> <span style="color: #483d8b;">:height</span> 10 <span style="color: #483d8b;">:position</span> bottom <span style="color: #483d8b;">:noselect</span> t)
          popwin:special-display-config)
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"CAPTURE-org-ical.org"</span><span style="color: #483d8b;">:height</span> 10 <span style="color: #483d8b;">:position</span> bottom <span style="color: #483d8b;">:noselect</span> t)
          popwin:special-display-config)
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"dict-app-result"</span> <span style="color: #483d8b;">:height</span> 20 <span style="color: #483d8b;">:position</span> bottom)
          popwin:special-display-config)
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"*timer*"</span> <span style="color: #483d8b;">:height</span> 20 <span style="color: #483d8b;">:position</span> bottom <span style="color: #483d8b;">:dedicated</span> t)
          popwin:special-display-config)
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"Calendar"</span> <span style="color: #483d8b;">:position</span> top <span style="color: #483d8b;">:dedicated</span> t)
          popwin:special-display-config)
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"*wclock*"</span> <span style="color: #483d8b;">:height</span> 10 <span style="color: #483d8b;">:position</span> bottom <span style="color: #483d8b;">:dedicated</span> t)
          popwin:special-display-config)
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"*Org Dashboard*"</span> <span style="color: #483d8b;">:position</span> bottom)
          popwin:special-display-config)
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"*Org Select*"</span> <span style="color: #483d8b;">:height</span> 10 <span style="color: #483d8b;">:position</span> bottom)
          popwin:special-display-config)
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"*Org Grep*"</span> <span style="color: #483d8b;">:height</span> 20 <span style="color: #483d8b;">:position</span> bottom <span style="color: #483d8b;">:dedicated</span> t)
          popwin:special-display-config)
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"*Occur*"</span> <span style="color: #483d8b;">:height</span> 10 <span style="color: #483d8b;">:position</span> bottom)
          popwin:special-display-config)
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"*Shell Command Output*"</span> <span style="color: #483d8b;">:height</span> 10 <span style="color: #483d8b;">:position</span> bottom <span style="color: #483d8b;">:dedicated</span> t)
          popwin:special-display-config)
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"*eshell*"</span> <span style="color: #483d8b;">:height</span> 10 <span style="color: #483d8b;">:position</span> bottom)
          popwin:special-display-config)
<span style="color: #b22222;">;;;            </span><span style="color: #b22222;">(undo-tree-visualizer-buffer-name :height 10 :position top)</span>
<span style="color: #b22222;">;;;            </span><span style="color: #b22222;">(undo-tree-diff-buffer-name :height 20 :position bottom)</span>

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Not performed</span>
    (<span style="color: #a020f0;">push</span> '(<span style="color: #8b2252;">"*Org Agenda*"</span> <span style="color: #483d8b;">:height</span> 10 <span style="color: #483d8b;">:position</span> top)
          popwin:special-display-config)
    ))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb8f4604" class="outline-3">
<h3 id="orgb8f4604"><span class="section-number-3">11.6</span> <span class="todo TODO">TODO</span> [shackle.el] ポップアップウィンドウの制御</h3>
<div class="outline-text-3" id="text-11-6">
<ul class="org-ul">
<li>popwin の後発パッケージ<br /></li>
<li>popwin.el にある <code>dedicated</code> が使えないので，本当に移行するか検討中．<br /></li>
<li>以下の設定では，パッケージ読み込みのトリガーを <code>postpone</code> にひも付け<br /></li>
<li>align がないと，size が効かない？<br /></li>
<li>バッファ名に正規表現を使う時は，regexpが必要．<br /></li>
<li>org関連でディスパッチャとそれを経由するバッファは制御が効かない？<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">shackle</span> nil t)
    (<span style="color: #a020f0;">setq</span> shackle-default-ratio 0.33)
    (<span style="color: #a020f0;">setq</span> shackle-rules
          '((<span style="color: #8b2252;">"*osx-dictionary*"</span> <span style="color: #483d8b;">:align</span> above <span style="color: #483d8b;">:popup</span> t)
            (<span style="color: #8b2252;">"*Checkdoc Status*"</span> <span style="color: #483d8b;">:align</span> above <span style="color: #483d8b;">:popup</span> t <span style="color: #483d8b;">:noselect</span> t)
            <span style="color: #b22222;">;; </span><span style="color: #b22222;">("*Help*" :align t :select 'above :popup t :size 0.3)</span>
            <span style="color: #b22222;">;; </span><span style="color: #b22222;">("^\*Helm.+" :regexp t :align above :size 0.2)</span>
            ))
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"shackle"</span>)
      (shackle-mode 1))))
</pre>
</div>
</div>

<div id="outline-container-orgea53efa" class="outline-4">
<h4 id="orgea53efa"><span class="section-number-4">11.6.1</span> checkdoc.el 用の追加設定</h4>
<div class="outline-text-4" id="text-11-6-1">
<p>
<code>M-x checkdoc</code> 実行時に <code>checkdoc-minor-mode-map</code> に checkdoc のウィンドウを閉じるキーバインドを設定． <code>q</code> または <code>C-g</code> を押下すると，マイナーモードが終了し，設定したキーバインドが無効になる．マイナーモードが有効な間は， <code>q</code> が占有されてバッファに入力できなくなる．その場合は，必要に応じて <code>M-x my-delete-checkdoc-window</code> を実行する．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"checkdoc"</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-delete-checkdoc-window</span> ()
    (<span style="color: #a020f0;">interactive</span>)
    (<span style="color: #a020f0;">let</span> ((checkdoc-window (get-buffer-window <span style="color: #8b2252;">"*Checkdoc Status*"</span>)))
      (<span style="color: #a020f0;">when</span> checkdoc-window
        (delete-window checkdoc-window)))
    (checkdoc-minor-mode -1))
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:checkdoc</span> ()
    (<span style="color: #a020f0;">interactive</span>)
    (checkdoc-minor-mode 1)
    (define-key checkdoc-minor-mode-map (kbd <span style="color: #8b2252;">"q"</span>)
      'my-delete-checkdoc-window)
    (define-key checkdoc-minor-mode-map (kbd <span style="color: #8b2252;">"C-g"</span>)
      'my-delete-checkdoc-window))
  (advice-add 'checkdoc <span style="color: #483d8b;">:before</span> #'advice:checkdoc))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org3b21898" class="outline-3">
<h3 id="org3b21898"><span class="section-number-3">11.7</span> [elscreen.el] Emacs バッファをタブ化</h3>
<div class="outline-text-3" id="text-11-7">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;; </span><span style="color: #b22222;">ElScreen (require apel) ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color: #b22222;">;;; </span><span style="color: #b22222;">Note: change a string in the elscreen.el from "mac" to "ns"</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">2011-10-26: e2wm's perspective (two) mode is more useful for me.</span>
(load <span style="color: #8b2252;">"elscreen"</span> <span style="color: #8b2252;">"ElScreen"</span> t)
</pre>
</div>
</div>
</div>

<div id="outline-container-orga786523" class="outline-3">
<h3 id="orga786523"><span class="section-number-3">11.8</span> [tabbar-ruler] バッファをタブ切り替え可能に</h3>
<div class="outline-text-3" id="text-11-8">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">tabbar-ruler</span> nil t)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(when (require 'tabbar-ruler nil t)</span>
  (<span style="color: #a020f0;">setq</span> tabbar-ruler-global-tabbar t) <span style="color: #b22222;">; </span><span style="color: #b22222;">If you want tabbar</span>
  (<span style="color: #a020f0;">setq</span> tabbar-ruler-popup-menu t) <span style="color: #b22222;">; </span><span style="color: #b22222;">If you want a popup menu.</span>
  (<span style="color: #a020f0;">setq</span> tabbar-ruler-popup-toolbar t) <span style="color: #b22222;">; </span><span style="color: #b22222;">If you want a popup toolbar</span>
  <span style="color: #b22222;">;;  </span><span style="color: #b22222;">(setq tabbar-ruler-fancy-tab-separator 'round)</span>
  <span style="color: #b22222;">;;  </span><span style="color: #b22222;">(setq tabbar-ruler-fancy-current-tab-separator 'round)</span>
  (<span style="color: #a020f0;">setq</span> tabbar-ruler-invert-deselected nil)
  (<span style="color: #a020f0;">setq</span> tabbar-ruler-modified-symbol t))
</pre>
</div>
</div>
</div>

<div id="outline-container-org4c854c4" class="outline-3">
<h3 id="org4c854c4"><span class="section-number-3">11.9</span> [winner-undo.el] ウィンドウ構成の履歴を辿る</h3>
<div class="outline-text-3" id="text-11-9">
<ul class="org-ul">
<li>ビルトインの <code>winner-undo.el</code> を使います．<br /></li>
</ul>

<p>
ウィンドウ分割状況と各ウィンドウで表示していたバッファの履歴を辿ることができます． <code>winner-undo</code> で直前の状態に戻せます．例えば，誤って <code>C-x 0</code> で分割ウィンドウを閉じた時にも，即座に元の状態に戻すことが可能です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">unless</span> batch-build
    (postpone-message <span style="color: #8b2252;">"winner-mode"</span>)
    (winner-mode 1)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org07bf46f" class="outline-2">
<h2 id="org07bf46f"><span class="section-number-2">12</span> フォント／配色関連</h2>
<div class="outline-text-2" id="text-12">
</div>
<div id="outline-container-org413709a" class="outline-3">
<h3 id="org413709a"><span class="section-number-3">12.1</span> 正規表現を見やすくする</h3>
<div class="outline-text-3" id="text-12-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (set-face-foreground 'font-lock-regexp-grouping-backslash <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #66CC99;">#66CC99</span><span style="color: #8b2252;">"</span>)
  (set-face-foreground 'font-lock-regexp-grouping-construct <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #9966CC;">#9966CC</span><span style="color: #8b2252;">"</span>))
</pre>
</div>

<p>
Emacs Lisp で正規表現入力をサポートするツールには， <code>M-x re-builder</code> や <code>rx</code> マクロがある．<br />
</p>

<ul class="org-ul">
<li><a href="http://www.emacswiki.org/emacs/ReBuilder">EmacsWiki: Re Builder</a><br /></li>
<li><a href="http://emacswiki.org/emacs/rx">EmacsWiki: rx</a><br /></li>
</ul>
</div>
</div>

<div id="outline-container-org26b9bed" class="outline-3">
<h3 id="org26b9bed"><span class="section-number-3">12.2</span> 設定ファイルを見やすくする</h3>
<div class="outline-text-3" id="text-12-2">
<p>
<code>generic-x</code> を使うと， <code>/etc/hosts</code> や <code>/etc/apache2.conf</code> に色を付けられる．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">unless</span> batch-build
    (postpone-message <span style="color: #8b2252;">"generic-x"</span>)
    (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">generic-x</span> nil t)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org6740cb2" class="outline-3">
<h3 id="org6740cb2"><span class="section-number-3">12.3</span> カーソル行に色をつける</h3>
<div class="outline-text-3" id="text-12-3">
<ul class="org-ul">
<li>ビルトインの <code>hl-line</code> を使います．<br /></li>
<li><a href="http://murakan.cocolog-nifty.com/blog/2009/01/emacs-tips-1d45.html">http://murakan.cocolog-nifty.com/blog/2009/01/emacs-tips-1d45.html</a><br /></li>
<li><a href="http://www.emacswiki.org/cgi-bin/emacs/highlight-current-line.el">http://www.emacswiki.org/cgi-bin/emacs/highlight-current-line.el</a><br /></li>
</ul>

<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">if</span> (display-graphic-p)
      (<span style="color: #a020f0;">unless</span> batch-build
        (postpone-message <span style="color: #8b2252;">"global-hl-line-mode"</span>))
    (<span style="color: #a020f0;">setq</span> hl-line-face 'underline))
  (global-hl-line-mode 1))
</pre>
</div>

<p>
色の設定は <code>custom-set-faces</code> で．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(custom-set-faces
 '(hl-line
   ((((background dark)) <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #484c5c;">#484c5c</span><span style="color: #8b2252;">"</span>)
    (t (<span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #DEEDFF;">#DEEDFF</span><span style="color: #8b2252;">"</span>))))))
</pre>
</div>

<p>
色の変更ではなく，下線に変更したい場合は， <code>(setq hl-line-face 'underline)</code> とする．<br />
</p>
</div>
</div>

<div id="outline-container-org4cae7bb" class="outline-3">
<h3 id="org4cae7bb"><span class="section-number-3">12.4</span> カーソルを点滅させない</h3>
<div class="outline-text-3" id="text-12-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">unless</span> batch-build
    (postpone-message <span style="color: #8b2252;">"blink-cursor-mode"</span>)
    (blink-cursor-mode -1)))
</pre>
</div>

<p>
以下の例では，入力が止まってから16秒後に0.3秒間隔で点滅します．次に入力が始まるまで，点滅が続きます．<br />
</p>

<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (<span style="color: #a020f0;">setq</span> blink-cursor-blinks 0)
  (<span style="color: #a020f0;">setq</span> blink-cursor-interval 0.3)
  (<span style="color: #a020f0;">setq</span> blink-cursor-delay 16)
  (<span style="color: #a020f0;">unless</span> batch-build
    (postpone-message <span style="color: #8b2252;">"blink-cursor-mode"</span>)
    (blink-cursor-mode -1)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orge4f9f45" class="outline-3">
<h3 id="orge4f9f45"><span class="section-number-3">12.5</span> カーソル位置のフォントを確認</h3>
<div class="outline-text-3" id="text-12-5">
<p>
<code>M-x describe-char</code> すると，カーソル位置のフォントの情報が別バッファに表示されます．<br />
</p>
</div>
</div>

<div id="outline-container-orga507036" class="outline-3">
<h3 id="orga507036"><span class="section-number-3">12.6</span> フォント設定</h3>
<div class="outline-text-3" id="text-12-6">
<p>
表のような利用環境に対して，個別に設定を施しています．WindowsとLinuxは安定版のEmacs23で，Macは開発版のCocoaEmacs23です．MacではEmacs24でもうまく表示できています．最近は，<a href="http://mix-mplus-ipa.sourceforge.jp/migu/">Migu 2M</a>を気に入って使っています．<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> 環境別の使用フォント</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">ASCII</td>
<td class="org-left">日本語</td>
</tr>

<tr>
<td class="org-left">Mac</td>
<td class="org-left">Monaco</td>
<td class="org-left">Migu 2M 又は ヒラギノ丸ゴ</td>
</tr>

<tr>
<td class="org-left">Windows</td>
<td class="org-left">Inconsolata</td>
<td class="org-left">メイリオ</td>
</tr>

<tr>
<td class="org-left">Linux</td>
<td class="org-left">Inconsolata</td>
<td class="org-left">MigMix</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li><a href="http://d.hatena.ne.jp/setoryohei/20110117/1295336454">http://d.hatena.ne.jp/setoryohei/20110117/1295336454</a><br /></li>
<li><a href="http://users.teilar.gr/~g1951d/">Unicode Fonts for Ancient Scripts</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;; </span><span style="color: #b22222;">1) Monaco, Hiragino/Migu 2M : font-size=12, -apple-hiragino=1.2</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">2) Inconsolata, Migu 2M     : font-size=14,</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">3) Inconsolata, Hiragino    : font-size=14, -apple-hiragino=1.0</span>
(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">my-font-size</span> 12)
(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">my-ja-font</span> <span style="color: #8b2252;">"Migu 2M"</span>) <span style="color: #b22222;">;; </span><span style="color: #b22222;">"Hiragino Maru Gothic Pro"</span>
(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">my-ascii-font</span> <span style="color: #8b2252;">"Monaco"</span>) <span style="color: #b22222;">;; </span><span style="color: #b22222;">"Inconsolata", Monaco</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(defconst my-ja-font "Hiragino Maru Gothic Pro") ;; "Hiragino Maru Gothic Pro"</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(defconst my-ascii-font "Inconsolata") ;; "Inconsolata", Menlo, "Ricty Diminished"</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-ja-font-setter</span> (spec)
  (set-fontset-font nil 'japanese-jisx0208 spec)
  (set-fontset-font nil 'katakana-jisx0201 spec)
  (set-fontset-font nil 'japanese-jisx0212 spec)
  (set-fontset-font nil '(#x0080 . #x024F) spec)
  (set-fontset-font nil '(#x0370 . #x03FF) spec)
  (set-fontset-font nil 'mule-unicode-0100-24ff spec))
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-ascii-font-setter</span> (spec)
  (set-fontset-font nil 'ascii spec))
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-unicode-font-setter</span> (spec)
  (set-fontset-font nil 'unicode spec))
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-font-config</span> (<span style="color: #228b22;">&amp;optional</span> size ascii ja)
  <span style="color: #8b2252;">"Font config.</span>
<span style="color: #8b2252;">- SIZE: font size for ASCII and Japanese (default: 12)</span>
<span style="color: #8b2252;">- ASCII: ascii font family (default: \"Monaco\")</span>
<span style="color: #8b2252;">- JA: Japanese font family (default: \"Migu 2M\")</span>
<span style="color: #8b2252;">"</span>
  (<span style="color: #a020f0;">when</span> (memq window-system '(mac ns))
    (<span style="color: #a020f0;">let</span> ((font-size (<span style="color: #a020f0;">or</span> size my-font-size))
          <span style="color: #b22222;">;; </span><span style="color: #b22222;">(unicode-font (or uc "FreeSerif"))</span>
          (ascii-font (<span style="color: #a020f0;">or</span> ascii my-ascii-font))
          (ja-font (<span style="color: #a020f0;">or</span> ja my-ja-font)))
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">(my-unicode-font-setter</span>
      <span style="color: #b22222;">;;  </span><span style="color: #b22222;">(font-spec :family unicode-font :size font-size))</span>
      (my-ascii-font-setter (font-spec <span style="color: #483d8b;">:family</span> ascii-font <span style="color: #483d8b;">:size</span> font-size))
      (my-ja-font-setter (font-spec <span style="color: #483d8b;">:family</span> ja-font <span style="color: #483d8b;">:size</span> font-size)))))

(<span style="color: #a020f0;">cond</span>
 <span style="color: #b22222;">;; </span><span style="color: #b22222;">CocoaEmacs</span>
 ((memq window-system '(mac ns))
  (<span style="color: #a020f0;">when</span> (&gt;= emacs-major-version 23)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Fix ratio provided by set-face-attribute for fonts display</span>
    (<span style="color: #a020f0;">setq</span> face-font-rescale-alist
          '((<span style="color: #8b2252;">"^-apple-hiragino.*"</span> . 1.0) <span style="color: #b22222;">; </span><span style="color: #b22222;">1.2</span>
            (<span style="color: #8b2252;">".*Migu.*"</span> . 1.2)
            (<span style="color: #8b2252;">".*Ricty.*"</span> . 1.0)
            (<span style="color: #8b2252;">".*Inconsolata.*"</span> . 1.0)
            (<span style="color: #8b2252;">".*osaka-bold.*"</span> . 1.0)     <span style="color: #b22222;">; </span><span style="color: #b22222;">1.2</span>
            (<span style="color: #8b2252;">".*osaka-medium.*"</span> . 1.0)   <span style="color: #b22222;">; </span><span style="color: #b22222;">1.0</span>
            (<span style="color: #8b2252;">".*courier-bold-.*-mac-roman"</span> . 1.0) <span style="color: #b22222;">; </span><span style="color: #b22222;">0.9</span>
            <span style="color: #b22222;">;; </span><span style="color: #b22222;">(".*monaco cy-bold-.*-mac-cyrillic" . 1.0)</span>
            <span style="color: #b22222;">;; </span><span style="color: #b22222;">(".*monaco-bold-.*-mac-roman" . 1.0) ; 0.9</span>
            (<span style="color: #8b2252;">"-cdac$"</span> . 1.0)))) <span style="color: #b22222;">; </span><span style="color: #b22222;">1.3</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(my-font-config) ;; see `</span><span style="color: #008b8b;">my-apply-theme</span><span style="color: #b22222;">'</span>
)

 ((eq window-system 'ns)
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Anti aliasing with Quartz 2D</span>
  (<span style="color: #a020f0;">when</span> (boundp 'mac-allow-anti-aliasing)
    (<span style="color: #a020f0;">setq</span> mac-allow-anti-aliasing t)))

 ((eq window-system 'w32) <span style="color: #b22222;">; </span><span style="color: #b22222;">windows7</span>
  (<span style="color: #a020f0;">let</span> ((font-size 14)
        (font-height 100)
        (ascii-font <span style="color: #8b2252;">"Inconsolata"</span>)
        (ja-font <span style="color: #8b2252;">"&#12513;&#12452;&#12522;&#12458;"</span>)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">Meiryo UI</span>
    (my-ja-font-setter
     (font-spec <span style="color: #483d8b;">:family</span> ja-font <span style="color: #483d8b;">:size</span> font-size <span style="color: #483d8b;">:height</span> font-height))
    (my-ascii-font-setter (font-spec <span style="color: #483d8b;">:family</span> ascii-font <span style="color: #483d8b;">:size</span> font-size))
    (<span style="color: #a020f0;">setq</span> face-font-rescale-alist '((<span style="color: #8b2252;">".*Inconsolata.*"</span> . 1.0))))) <span style="color: #b22222;">; </span><span style="color: #b22222;">0.9</span>

 ((eq window-system 'x) <span style="color: #b22222;">; </span><span style="color: #b22222;">for SuSE Linux 12.1</span>
  (<span style="color: #a020f0;">let</span>
      ((font-size 14)
       (font-height 100)
       (ascii-font <span style="color: #8b2252;">"Inconsolata"</span>)
       <span style="color: #b22222;">;; </span><span style="color: #b22222;">(ja-font "MigMix 1M")</span>
       (ja-font <span style="color: #8b2252;">"Migu 2M"</span>))
    (my-ja-font-setter
     (font-spec <span style="color: #483d8b;">:family</span> ja-font <span style="color: #483d8b;">:size</span> font-size <span style="color: #483d8b;">:height</span> font-height))
    (my-ascii-font-setter (font-spec <span style="color: #483d8b;">:family</span> ascii-font <span style="color: #483d8b;">:size</span> font-size)))
  (<span style="color: #a020f0;">setq</span> face-font-rescale-alist '((<span style="color: #8b2252;">".*MigMix.*"</span> . 2.0)
                                  (<span style="color: #8b2252;">".*Inconsolata.*"</span> . 1.0))))) <span style="color: #b22222;">; </span><span style="color: #b22222;">0.9</span>
</pre>
</div>
</div>

<div id="outline-container-orgbda836d" class="outline-4">
<h4 id="orgbda836d"><span class="section-number-4">12.6.1</span> フォントのインストール方法</h4>
<div class="outline-text-4" id="text-12-6-1">
<p>
Linux では次のように処理するだけでよく，意外と簡単．<br />
</p>

<ol class="org-ol">
<li>~/.fonts を作成する<br /></li>
<li>フォントを1.のディレクトリに置く<br /></li>
<li>fc-cache -fv を実行<br /></li>
<li>fc-list でインストールされているかを確認．<br /></li>
</ol>

<p>
なお，Windows では，フォントファイルを右クリックして，インストールを選択するだけでOK．<br />
</p>
</div>
</div>

<div id="outline-container-orgacaa2a7" class="outline-4">
<h4 id="orgacaa2a7"><span class="section-number-4">12.6.2</span> フォントチェック用コード</h4>
<div class="outline-text-4" id="text-12-6-2">
<p>
サンプルの <a href="http://dl.dropbox.com/u/2440/dokuwiki/font-test.org">orgファイル</a> を作って，見た目をチェックしています．バッファ内の桁数チェックや，ASCIIが漢字の半分の幅になっているかのチェックが楽になります．<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org1ff449a" class="outline-3">
<h3 id="org1ff449a"><span class="section-number-3">12.7</span> 行間を制御する</h3>
<div class="outline-text-3" id="text-12-7">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(set-default 'line-spacing 0.2)
</pre>
</div>
</div>
</div>

<div id="outline-container-org5a1542f" class="outline-3">
<h3 id="org5a1542f"><span class="section-number-3">12.8</span> パッチをカラフルに表示する</h3>
<div class="outline-text-3" id="text-12-8">
<p>
Built-in の <a href="http://www.emacswiki.org/emacs/DiffMode">diff-mode.el</a> をカスタマイズします．<br />
</p>

<ul class="org-ul">
<li><a href="http://d.hatena.ne.jp/syohex/20111228/1325086893">http://d.hatena.ne.jp/syohex/20111228/1325086893</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(diff-mode)
       <span style="color: #8b2252;">"diff-mode"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"diff-mode"</span>
    (set-face-attribute 'diff-added nil
                        <span style="color: #483d8b;">:background</span> nil <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #00ff00;">green</span><span style="color: #8b2252;">"</span>
                        <span style="color: #483d8b;">:weight</span> 'normal)

    (set-face-attribute 'diff-removed nil
                        <span style="color: #483d8b;">:background</span> nil <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #ff3030;">firebrick1</span><span style="color: #8b2252;">"</span>
                        <span style="color: #483d8b;">:weight</span> 'normal)

    (set-face-attribute 'diff-file-header nil
                        <span style="color: #483d8b;">:background</span> nil <span style="color: #483d8b;">:weight</span> 'extra-bold)

    (set-face-attribute 'diff-hunk-header nil
                        <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #8b4513;">chocolate4</span><span style="color: #8b2252;">"</span>
                        <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #ffffff;">white</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:weight</span> 'extra-bold
                        <span style="color: #483d8b;">:inherit</span> nil)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgde4e254" class="outline-3">
<h3 id="orgde4e254"><span class="section-number-3">12.9</span> 背景を黒系色にする</h3>
<div class="outline-text-3" id="text-12-9">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(custom-set-faces
 '(default ((t
             (<span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #000000;">black</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #55FF55;">#55FF55</span><span style="color: #8b2252;">"</span>)
             ))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org4ff5374" class="outline-3">
<h3 id="org4ff5374"><span class="section-number-3">12.10</span> 日中と夜中でテーマを切り替える</h3>
<div class="outline-text-3" id="text-12-10">
<p>
私は使っていませんが，簡単にテーマを切り替えるためのパッケージ(<a href="https://github.com/valignatev/heaven-and-hell">heaven-and-hell</a>)も存在します．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #b22222;">;;;</span><span style="color: #b22222;">###</span><span style="color: #ff0000; font-weight: bold;">autoload</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-daylight-theme</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">daylight-theme</span> nil t)
    (mapc 'disable-theme custom-enabled-themes)
    (load-theme 'daylight t)
    (<span style="color: #a020f0;">setq</span> default-frame-alist
          (delete (assoc 'ns-appearance default-frame-alist)
                  default-frame-alist))
    (<span style="color: #a020f0;">setq</span> default-frame-alist
          (delete (assoc 'ns-transparent-titlebar default-frame-alist)
                  default-frame-alist))
    (add-to-list 'default-frame-alist '(ns-transparent-titlebar . t))
    (add-to-list 'default-frame-alist '(ns-appearance . light))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(redraw-frame)</span>
    ))

<span style="color: #b22222;">;;;</span><span style="color: #b22222;">###</span><span style="color: #ff0000; font-weight: bold;">autoload</span>
(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-night-theme</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">night-theme</span> nil t) <span style="color: #b22222;">;; </span><span style="color: #b22222;">atom-one-dark-theme</span>
    (mapc 'disable-theme custom-enabled-themes)
    (load-theme 'night t)
    (<span style="color: #a020f0;">setq</span> default-frame-alist
          (delete (assoc 'ns-appearance default-frame-alist)
                  default-frame-alist))
    (<span style="color: #a020f0;">setq</span> default-frame-alist
          (delete (assoc 'ns-transparent-titlebar default-frame-alist)
                  default-frame-alist))
    (add-to-list 'default-frame-alist '(ns-transparent-titlebar . t))
    (add-to-list 'default-frame-alist '(ns-appearance . dark))
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(redraw-frame)</span>
    ))
</pre>
</div>
</div>
</div>

<div id="outline-container-orge12a95b" class="outline-3">
<h3 id="orge12a95b"><span class="section-number-3">12.11</span> 時間帯を指定して起動時にテーマを切り替える</h3>
<div class="outline-text-3" id="text-12-11">
<p>
次の例では，19時から翌日の朝5時までの間に夜用のテーマを使っています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-night-time-p</span> (begin end)
  (<span style="color: #a020f0;">let*</span> ((ch (string-to-number (format-time-string <span style="color: #8b2252;">"%H"</span> (current-time))))
         (cm (string-to-number (format-time-string <span style="color: #8b2252;">"%M"</span> (current-time))))
         (ct (+ cm (* 60 ch))))
    (<span style="color: #a020f0;">if</span> (&gt; begin end)
        (<span style="color: #a020f0;">or</span> (&lt;= begin ct) (&lt;= ct end))
      (<span style="color: #a020f0;">and</span> (&lt;= begin ct) (&lt;= ct end)))))

(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-apply-theme</span> ()
  (<span style="color: #a020f0;">interactive</span>)
  (<span style="color: #a020f0;">let</span> ((night-time-in 21)
        (night-time-out 5))
    (<span style="color: #a020f0;">if</span> (my-night-time-p (* night-time-in 60) (* night-time-out 60))
        (my-night-theme)
      (my-daylight-theme)))
  (<span style="color: #a020f0;">when</span> (fboundp 'mac-get-current-input-source)
    (my-apply-cursor-config)))

(<span style="color: #a020f0;">when</span> (display-graphic-p)
  (my-apply-theme) <span style="color: #b22222;">;; </span><span style="color: #b22222;">this may override or reset font setting</span>
  (my-font-config)) <span style="color: #b22222;">;; </span><span style="color: #b22222;">apply font setting</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdfff5ac" class="outline-3">
<h3 id="orgdfff5ac"><span class="section-number-3">12.12</span> [rainbow-mode.el] 配色のリアルタイム確認</h3>
<div class="outline-text-3" id="text-12-12">
<p>
M-x rainbow-mode とすると，色指定のコードの背景色を，その指定色にリアルタイム変換してくれる．<br />
</p>

<p>
<a href="http://elpa.gnu.org/packages/rainbow-mode.html">http://elpa.gnu.org/packages/rainbow-mode.html</a><br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(rainbow-mode)
       <span style="color: #8b2252;">"rainbow-mode"</span> nil t)

  (<span style="color: #a020f0;">dolist</span> (hook '(emmet-mode-hook emacs-lisp-mode-hook org-mode-hook))
    (add-hook hook #'rainbow-mode)))
</pre>
</div>
</div>

<div id="outline-container-org0ff3e2b" class="outline-4">
<h4 id="org0ff3e2b"><span class="section-number-4">12.12.1</span> 色一覧</h4>
<div class="outline-text-4" id="text-12-12-1">
<p>
<code>0,6,9,C,F</code> の組み合わせ<br />
</p>

<div class="org-src-container">
<pre class="src src-html">
<span style="color: #ffffff; background-color: #000000;">#000000</span> <span style="color: #ffffff; background-color: #000033;">#000033</span> <span style="color: #ffffff; background-color: #000066;">#000066</span> <span style="color: #ffffff; background-color: #000099;">#000099</span> <span style="color: #ffffff; background-color: #0000CC;">#0000CC</span> <span style="color: #ffffff; background-color: #0000FF;">#0000FF</span>
<span style="color: #ffffff; background-color: #003300;">#003300</span> <span style="color: #ffffff; background-color: #003333;">#003333</span> <span style="color: #ffffff; background-color: #003366;">#003366</span> <span style="color: #ffffff; background-color: #003399;">#003399</span> <span style="color: #ffffff; background-color: #0033CC;">#0033CC</span> <span style="color: #ffffff; background-color: #0033FF;">#0033FF</span>
<span style="color: #ffffff; background-color: #006600;">#006600</span> <span style="color: #ffffff; background-color: #006633;">#006633</span> <span style="color: #ffffff; background-color: #006666;">#006666</span> <span style="color: #ffffff; background-color: #006699;">#006699</span> <span style="color: #ffffff; background-color: #0066CC;">#0066CC</span> <span style="color: #ffffff; background-color: #0066FF;">#0066FF</span>
<span style="color: #ffffff; background-color: #009900;">#009900</span> <span style="color: #ffffff; background-color: #009933;">#009933</span> <span style="color: #ffffff; background-color: #009966;">#009966</span> <span style="color: #ffffff; background-color: #009999;">#009999</span> <span style="color: #ffffff; background-color: #0099CC;">#0099CC</span> <span style="color: #ffffff; background-color: #0099FF;">#0099FF</span>
<span style="color: #000000; background-color: #00CC00;">#00CC00</span> <span style="color: #000000; background-color: #00CC33;">#00CC33</span> <span style="color: #000000; background-color: #00CC66;">#00CC66</span> <span style="color: #000000; background-color: #00CC99;">#00CC99</span> <span style="color: #000000; background-color: #00CCCC;">#00CCCC</span> <span style="color: #000000; background-color: #00CCFF;">#00CCFF</span>
<span style="color: #000000; background-color: #00FF00;">#00FF00</span> <span style="color: #000000; background-color: #00FF33;">#00FF33</span> <span style="color: #000000; background-color: #00FF66;">#00FF66</span> <span style="color: #000000; background-color: #00FF99;">#00FF99</span> <span style="color: #000000; background-color: #00FFCC;">#00FFCC</span> <span style="color: #000000; background-color: #00FFFF;">#00FFFF</span>

<span style="color: #ffffff; background-color: #330000;">#330000</span> <span style="color: #ffffff; background-color: #330033;">#330033</span> <span style="color: #ffffff; background-color: #330066;">#330066</span> <span style="color: #ffffff; background-color: #330099;">#330099</span> <span style="color: #ffffff; background-color: #3300CC;">#3300CC</span> <span style="color: #ffffff; background-color: #3300FF;">#3300FF</span>
<span style="color: #ffffff; background-color: #333300;">#333300</span> <span style="color: #ffffff; background-color: #333333;">#333333</span> <span style="color: #ffffff; background-color: #333366;">#333366</span> <span style="color: #ffffff; background-color: #333399;">#333399</span> <span style="color: #ffffff; background-color: #3333CC;">#3333CC</span> <span style="color: #ffffff; background-color: #3333FF;">#3333FF</span>
<span style="color: #ffffff; background-color: #336600;">#336600</span> <span style="color: #ffffff; background-color: #336633;">#336633</span> <span style="color: #ffffff; background-color: #336666;">#336666</span> <span style="color: #ffffff; background-color: #336699;">#336699</span> <span style="color: #ffffff; background-color: #3366CC;">#3366CC</span> <span style="color: #ffffff; background-color: #3366FF;">#3366FF</span>
<span style="color: #ffffff; background-color: #339900;">#339900</span> <span style="color: #ffffff; background-color: #339933;">#339933</span> <span style="color: #ffffff; background-color: #339966;">#339966</span> <span style="color: #000000; background-color: #339999;">#339999</span> <span style="color: #000000; background-color: #3399CC;">#3399CC</span> <span style="color: #000000; background-color: #3399FF;">#3399FF</span>
<span style="color: #000000; background-color: #33CC00;">#33CC00</span> <span style="color: #000000; background-color: #33CC33;">#33CC33</span> <span style="color: #000000; background-color: #33CC66;">#33CC66</span> <span style="color: #000000; background-color: #33CC99;">#33CC99</span> <span style="color: #000000; background-color: #33CCCC;">#33CCCC</span> <span style="color: #000000; background-color: #33CCFF;">#33CCFF</span>
<span style="color: #000000; background-color: #33FF00;">#33FF00</span> <span style="color: #000000; background-color: #33FF33;">#33FF33</span> <span style="color: #000000; background-color: #33FF66;">#33FF66</span> <span style="color: #000000; background-color: #33FF99;">#33FF99</span> <span style="color: #000000; background-color: #33FFCC;">#33FFCC</span> <span style="color: #000000; background-color: #33FFFF;">#33FFFF</span>

<span style="color: #ffffff; background-color: #660000;">#660000</span> <span style="color: #ffffff; background-color: #660033;">#660033</span> <span style="color: #ffffff; background-color: #660066;">#660066</span> <span style="color: #ffffff; background-color: #660099;">#660099</span> <span style="color: #ffffff; background-color: #6600CC;">#6600CC</span> <span style="color: #ffffff; background-color: #6600FF;">#6600FF</span>
<span style="color: #ffffff; background-color: #663300;">#663300</span> <span style="color: #ffffff; background-color: #663333;">#663333</span> <span style="color: #ffffff; background-color: #663366;">#663366</span> <span style="color: #ffffff; background-color: #663399;">#663399</span> <span style="color: #ffffff; background-color: #6633CC;">#6633CC</span> <span style="color: #ffffff; background-color: #6633FF;">#6633FF</span>
<span style="color: #ffffff; background-color: #666600;">#666600</span> <span style="color: #ffffff; background-color: #666633;">#666633</span> <span style="color: #ffffff; background-color: #666666;">#666666</span> <span style="color: #ffffff; background-color: #666699;">#666699</span> <span style="color: #ffffff; background-color: #6666CC;">#6666CC</span> <span style="color: #ffffff; background-color: #6666FF;">#6666FF</span>
<span style="color: #000000; background-color: #669900;">#669900</span> <span style="color: #000000; background-color: #669933;">#669933</span> <span style="color: #000000; background-color: #669966;">#669966</span> <span style="color: #000000; background-color: #669999;">#669999</span> <span style="color: #000000; background-color: #6699CC;">#6699CC</span> <span style="color: #000000; background-color: #6699FF;">#6699FF</span>
<span style="color: #000000; background-color: #66CC00;">#66CC00</span> <span style="color: #000000; background-color: #66CC33;">#66CC33</span> <span style="color: #000000; background-color: #66CC66;">#66CC66</span> <span style="color: #000000; background-color: #66CC99;">#66CC99</span> <span style="color: #000000; background-color: #66CCCC;">#66CCCC</span> <span style="color: #000000; background-color: #66CCFF;">#66CCFF</span>
<span style="color: #000000; background-color: #66FF00;">#66FF00</span> <span style="color: #000000; background-color: #66FF33;">#66FF33</span> <span style="color: #000000; background-color: #66FF66;">#66FF66</span> <span style="color: #000000; background-color: #66FF99;">#66FF99</span> <span style="color: #000000; background-color: #66FFCC;">#66FFCC</span> <span style="color: #000000; background-color: #66FFFF;">#66FFFF</span>

<span style="color: #ffffff; background-color: #990000;">#990000</span> <span style="color: #ffffff; background-color: #990033;">#990033</span> <span style="color: #ffffff; background-color: #990066;">#990066</span> <span style="color: #ffffff; background-color: #990099;">#990099</span> <span style="color: #ffffff; background-color: #9900CC;">#9900CC</span> <span style="color: #ffffff; background-color: #9900FF;">#9900FF</span>
<span style="color: #ffffff; background-color: #993300;">#993300</span> <span style="color: #ffffff; background-color: #993333;">#993333</span> <span style="color: #ffffff; background-color: #993366;">#993366</span> <span style="color: #ffffff; background-color: #993399;">#993399</span> <span style="color: #ffffff; background-color: #9933CC;">#9933CC</span> <span style="color: #ffffff; background-color: #9933FF;">#9933FF</span>
<span style="color: #ffffff; background-color: #996600;">#996600</span> <span style="color: #ffffff; background-color: #996633;">#996633</span> <span style="color: #ffffff; background-color: #996666;">#996666</span> <span style="color: #ffffff; background-color: #996699;">#996699</span> <span style="color: #ffffff; background-color: #9966CC;">#9966CC</span> <span style="color: #ffffff; background-color: #9966FF;">#9966FF</span>
<span style="color: #000000; background-color: #999900;">#999900</span> <span style="color: #000000; background-color: #999933;">#999933</span> <span style="color: #000000; background-color: #999966;">#999966</span> <span style="color: #000000; background-color: #999999;">#999999</span> <span style="color: #000000; background-color: #9999CC;">#9999CC</span> <span style="color: #000000; background-color: #9999FF;">#9999FF</span>
<span style="color: #000000; background-color: #99CC00;">#99CC00</span> <span style="color: #000000; background-color: #99CC33;">#99CC33</span> <span style="color: #000000; background-color: #99CC66;">#99CC66</span> <span style="color: #000000; background-color: #99CC99;">#99CC99</span> <span style="color: #000000; background-color: #99CCCC;">#99CCCC</span> <span style="color: #000000; background-color: #99CCFF;">#99CCFF</span>
<span style="color: #000000; background-color: #99FF00;">#99FF00</span> <span style="color: #000000; background-color: #99FF33;">#99FF33</span> <span style="color: #000000; background-color: #99FF66;">#99FF66</span> <span style="color: #000000; background-color: #99FF99;">#99FF99</span> <span style="color: #000000; background-color: #99FFCC;">#99FFCC</span> <span style="color: #000000; background-color: #99FFFF;">#99FFFF</span>

<span style="color: #ffffff; background-color: #CC0000;">#CC0000</span> <span style="color: #ffffff; background-color: #CC0033;">#CC0033</span> <span style="color: #ffffff; background-color: #CC0066;">#CC0066</span> <span style="color: #ffffff; background-color: #CC0099;">#CC0099</span> <span style="color: #ffffff; background-color: #CC00CC;">#CC00CC</span> <span style="color: #ffffff; background-color: #CC00FF;">#CC00FF</span>
<span style="color: #ffffff; background-color: #CC3300;">#CC3300</span> <span style="color: #ffffff; background-color: #CC3333;">#CC3333</span> <span style="color: #ffffff; background-color: #CC3366;">#CC3366</span> <span style="color: #ffffff; background-color: #CC3399;">#CC3399</span> <span style="color: #ffffff; background-color: #CC33CC;">#CC33CC</span> <span style="color: #ffffff; background-color: #CC33FF;">#CC33FF</span>
<span style="color: #ffffff; background-color: #CC6600;">#CC6600</span> <span style="color: #ffffff; background-color: #CC6633;">#CC6633</span> <span style="color: #ffffff; background-color: #CC6666;">#CC6666</span> <span style="color: #ffffff; background-color: #CC6699;">#CC6699</span> <span style="color: #000000; background-color: #CC66CC;">#CC66CC</span> <span style="color: #000000; background-color: #CC66FF;">#CC66FF</span>
<span style="color: #000000; background-color: #CC9900;">#CC9900</span> <span style="color: #000000; background-color: #CC9933;">#CC9933</span> <span style="color: #000000; background-color: #CC9966;">#CC9966</span> <span style="color: #000000; background-color: #CC9999;">#CC9999</span> <span style="color: #000000; background-color: #CC99CC;">#CC99CC</span> <span style="color: #000000; background-color: #CC99FF;">#CC99FF</span>
<span style="color: #000000; background-color: #CCCC00;">#CCCC00</span> <span style="color: #000000; background-color: #CCCC33;">#CCCC33</span> <span style="color: #000000; background-color: #CCCC66;">#CCCC66</span> <span style="color: #000000; background-color: #CCCC99;">#CCCC99</span> <span style="color: #000000; background-color: #CCCCCC;">#CCCCCC</span> <span style="color: #000000; background-color: #CCCCFF;">#CCCCFF</span>
<span style="color: #000000; background-color: #CCFF00;">#CCFF00</span> <span style="color: #000000; background-color: #CCFF33;">#CCFF33</span> <span style="color: #000000; background-color: #CCFF66;">#CCFF66</span> <span style="color: #000000; background-color: #CCFF99;">#CCFF99</span> <span style="color: #000000; background-color: #CCFFCC;">#CCFFCC</span> <span style="color: #000000; background-color: #CCFFFF;">#CCFFFF</span>

<span style="color: #ffffff; background-color: #FF0000;">#FF0000</span> <span style="color: #ffffff; background-color: #FF0033;">#FF0033</span> <span style="color: #ffffff; background-color: #FF0066;">#FF0066</span> <span style="color: #ffffff; background-color: #FF0099;">#FF0099</span> <span style="color: #ffffff; background-color: #FF00CC;">#FF00CC</span> <span style="color: #ffffff; background-color: #FF00FF;">#FF00FF</span>
<span style="color: #ffffff; background-color: #FF3300;">#FF3300</span> <span style="color: #ffffff; background-color: #FF3333;">#FF3333</span> <span style="color: #ffffff; background-color: #FF3366;">#FF3366</span> <span style="color: #ffffff; background-color: #FF3399;">#FF3399</span> <span style="color: #ffffff; background-color: #FF33CC;">#FF33CC</span> <span style="color: #ffffff; background-color: #FF33FF;">#FF33FF</span>
<span style="color: #ffffff; background-color: #FF6600;">#FF6600</span> <span style="color: #000000; background-color: #FF6633;">#FF6633</span> <span style="color: #000000; background-color: #FF6666;">#FF6666</span> <span style="color: #000000; background-color: #FF6699;">#FF6699</span> <span style="color: #000000; background-color: #FF66CC;">#FF66CC</span> <span style="color: #000000; background-color: #FF66FF;">#FF66FF</span>
<span style="color: #000000; background-color: #FF9900;">#FF9900</span> <span style="color: #000000; background-color: #FF9933;">#FF9933</span> <span style="color: #000000; background-color: #FF9966;">#FF9966</span> <span style="color: #000000; background-color: #FF9999;">#FF9999</span> <span style="color: #000000; background-color: #FF99CC;">#FF99CC</span> <span style="color: #000000; background-color: #FF99FF;">#FF99FF</span>
<span style="color: #000000; background-color: #FFCC00;">#FFCC00</span> <span style="color: #000000; background-color: #FFCC33;">#FFCC33</span> <span style="color: #000000; background-color: #FFCC66;">#FFCC66</span> <span style="color: #000000; background-color: #FFCC99;">#FFCC99</span> <span style="color: #000000; background-color: #FFCCCC;">#FFCCCC</span> <span style="color: #000000; background-color: #FFCCFF;">#FFCCFF</span>
<span style="color: #000000; background-color: #FFFF00;">#FFFF00</span> <span style="color: #000000; background-color: #FFFF33;">#FFFF33</span> <span style="color: #000000; background-color: #FFFF66;">#FFFF66</span> <span style="color: #000000; background-color: #FFFF99;">#FFFF99</span> <span style="color: #000000; background-color: #FFFFCC;">#FFFFCC</span> <span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span>

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf826d5b" class="outline-3">
<h3 id="orgf826d5b"><span class="section-number-3">12.13</span> [volatile-highlights] コピペした領域を強調</h3>
<div class="outline-text-3" id="text-12-13">
<p>
コピペ直後の数秒に限定して，コピペした領域をハイライトします．さらに，所定の間隔で表示色を変えることで，ハイライト色が徐々に消えていくようなエフェクトにしています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(volatile-highlights-mode my-vhl-change-color)
       <span style="color: #8b2252;">"volatile-highlights"</span> nil t)

  (<span style="color: #a020f0;">dolist</span> (hook '(org-mode-hook emacs-lisp-mode-hook emmet-mode-hook))
    (add-hook hook #'volatile-highlights-mode))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"volatile-highlights"</span>
    (set-face-attribute
     'vhl/default-face nil <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #FF3333;">#FF3333</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFCDCD;">#FFCDCD</span><span style="color: #8b2252;">"</span>)
    (volatile-highlights-mode t)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12405;&#12431;&#12387;&#12392;&#12456;&#12501;&#12455;&#12463;&#12488;&#12398;&#36861;&#21152;&#65288;&#12506;&#12540;&#12473;&#12488;&#26178;&#12398;&#33394; =&gt; &#12459;&#12540;&#12477;&#12523;&#33394; =&gt; &#26412;&#26469;&#33394;&#65289;</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-vhl-change-color</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">let</span>
          ((next 0.2)
           (reset 0.5)
           (colors '(<span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #F8D3D7;">#F8D3D7</span><span style="color: #8b2252;">"</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #F2DAE1;">#F2DAE1</span><span style="color: #8b2252;">"</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #EBE0EB;">#EBE0EB</span><span style="color: #8b2252;">"</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #E5E7F5;">#E5E7F5</span><span style="color: #8b2252;">"</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #DEEDFF;">#DEEDFF</span><span style="color: #8b2252;">"</span>)))
        (<span style="color: #a020f0;">dolist</span> (color colors)
          (run-at-time next nil
                       'set-face-attribute
                       'vhl/default-face
                       nil <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #FF3333;">#FF3333</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:background</span> color)
          (<span style="color: #a020f0;">setq</span> next (+ 0.05 next)))
        (run-at-time reset nil 'vhl/clear-all))
      (set-face-attribute 'vhl/default-face
                          nil <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #FF3333;">#FF3333</span><span style="color: #8b2252;">"</span>
                          <span style="color: #483d8b;">:background</span> <span style="color: #8b2252;">"</span><span style="color: #000000; background-color: #FFCDCD;">#FFCDCD</span><span style="color: #8b2252;">"</span>))

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-yank</span> (<span style="color: #228b22;">&amp;optional</span> ARG)
      (<span style="color: #a020f0;">interactive</span>)
      (yank ARG)
      (<span style="color: #a020f0;">when</span> window-system
        (my-vhl-change-color)))
    (global-set-key (kbd <span style="color: #8b2252;">"M-v"</span>) 'my-yank)
    (global-set-key (kbd <span style="color: #8b2252;">"C-y"</span>) 'my-yank)

    (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
      (define-key org-mode-map (kbd <span style="color: #8b2252;">"C-y"</span>) 'my-org-yank)
      (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-org-yank</span> ()
        (<span style="color: #a020f0;">interactive</span>)
        (org-yank)
        (<span style="color: #a020f0;">when</span> window-system
          (my-vhl-change-color))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org555cc70" class="outline-3">
<h3 id="org555cc70"><span class="section-number-3">12.14</span> [edit-color-stamp] Qt経由でカラーピッカーを使う</h3>
<div class="outline-text-3" id="text-12-14">
<ul class="org-ul">
<li><a href="https://github.com/sabof/edit-color-stamp">sabof/edit-color-stamp: Edit hex color stamps using a QT, or the internal color picker</a><br /></li>

<li>Macintosh でもちゃんと使えます．<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (executable-find <span style="color: #8b2252;">"qt_color_picker"</span>)
           (autoload-if-found
            '(edit-color-stamp)
            <span style="color: #8b2252;">"edit-color-stamp"</span> nil t))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-c f c p"</span>) 'edit-color-stamp)))
</pre>
</div>

<p>
（設定手順）<br />
</p>
<ul class="org-ul">
<li>QT をインストールして， <code>qmake</code> に <code>PATH</code> を通す（例：/usr/local/opt/qt/bin）<br /></li>
<li><code>edit-color-stamp</code> を入手してインストール先のフォルダに移動<br /></li>
<li>さらに， <code>qt_color_picker</code> ディレクトリに移動<br /></li>
<li><p>
<code>qt_color_picker.pro</code> を編集して， "QT +=" に "widgets" を追加して保存する．<br />
</p>
<div class="org-src-container">
<pre class="src src-conf"><span style="color: #a0522d;">QT +</span>= core gui widgets
</pre>
</div></li>
<li><code>qmake qt_color_picker.pro &amp;&amp; make</code> を実行<br /></li>
<li>出来上がった <code>qt_color_picker.app</code> を <code>/Applications/</code> にコピー（移動）<br /></li>
<li><p>
<code>exec-path</code> にパスを通す<br />
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-to-list 'exec-path <span style="color: #8b2252;">"/Applications/qt_color_picker.app/Contents/MacOS/"</span>)
</pre>
</div></li>
<li><code>(executable-find "qt_color_picker")</code> でプログラムを呼べることを確認<br /></li>
<li><code>#FFFFFF</code> などの色の上で <code>M-x edit-color-stamp</code> を実行する<br /></li>
<li>カラーピッカーで色を選んで「OK」すれば， <code>#FFFFFF</code> が更新される．<br /></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org1501fe8" class="outline-2">
<h2 id="org1501fe8"><span class="section-number-2">13</span> ユーティリティ関数</h2>
<div class="outline-text-2" id="text-13">
</div>
<div id="outline-container-org368ecca" class="outline-3">
<h3 id="org368ecca"><span class="section-number-3">13.1</span> [pomodoro.el] ポモドーロの実践</h3>
<div class="outline-text-3" id="text-13-1">
<p>
<a href="https://twitter.com/syohex">@syohex</a> さん謹製の <a href="https://github.com/syohex/emacs-utils/blob/master/pomodoro.el">pomodoro.el</a> に少しカスタマイズしたおれおれ <a href="https://github.com/takaxp/emacs-utils/blob/master/pomodoro.el">pomodoro.el</a> を使っています．以下のように設定すると，ポモドーロの残り時間は表示せず，アイコンだけをモードラインに表示できます．残り時間は <code>M-x pomodoro:mode-line-time-display-toggle</code> すれば，いつでも表示できます．<br />
</p>

<p>
<code>pomodoro:finish-work-hook</code> ， <code>pomodoro:finish-rest-hook</code> ， <code>pomodoro:long-rest-hook</code> にそれぞれ結びつけてあるのは，<a href="http://www.mactechlab.jp/products-report/16673.html">Macのスピーチ機能</a>です．この例では，Kyoko さんが指示を出してくれます．<br />
</p>

<p>
<code>M-x pomodoro:start</code> すると，ポモドーロが始まり，8時間後に <code>pomodoro:stop</code> が呼ばれてポモドーロが終了します．<a href="http://www.pomodorotechnique.com/">pomodoro</a> は機械的に仕事をしたい人にピッタリです．人によっては <a href="http://ja.wikipedia.org/wiki/Getting_Things_Done">GTD</a> よりも取っ付きやすいと思います．<br />
</p>

<p>
なお，Org Mode と組み合わせたい場合は，通知を <code>org-clock-in</code> と <code>org-clock-out</code> に連動させる <a href="https://github.com/lolownia/org-pomodoro">org-pomodoro.el</a> があります．<br />
</p>

<p>
<code>postpone</code> の後に呼んでいるのは，Emacs起動時の単純な高速化対策です．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(pomodoro:start)
       <span style="color: #8b2252;">"pomodoro"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (<span style="color: #a020f0;">when</span> (<span style="color: #a020f0;">and</span> (not batch-build)
               (not (boundp 'pomodoro:timer)))
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#37325;&#35079;&#36215;&#21205;&#12434;&#22238;&#36991;</span>
      (pomodoro:start nil)))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"pomodoro"</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20316;&#26989;&#26178;&#38291;&#32066;&#20102;&#24460;&#12395;&#38283;&#12367;&#12501;&#12449;&#12452;&#12523;&#12434;&#25351;&#23450;&#12375;&#12394;&#12356;</span>
    (<span style="color: #a020f0;">setq</span> pomodoro:file nil)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#9679;&#12384;&#12369;&#12391;&#34920;&#29694;&#12377;&#12427;&#65288;&#27531;&#12426;&#26178;&#38291;&#34920;&#31034;&#12394;&#12375;&#65289;</span>
    (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-time-display nil)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#9679;&#12398;&#32622;&#12365;&#25563;&#12360;</span>
    (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-work-sign <span style="color: #8b2252;">"&gt;&gt;"</span>)
    (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-rest-sign <span style="color: #8b2252;">"&lt;&lt;"</span>)
    (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-long-rest-sign <span style="color: #8b2252;">"&lt;&gt;"</span>)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#38263;&#12356;&#20241;&#25001;&#12395;&#20837;&#12427;&#12414;&#12391;&#12395;&#12509;&#12514;&#12489;&#12540;&#12525;&#12377;&#12427;&#22238;&#25968;</span>
    (<span style="color: #a020f0;">setq</span> pomodoro:iteration-for-long-rest 4)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20316;&#26989;&#26178;&#38291;&#38306;&#36899;</span>
    (<span style="color: #a020f0;">setq</span> pomodoro:work-time 25     <span style="color: #b22222;">; </span><span style="color: #b22222;">&#20316;&#26989;&#26178;&#38291;</span>
          pomodoro:rest-time 5      <span style="color: #b22222;">; </span><span style="color: #b22222;">&#20241;&#25001;&#26178;&#38291;</span>
          pomodoro:long-rest-time 30 <span style="color: #b22222;">; </span><span style="color: #b22222;">&#38263;&#12356;&#20241;&#25001;&#26178;&#38291;</span>
          pomodoro:max-iteration 16) <span style="color: #b22222;">; </span><span style="color: #b22222;">&#12509;&#12514;&#12489;&#12540;&#12525;&#12377;&#12427;&#22238;&#25968;</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12479;&#12452;&#12510;&#12540;&#12398;&#34920;&#31034;&#12434;&#12494;&#12540;&#12510;&#12523;&#12501;&#12455;&#12452;&#12473;&#12395;&#12377;&#12427;</span>
    (set-face-bold-p 'pomodoro:timer-face nil)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#20316;&#26989;&#20013;&#65288;&#36196;&#65289;&#65292;&#20241;&#25001;&#20013;&#65288;&#38738;&#65289;&#65292;&#38263;&#12356;&#20241;&#25001;&#20013;&#65288;&#32209;&#65289;&#12395;&#12377;&#12427;</span>
    (custom-set-faces
     '(pomodoro:work-face
       ((((background dark)) <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #DB4C46;">#DB4C46</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:bold</span> t)
        (t (<span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #A130C4;">#A130C4</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:bold</span> t)))) <span style="color: #b22222;">;; </span><span style="color: #ffffff; background-color: #8248c4;">#8248c4</span><span style="color: #b22222;"> , </span><span style="color: #ffffff; background-color: #956dc4;">#956dc4</span><span style="color: #b22222;">, </span><span style="color: #ffffff; background-color: #9d64c4;">#9d64c4</span>
     '(pomodoro:rest-face
       ((((background dark)) <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #3869FA;">#3869FA</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:bold</span> t)
        (t (<span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #203e6f;">#203e6f</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:bold</span> t))))
     '(pomodoro:long-rest-face
       ((((background dark)) <span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #008890;">#008890</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:bold</span> t)
        (t (<span style="color: #483d8b;">:foreground</span> <span style="color: #8b2252;">"</span><span style="color: #ffffff; background-color: #1c9b08;">#1c9b08</span><span style="color: #8b2252;">"</span> <span style="color: #483d8b;">:bold</span> t))))) <span style="color: #b22222;">;; </span><span style="color: #b22222;">00B800</span>

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-pomodoro-status</span> ()
      <span style="color: #8b2252;">"Show the current `</span><span style="color: #008b8b;">pomodoro</span><span style="color: #8b2252;">' status in minibuffer when focus-in."</span>
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">when</span> pomodoro:timer
        (<span style="color: #a020f0;">let</span> ((message-log-max nil))
          (message
           (format <span style="color: #8b2252;">"[%d/%s] %s to go "</span>
                   pomodoro:work-count
                   pomodoro:max-iteration
                   (pomodoro:time-to-string pomodoro:remainder-seconds))))))
    (add-hook 'focus-in-hook #'my-pomodoro-status)

    (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-pomodoro-speak</span> nil)
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-pomodoro-speak-toggle</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (<span style="color: #a020f0;">setq</span> my-pomodoro-speak (not my-pomodoro-speak)))

    (<span style="color: #a020f0;">when</span> (memq window-system '(mac ns))
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">Mac &#12518;&#12540;&#12470;&#21521;&#12369;&#65294;Kyoko&#12373;&#12435;&#12395;&#25351;&#31034;&#12375;&#12390;&#12418;&#12425;&#12358;</span>
      (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">pomodoro:with-speak</span> nil)
      (<span style="color: #a020f0;">when</span> pomodoro:with-speak
        (add-hook 'pomodoro:finish-work-hook
                  #'(lambda ()
                      (<span style="color: #a020f0;">let</span> ((script
                             (concat <span style="color: #8b2252;">"say -v Kyoko "</span>
                                     (number-to-string
                                      (floor pomodoro:rest-time))
                                     <span style="color: #8b2252;">"&#20998;&#38291;&#65292;&#20241;&#25001;&#12375;&#12429;"</span>)))
                        (<span style="color: #a020f0;">if</span> my-pomodoro-speak
                            (shell-command-to-string script)
                          (message <span style="color: #8b2252;">"%s"</span> script)))))

        (add-hook 'pomodoro:finish-rest-hook
                  #'(lambda ()
                      (<span style="color: #a020f0;">let</span> ((script
                             (concat <span style="color: #8b2252;">"say -v Kyoko "</span>
                                     (number-to-string
                                      (floor pomodoro:work-time))
                                     <span style="color: #8b2252;">"&#20998;&#38291;&#65292;&#20316;&#26989;&#12375;&#12429;"</span>)))
                        (<span style="color: #a020f0;">if</span> my-pomodoro-speak
                            (shell-command-to-string script)
                          (message <span style="color: #8b2252;">"%s"</span> script)))))

        (add-hook 'pomodoro:long-rest-hook
                  #'(lambda ()
                      (<span style="color: #a020f0;">let</span> ((script
                             (concat <span style="color: #8b2252;">"say -v Kyoko &#12371;&#12428;&#12363;&#12425;"</span>
                                     (number-to-string
                                      (floor pomodoro:long-rest-time))
                                     <span style="color: #8b2252;">"&#20998;&#38291;&#12398;&#20241;&#25001;&#12391;&#12377;"</span>)))
                        (<span style="color: #a020f0;">if</span> my-pomodoro-speak
                            (shell-command-to-string script)
                          (message <span style="color: #8b2252;">"%s"</span> script))))))

      (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-pomodoro-notify</span> ()
        (<span style="color: #a020f0;">interactive</span>)
        (my-desktop-notification
         <span style="color: #8b2252;">"Pomodoro"</span>
         (concat <span style="color: #8b2252;">"&#19977;&#19977; &#65421;(*&#65439;&#8711;&#65439;)&#65417;   Go #"</span>
                 (format <span style="color: #8b2252;">"%s"</span> (1+ pomodoro:work-count))) nil <span style="color: #8b2252;">"Glass"</span>))
      (add-hook 'pomodoro:finish-work-hook 'my-pomodoro-notify))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf17469f" class="outline-3">
<h3 id="orgf17469f"><span class="section-number-3">13.2</span> [pomodoro.el] 続・ポモドーロの実践</h3>
<div class="outline-text-3" id="text-13-2">
<p>
さらに，モードラインに出すスタータスを表すサインに動きを付けます．ただ頻繁にモードラインを更新して描画するので，環境によっては動作が重くなるかもしれません．<br />
</p>

<p>
各 interlval の数値を <code>setq</code> で後から変更する場合は，その直後に <code>pomodoro:activate-visual-work-sign</code> もしくは変更する interval に対応する同様の関数を実行してください．モードラインに変更が反映されます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"pomodoro"</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#36861;&#21152;&#23455;&#35013;</span>
  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">pomodoro:update-work-sign-interval</span> 0.17) <span style="color: #b22222;">;; </span><span style="color: #b22222;">work&#29992;&#34920;&#31034;&#38291;&#38548;</span>
  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">pomodoro:update-rest-sign-interval</span> 0.21) <span style="color: #b22222;">;; </span><span style="color: #b22222;">rest&#29992;&#34920;&#31034;&#38291;&#38548;</span>
  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">pomodoro:update-long-rest-sign-interval</span> 0.36) <span style="color: #b22222;">;; </span><span style="color: #b22222;">long-rest&#29992;&#34920;&#31034;&#38291;&#38548;</span>

  (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-work-sign-list
        '(<span style="color: #8b2252;">"/  "</span> <span style="color: #8b2252;">"// "</span> <span style="color: #8b2252;">"///"</span> <span style="color: #8b2252;">" //"</span> <span style="color: #8b2252;">"  /"</span> <span style="color: #8b2252;">"   "</span> <span style="color: #8b2252;">"   "</span>))
  (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-rest-sign-list
        '(<span style="color: #8b2252;">".  "</span> <span style="color: #8b2252;">".. "</span> <span style="color: #8b2252;">"..."</span> <span style="color: #8b2252;">"..:"</span> <span style="color: #8b2252;">".::"</span> <span style="color: #8b2252;">":::"</span> <span style="color: #8b2252;">":::"</span>
          <span style="color: #8b2252;">"::."</span> <span style="color: #8b2252;">":.."</span> <span style="color: #8b2252;">"..."</span> <span style="color: #8b2252;">" .."</span> <span style="color: #8b2252;">"  ."</span> <span style="color: #8b2252;">"   "</span> <span style="color: #8b2252;">"   "</span>
          <span style="color: #8b2252;">",  "</span> <span style="color: #8b2252;">",, "</span> <span style="color: #8b2252;">",,,"</span> <span style="color: #8b2252;">",,;"</span> <span style="color: #8b2252;">",;;"</span> <span style="color: #8b2252;">";;;"</span> <span style="color: #8b2252;">";;;"</span>
          <span style="color: #8b2252;">";;,"</span> <span style="color: #8b2252;">";,,"</span> <span style="color: #8b2252;">",,,"</span> <span style="color: #8b2252;">" ,,"</span> <span style="color: #8b2252;">"  ,"</span> <span style="color: #8b2252;">"   "</span> <span style="color: #8b2252;">"   "</span>))
  (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-long-rest-sign-list
        '(<span style="color: #8b2252;">"   "</span> <span style="color: #8b2252;">" | "</span> <span style="color: #8b2252;">"|||"</span> <span style="color: #8b2252;">"| |"</span> <span style="color: #8b2252;">"   "</span>))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Example.0</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq pomodoro:mode-line-work-sign-list</span>
  <span style="color: #b22222;">;;       </span><span style="color: #b22222;">'("|  " "|| " "|||" " ||" "  |" "   " "   "</span>
  <span style="color: #b22222;">;;         </span><span style="color: #b22222;">"  |" " ||" "|||" "|| " "|  " "   " "   "))</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq pomodoro:mode-line-rest-sign-list</span>
  <span style="color: #b22222;">;;       </span><span style="color: #b22222;">'(".  " ".. " "..." " .." "  ." "   " "   "</span>
  <span style="color: #b22222;">;;         </span><span style="color: #b22222;">"  ." " .." "..." ".. " ".  " "   " "   "))</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq pomodoro:mode-line-long-rest-sign-list</span>
  <span style="color: #b22222;">;;       </span><span style="color: #b22222;">'("   " " | " "|||" "| |" "   "))</span>

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Example.1</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(defvar pomodoro:mode-line-work-sign-list</span>
  <span style="color: #b22222;">;;   </span><span style="color: #b22222;">'("&#9601;" "&#9602;" "&#9603;" "&#9604;" "&#9605;" "&#9606;" "&#9607;" "&#9607;" "&#9606;" "&#9605;" "&#9604;" "&#9603;" "&#9602;" "&#9601;" "&#9601;" ))</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(defvar pomodoro:mode-line-rest-sign-list</span>
  <span style="color: #b22222;">;;   </span><span style="color: #b22222;">pomodoro:mode-line-work-sign-list)</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(defvar pomodoro:mode-line-long-rest-sign-list</span>
  <span style="color: #b22222;">;;   </span><span style="color: #b22222;">pomodoro:mode-line-work-sign-list)</span>

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Example.2</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(defvar pomodoro:mode-line-work-sign-list</span>
  <span style="color: #b22222;">;;   </span><span style="color: #b22222;">'("&gt;   " "&gt;&gt;  " "&gt;&gt;&gt; " "&gt;&gt;&gt;&gt;" " &gt;&gt;&gt;" "  &gt;&gt;" "   &gt;" "    "))</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(defvar pomodoro:mode-line-rest-sign-list</span>
  <span style="color: #b22222;">;;   </span><span style="color: #b22222;">'("   &lt;" "  &lt;&lt;" " &lt;&lt;&lt;" "&lt;&lt;&lt;&lt;" "&lt;&lt;&lt; " "&lt;&lt;  " "&lt;   " "    "))</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(defvar pomodoro:mode-line-long-rest-sign-list</span>
  <span style="color: #b22222;">;;   </span><span style="color: #b22222;">'("  &lt;&gt;  " " &lt;&lt;&gt;&gt; " "&lt;&lt;&lt;&gt;&gt;&gt;" "&lt;&lt;  &gt;&gt;" "&lt;    &gt;" "      "))</span>

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Example.3</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq pomodoro:mode-line-work-sign-list</span>
  <span style="color: #b22222;">;;       </span><span style="color: #b22222;">'("&#9602;&#9601;  &#9601;" "&#9603;&#9602;&#9601;  " "&#9604;&#9603;&#9602;&#9601; " "&#9605;&#9604;&#9603;&#9602;&#9601;" "&#9606;&#9605;&#9604;&#9603;&#9602;" "&#9607;&#9606;&#9605;&#9604;&#9603;" "&#9607;&#9607;&#9606;&#9605;&#9604;" "&#9606;&#9607;&#9607;&#9606;&#9605;"</span>
  <span style="color: #b22222;">;;         </span><span style="color: #b22222;">"&#9605;&#9606;&#9607;&#9607;&#9606;" "&#9604;&#9605;&#9606;&#9607;&#9607;" "&#9603;&#9604;&#9605;&#9606;&#9607;" "&#9602;&#9603;&#9604;&#9605;&#9606;" "&#9601;&#9602;&#9603;&#9604;&#9605;" " &#9601;&#9602;&#9603;&#9604;" "  &#9601;&#9602;&#9603;" "&#9601;  &#9601;&#9602;"))</span>

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">Example.4</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(defvar pomodoro:mode-line-work-sign-list</span>
  <span style="color: #b22222;">;;   </span><span style="color: #b22222;">'("&#9700;&#9698;&#9700; ^-^; &#9698;&#9700;&#9698;"</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"&#9700;&#9698;&#9700; ^-^  &#9698;&#9700;&#9698;"</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"&#9700;&#9698;&#9700; ^-^  &#9698;&#9700;&#9698;"</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"&#9700;&#9698;&#9700; ^-^  &#9698;&#9700;&#9698;"</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"&#9700;&#9698;&#9700; ^-^; &#9698;&#9700;&#9698;"</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"&#9700;&#9698;&#9700; ^-^; &#9698;&#9700;&#9698;"</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"&#9698;&#9700;&#9698;&#9700; ^-^; &#9698;&#9700;"</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"&#9700;&#9698;&#9700;&#9698;&#9700; ^-^; &#9698;"</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"&#9698;&#9700;&#9698;&#9700;&#9698;&#9700; ^-^; "</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">" &#9698;&#9700;&#9698;&#9700;&#9698;&#9700; ^-^;"</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"; &#9698;&#9700;&#9698;&#9700;&#9698;&#9700; ^-^"</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"^; &#9698;&#9700;&#9698;&#9700;&#9698;&#9700; ^-"</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"-^; &#9698;&#9700;&#9698;&#9700;&#9698;&#9700; ^"</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"^-^; &#9698;&#9700;&#9698;&#9700;&#9698;&#9700; "</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">" ^-^; &#9698;&#9700;&#9698;&#9700;&#9698;&#9700;"</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"&#9700; ^-^; &#9698;&#9700;&#9698;&#9700;&#9698;"</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"&#9698;&#9700; ^-^; &#9698;&#9700;&#9698;&#9700;"));</span>

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12383;&#12394;&#12371;&#12405;&#27663;: https://twitter.com/mattn_jp/status/987203614199263233</span>
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">(setq pomodoro:mode-line-work-sign-list</span>
  <span style="color: #b22222;">;;   </span><span style="color: #b22222;">'("(&#180;&#65381;_&#65381;`)&#180;&#65381;_&#65381;`)"</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">" (&#180;&#65381;_&#65381;`)_&#65381;`)  "</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"  (&#180;&#65381;_&#65381;`)`)   "</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"  ((&#180;&#65381;_&#65381;`)    "</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">" (&#180;&#65381;(&#180;&#65381;_&#65381;`)  "</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">" (&#180;&#65381;_(&#180;&#65381;_&#65381;`) "</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"(&#180;&#65381;_&#65381;`)&#180;&#65381;_&#65381;`)"</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">" (&#180;&#65381;_&#65381;`)_&#65381;`)  "</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"  (&#180;&#65381;_&#65381;`)`)   "</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"  (&#180;&#65381;_&#65381;`))    "</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"   ((&#180;&#65381;_&#65381;`)   "</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">"  (&#180;&#65381;(&#180;&#65381;_&#65381;`) "</span>
  <span style="color: #b22222;">;;     </span><span style="color: #b22222;">" (&#180;&#65381;_(&#180;&#65381;_&#65381;`) "));</span>

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#36215;&#21205;&#12501;&#12521;&#12464;</span>
  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">my-pomodoro-visualize</span> t)

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12479;&#12452;&#12510;&#12540;&#12434;&#35352;&#37682;</span>
  (<span style="color: #a020f0;">defvar</span> <span style="color: #a0522d;">pomodoro:update-sign-timer</span> nil)

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#21021;&#26399;&#29366;&#24907;&#12434;&#30331;&#37682;</span>
  (<span style="color: #a020f0;">if</span> my-pomodoro-visualize
      (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-work-sign
            (car pomodoro:mode-line-work-sign-list))
    (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-work-sign <span style="color: #8b2252;">""</span>)
    (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-rest-sign <span style="color: #8b2252;">""</span>)
    (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-long-rest-sign <span style="color: #8b2252;">""</span>))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">utilities</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">pomodoro:list-rotate</span> (sign-list)
    (<span style="color: #a020f0;">if</span> (listp sign-list)
        (append (cdr sign-list)
                (list (car sign-list)))
      sign-list))

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">pomodoro:activate-visual-sign</span> (sign interval)
    (<span style="color: #a020f0;">when</span> (timerp pomodoro:update-sign-timer)
      (cancel-timer pomodoro:update-sign-timer))
    (<span style="color: #a020f0;">setq</span> pomodoro:update-sign-timer
          (run-at-time t interval sign)))

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">pomodoro:visualize-start</span> ()
    (<span style="color: #a020f0;">setq</span> my-pomodoro-visualize t)
    (<span style="color: #a020f0;">cond</span> ((eq pomodoro:current-state 'rest)
           (pomodoro:update-rest-sign)
           (pomodoro:activate-visual-rest-sign))
          ((eq pomodoro:current-state 'long-rest)
           (pomodoro:update-long-rest-sign)
           (pomodoro:activate-visual-long-rest-sign))
          (t
           (pomodoro:update-work-sign)
           (pomodoro:activate-visual-work-sign))))

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">pomodoro:visualize-stop</span> ()
    (<span style="color: #a020f0;">setq</span> my-pomodoro-visualize nil)
    (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-work-sign <span style="color: #8b2252;">""</span>)
    (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-rest-sign <span style="color: #8b2252;">""</span>)
    (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-long-rest-sign <span style="color: #8b2252;">""</span>)
    (force-mode-line-update t)
    (<span style="color: #a020f0;">when</span> (timerp pomodoro:update-sign-timer)
      (cancel-timer pomodoro:update-sign-timer)))

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:pomodoro:start</span> (f <span style="color: #228b22;">&amp;rest</span> minutes)
    <span style="color: #8b2252;">"Extensions to stop pomodoro and timers"</span>
    (<span style="color: #a020f0;">interactive</span> <span style="color: #8b2252;">"P"</span>)
    (pomodoro:visualize-start)
    (apply f minutes))

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:pomodoro:stop</span> (f <span style="color: #228b22;">&amp;rest</span> do-reset)
    <span style="color: #8b2252;">"Extensions to stop pomodoro and timers"</span>
    (<span style="color: #a020f0;">interactive</span>)
    (pomodoro:visualize-stop)
    (apply f do-reset))

  (<span style="color: #a020f0;">when</span> my-pomodoro-visualize
    (advice-add 'pomodoro:start <span style="color: #483d8b;">:around</span> #'advice:pomodoro:start)
    (advice-add 'pomodoro:stop <span style="color: #483d8b;">:around</span> #'advice:pomodoro:stop))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">work</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">pomodoro:update-work-sign</span> ()
    <span style="color: #8b2252;">"Update pomodoro work-sign on modeline."</span>
    (<span style="color: #a020f0;">when</span> my-pomodoro-visualize
      (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-work-sign
            (car pomodoro:mode-line-work-sign-list))
      (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-work-sign-list
            (pomodoro:list-rotate pomodoro:mode-line-work-sign-list))
      (force-mode-line-update t)))

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">pomodoro:activate-visual-work-sign</span> ()
    (pomodoro:activate-visual-sign
     'pomodoro:update-work-sign pomodoro:update-work-sign-interval))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">rest</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">pomodoro:update-rest-sign</span> ()
    <span style="color: #8b2252;">"Update pomodoro rest-sign on modeline."</span>
    (<span style="color: #a020f0;">when</span> my-pomodoro-visualize
      (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-rest-sign
            (car pomodoro:mode-line-rest-sign-list))
      (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-rest-sign-list
            (pomodoro:list-rotate pomodoro:mode-line-rest-sign-list))
      (force-mode-line-update t)))

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">pomodoro:activate-visual-rest-sign</span> ()
    (pomodoro:activate-visual-sign
     'pomodoro:update-rest-sign pomodoro:update-rest-sign-interval))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">long rest</span>
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">pomodoro:update-long-rest-sign</span> ()
    <span style="color: #8b2252;">"Update pomodoro long-rest-sign on modeline."</span>
    (<span style="color: #a020f0;">when</span> my-pomodoro-visualize
      (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-long-rest-sign
            (car pomodoro:mode-line-long-rest-sign-list))
      (<span style="color: #a020f0;">setq</span> pomodoro:mode-line-long-rest-sign-list
            (pomodoro:list-rotate pomodoro:mode-line-long-rest-sign-list))
      (force-mode-line-update t)))

  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">pomodoro:activate-visual-long-rest-sign</span> ()
    (pomodoro:activate-visual-sign
     'pomodoro:update-long-rest-sign pomodoro:update-long-rest-sign-interval))

  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12473;&#12486;&#12540;&#12479;&#12473;&#12364;&#20999;&#12426;&#26367;&#12431;&#12427;&#26178;&#12395;&#34920;&#31034;&#12434;&#20837;&#12428;&#26367;&#12360;&#12427;</span>
  (<span style="color: #a020f0;">when</span> my-pomodoro-visualize
    (add-hook 'pomodoro:finish-rest-hook #'pomodoro:activate-visual-work-sign)
    (add-hook 'pomodoro:finish-work-hook #'pomodoro:activate-visual-rest-sign)
    (add-hook 'pomodoro:long-rest-hook
              #'pomodoro:activate-visual-long-rest-sign)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org6b90b6a" class="outline-3">
<h3 id="org6b90b6a"><span class="section-number-3">13.3</span> [google-this.el] 単語をグーグル検索</h3>
<div class="outline-text-3" id="text-13-3">
<p>
カーソル下の単語を検索して，結果をブラウザで受け取ります． <code>google-this</code> を直接呼ぶと検索確認を聞かれるので，すぐに検索するようにカスタマイズします． <code>M-x google-this-word</code> を使うのも手ですが，ハイフンで連結された文字列を拾えないので好みがわかれます．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(my-google-this google-this google-this-word)
       <span style="color: #8b2252;">"google-this"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-c f g"</span>) 'my-google-this))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"google-this"</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-google-this</span> ()
      (<span style="color: #a020f0;">interactive</span>)
      (google-this (current-word) t))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org2b2ebe4" class="outline-3">
<h3 id="org2b2ebe4"><span class="section-number-3">13.4</span> [lingr.el] チャットルームに参加</h3>
<div class="outline-text-3" id="text-13-4">
<p>
init.el読書会が毎週土曜日の22時に開催されています．作業に集中していると，ついつい忘れてしまうので，その時間が来たら自動的にログインするように設定しています．ユーザ名とパスワードは，セキュリティを考慮して別なファイルに記載しています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(lingr-login my-lingr-login)
       <span style="color: #8b2252;">"lingr"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"lingr"</span>
    (custom-set-variables
     '(lingr-icon-mode t)
     '(lingr-icon-fix-size 24)
     '(lingr-image-convert-program  (<span style="color: #a020f0;">or</span> (executable-find <span style="color: #8b2252;">"convert"</span>)
                                        lingr-image-convert-program)))))

(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(my-lingr-login)
       <span style="color: #8b2252;">"utility"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (<span style="color: #a020f0;">unless</span> (passed-clock-p <span style="color: #8b2252;">"23:00"</span>)
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">do not use `</span><span style="color: #008b8b;">run-at-time</span><span style="color: #b22222;">' at booting since diary-lib.el</span>
      <span style="color: #b22222;">;; </span><span style="color: #b22222;">will be loaded. It requires loading cost.</span>
      (run-at-time <span style="color: #8b2252;">"23:00"</span> nil 'my-lingr-login))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org447a237" class="outline-3">
<h3 id="org447a237"><span class="section-number-3">13.5</span> [osx-lib.el] OSX用ユーティリティ&#xa0;&#xa0;&#xa0;<span class="tag"><span class="Mac">Mac</span></span></h3>
<div class="outline-text-3" id="text-13-5">
<ul class="org-ul">
<li><a href="https://github.com/raghavgautam/osx-lib">raghavgautam/osx-lib</a><br /></li>
<li>OSXの機能を呼び出すためのツール集<br /></li>
<li><code>osx-lib-say-region</code> を呼び出せば，選択領域を機械音で発声させられます．<br /></li>
<li><code>selected.el</code> と組み合わせると選択後にシングルキーで実施できるのでさらに便利です．<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(osx-lib-say osx-lib-say-region)
       <span style="color: #8b2252;">"osx-lib"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"osx-lib"</span>
    (custom-set-variables
     '(osx-lib-say-ratio 100)
     '(osx-lib-say-voice <span style="color: #8b2252;">"Samantha"</span>))))
</pre>
</div>

<p>
例えば，カエルの歌の輪唱ができます．以下のソースブロックで <code>C-c C-c</code> を適切なタイミングで押してみてください．<br />
</p>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #b22222;">#+BEGIN_SRC emacs-lisp :results silent</span>
<span style="color: #7f7f7f;">(</span><span style="color: #a020f0;">setq</span><span style="color: #7f7f7f;"> osx-lib-say-voice </span><span style="color: #8b2252;">"Kyoko"</span><span style="color: #7f7f7f;">) </span><span style="color: #b22222;">;; </span><span style="color: #b22222;">Samantha</span>
<span style="color: #7f7f7f;">(</span><span style="color: #a020f0;">setq</span><span style="color: #7f7f7f;"> osx-lib-say-rate 90) </span><span style="color: #b22222;">;; </span><span style="color: #b22222;">min 90 for Samantha</span>
<span style="color: #7f7f7f;">(</span><span style="color: #a020f0;">setq</span><span style="color: #7f7f7f;"> yourscript </span><span style="color: #8b2252;">"&#12363;&#12360;&#12427;&#12398;&#12358;&#12383;&#12364;</span><span style="color: #8b2252; background-color: #bebebe; font-weight: bold; text-decoration: underline;">&#12288;&#12288;&#12288;&#12288;</span><span style="color: #8b2252;">&#12365;&#12371;&#12360;&#12390;&#12367;&#12427;&#12424;</span><span style="color: #8b2252; background-color: #bebebe; font-weight: bold; text-decoration: underline;">&#12288;&#12288;</span><span style="color: #8b2252;">&#12463;&#12449;</span><span style="color: #8b2252; background-color: #bebebe; font-weight: bold; text-decoration: underline;">&#12288;</span><span style="color: #8b2252;">&#12463;&#12449;</span><span style="color: #8b2252; background-color: #bebebe; font-weight: bold; text-decoration: underline;">&#12288;</span><span style="color: #8b2252;">&#12463;&#12449;</span><span style="color: #8b2252; background-color: #bebebe; font-weight: bold; text-decoration: underline;">&#12288;</span><span style="color: #8b2252;">&#12463;&#12449;</span><span style="color: #8b2252; background-color: #bebebe; font-weight: bold; text-decoration: underline;">&#12288;</span><span style="color: #8b2252;">&#12465;&#12465;&#12465;&#12465;</span><span style="color: #8b2252; background-color: #bebebe; font-weight: bold; text-decoration: underline;">&#12288;</span><span style="color: #8b2252;">&#12465;&#12465;&#12465;&#12465;</span><span style="color: #8b2252; background-color: #bebebe; font-weight: bold; text-decoration: underline;">&#12288;</span><span style="color: #8b2252;">&#12463;&#12449;</span><span style="color: #8b2252; background-color: #bebebe; font-weight: bold; text-decoration: underline;">&#12288;</span><span style="color: #8b2252;">&#12463;&#12449;</span><span style="color: #8b2252; background-color: #bebebe; font-weight: bold; text-decoration: underline;">&#12288;</span><span style="color: #8b2252;">&#12463;&#12449;"</span><span style="color: #7f7f7f;">)</span>
<span style="color: #7f7f7f;">(osx-lib-say yourscript)</span>
<span style="color: #b22222;">#+END_SRC</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgff6915d" class="outline-3">
<h3 id="orgff6915d"><span class="section-number-3">13.6</span> <span class="todo TODO">TODO</span> [password-store.el] パスワード管理</h3>
<div class="outline-text-3" id="text-13-6">
<ul class="org-ul">
<li><a href="http://h12.me/article/password-management">http://h12.me/article/password-management</a><br /></li>
<li><a href="http://www.tricksofthetrades.net/2015/07/04/notes-pass-unix-password-manager/">http://www.tricksofthetrades.net/2015/07/04/notes-pass-unix-password-manager/</a><br /></li>
<li>Add no-tty into ~/.gnupg/gpg.conf if an error occurred.<br /></li>
<li>システムで <code>pass</code> コマンドを使えることが条件<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">if</span> (executable-find <span style="color: #8b2252;">"pass"</span>)
    (<span style="color: #a020f0;">when</span> (autoload-if-found
           '(helm-pass)
           <span style="color: #8b2252;">"helm-pass"</span> nil t)
      (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
        (global-set-key (kbd <span style="color: #8b2252;">"C-c f p"</span>) 'helm-pass)))
  (message <span style="color: #8b2252;">"--- pass is NOT installed."</span>))
</pre>
</div>

<p>
もしくは， <code>id-manager.el</code> もパスワード管理に利用できる．こちらは特定のコマンドがシステムにインストールされていなくても動く．<br />
</p>

<ul class="org-ul">
<li>The encrypted file is stored as ~/.idm-db.gpg.<br /></li>
<li><a href="http://d.hatena.ne.jp/kiwanami/20110221/1298293727">http://d.hatena.ne.jp/kiwanami/20110221/1298293727</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(id-manager)
       <span style="color: #8b2252;">"id-manager"</span> nil t)
  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"id-manager"</span>
    (setenv <span style="color: #8b2252;">"GPG_AGENT_INFO"</span> nil)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org1f55dae" class="outline-3">
<h3 id="org1f55dae"><span class="section-number-3">13.7</span> [multi-term.el] ターミナル</h3>
<div class="outline-text-3" id="text-13-7">
<p>
たまに使いたくなるので一応．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(multi-term)
       <span style="color: #8b2252;">"multi-term"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"multi-term"</span>
    (setenv <span style="color: #8b2252;">"HOSTTYPE"</span> <span style="color: #8b2252;">"intel-mac"</span>)
    (my-night-theme)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5ac32ea" class="outline-3">
<h3 id="org5ac32ea"><span class="section-number-3">13.8</span> iterm2 を Emacs から呼び出したい&#xa0;&#xa0;&#xa0;<span class="tag"><span class="Mac">Mac</span></span></h3>
<div class="outline-text-3" id="text-13-8">
<p>
<code>C-M-i</code> を iterm2.app の呼び出しに割り当てます．シェルでの作業はどうも <code>eshell</code> では満足できないので．なお flyspell を使っていると，遅延呼び出しした後にキーバインドを奪われるので，取り返します．<br />
</p>

<p>
<code>cmd-to-open-iterm2</code> の実装は，<a href="./utility.el">./utility.el</a> にあります．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(my-cmd-to-open-iterm2)
       <span style="color: #8b2252;">"utility"</span> nil t)
  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-M-i"</span>) #'my-cmd-to-open-iterm2))
  <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#12461;&#12540;&#12496;&#12452;&#12531;&#12489;&#12398;&#20877;&#35373;&#23450;</span>
  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"flyspell"</span>
    (define-key flyspell-mode-map (kbd <span style="color: #8b2252;">"C-M-i"</span>) #'my-cmd-to-open-iterm2))
  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"org"</span>
    (define-key org-mode-map (kbd <span style="color: #8b2252;">"C-M-i"</span>) #'my-cmd-to-open-iterm2)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga211889" class="outline-3">
<h3 id="orga211889"><span class="section-number-3">13.9</span> カレントバッファのあるディレクトリをターミナルで表示</h3>
<div class="outline-text-3" id="text-13-9">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
  (global-set-key (kbd <span style="color: #8b2252;">"C-c f t"</span>) 'open-current-directory-in-terminal))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgee33500" class="outline-3">
<h3 id="orgee33500"><span class="section-number-3">13.10</span> [postpone.el] Emacs起動してから使い始めるタイミングで実行する</h3>
<div class="outline-text-3" id="text-13-10">
<p>
<code>helm-config</code> に紐付けていた遅延呼び出し関数および設定を，自作の <code>postpone.el</code> に紐付けました． <code>helm-config</code> に紐付けていた時は， <code>M-x</code> を使う時にだけ複数の設定が読み込まれましたが，今回の設定では，Emacs起動後の最初のアクション時に読み込まれます（一部のコマンドを除く）．これには <code>M-x</code> も含まれます．この <code>init.el</code> に記載された遅延読み込みは約660[ms]にも及びます．通常起動では約400[ms]を要している（コンソール起動の場合は，約100[ms]）ので，もし遅延読み込みしなければ，Emacsの起動が1秒を超えてしまうことになります．起動後，即座にEmacs終了するシーンでは， <code>postpone.el</code> に紐付けた設定が活性化すると無駄になります．それを回避するために， <code>this-command</code> の値を確認して，条件に合う場合だけ <code>postpone.el</code> が読み込まれる（結果的に紐付いている全ての設定が活性化する）ようにしています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">if</span> (not (locate-library <span style="color: #8b2252;">"postpone"</span>))
    (message <span style="color: #8b2252;">"postpone.el is NOT installed."</span>)
  (autoload 'postpone-kicker <span style="color: #8b2252;">"postpone"</span> nil t)
  (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-postpone-kicker</span> ()
    (<span style="color: #a020f0;">interactive</span>)
    (<span style="color: #a020f0;">unless</span> (memq this-command <span style="color: #b22222;">;; </span><span style="color: #b22222;">specify commands for exclusion</span>
                  '(self-insert-command
                    save-buffers-kill-terminal
                    exit-minibuffer))
      (message <span style="color: #8b2252;">"Starting postpone...done"</span>)
      (postpone-kicker 'my-postpone-kicker)
      (message <span style="color: #8b2252;">"Finishing postpone...done"</span>)))
  (add-hook 'pre-command-hook #'my-postpone-kicker))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc1446e5" class="outline-3">
<h3 id="orgc1446e5"><span class="section-number-3">13.11</span> <span class="todo TODO">TODO</span> [network-watch.el] ネットワークインターフェイスの状態を監視</h3>
<div class="outline-text-3" id="text-13-11">
<ul class="org-ul">
<li>プロキシ内での挙動は不明．<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(network-watch-mode
         network-watch-active-p advice:network-watch-update-lighter)
       <span style="color: #8b2252;">"network-watch"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"network-watch"</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:network-watch-update-lighter</span> ()
      <span style="color: #8b2252;">"Return a mode lighter reflecting the current network state."</span>
      (<span style="color: #a020f0;">unless</span> (network-watch-active-p) <span style="color: #8b2252;">" &#8595;NW&#8595;"</span>))
    (advice-add 'network-watch-update-lighter
                <span style="color: #483d8b;">:override</span> #'advice:network-watch-update-lighter))

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (<span style="color: #a020f0;">unless</span> batch-build
      (postpone-message <span style="color: #8b2252;">"network-watch-mode"</span>)
      (<span style="color: #a020f0;">if</span> shutup-p
          (<span style="color: #a020f0;">shut-up</span> (network-watch-mode 1))
        (network-watch-mode 1)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5baab2b" class="outline-3">
<h3 id="org5baab2b"><span class="section-number-3">13.12</span> [gif-screencast.el] ユーザアクションのたびにスクショを取る</h3>
<div class="outline-text-3" id="text-13-12">
<ul class="org-ul">
<li><a href="https://github.com/Ambrevar/emacs-gif-screencast">Ambrevar/emacs-gif-screencast: One-frame-per-action GIF recording for optimal quality/size ratio</a><br /></li>
<li><del>色々と Linux用に設計・前提とされていて，今のところ Macで使うのはちょっと厳しい．</del><br />
<ul class="org-ul">
<li>macOS用に追加実装しました．<a href="https://github.com/Ambrevar/emacs-gif-screencast/commit/0ab5f3db2ca0679698a297003cb286e727d12c10#diff-825716ca58bd0ebef62b7ed711446577">本家にマージ</a>されています．<br /></li>
<li>スクショ専門ツールもあります．こちらは <code>import</code> コマンドを利用します．<br />
<ul class="org-ul">
<li><a href="https://github.com/tarsius/frameshot">tarsius/frameshot: Take screenshots of a frame</a><br /></li>
</ul></li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(gif-screencast)
       <span style="color: #8b2252;">"gif-screencast"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"gif-screencast"</span>
    (<span style="color: #a020f0;">setq</span> gif-screencast-want-optimized nil)
    (<span style="color: #a020f0;">setq</span> gif-screencast-args '(<span style="color: #8b2252;">"-x"</span>))
    (<span style="color: #a020f0;">setq</span> gif-screencast-capture-format <span style="color: #8b2252;">"ppm"</span>)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">Start... M-x gif-screencast</span>
    (define-key gif-screencast-mode-map (kbd <span style="color: #8b2252;">"&lt;f5&gt;"</span>) 'gif-screencast-stop)
    (define-key gif-screencast-mode-map (kbd <span style="color: #8b2252;">"S-&lt;f5&gt;"</span>)
      'gif-screencast-toggle-pause)

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">&#25313;&#24373;</span>
    (<span style="color: #a020f0;">defcustom</span> <span style="color: #a0522d;">gif-screencast-additional-normal-hooks</span> '()
      <span style="color: #8b2252;">"A list of hooks. These hooks activate `</span><span style="color: #008b8b;">gif-screencast-capture</span><span style="color: #8b2252;">'."</span>
      <span style="color: #483d8b;">:group</span> 'gif-screencast
      <span style="color: #483d8b;">:type</span> '(repeat hook))

    (add-to-list 'gif-screencast-additional-normal-hooks
                 'window-size-change-functions) <span style="color: #b22222;">;; </span><span style="color: #b22222;">for which-key.el, as of 26.1</span>
    (add-to-list 'gif-screencast-additional-normal-hooks
                 'window-configuration-change-hook) <span style="color: #b22222;">;; </span><span style="color: #b22222;">for which-key.el</span>
    (add-to-list 'gif-screencast-additional-normal-hooks 'focus-in-hook)
    (add-to-list 'gif-screencast-additional-normal-hooks 'focus-out-hook)
    (add-to-list 'gif-screencast-additional-normal-hooks 'minibuffer-setup-hook)
    (add-to-list 'gif-screencast-additional-normal-hooks 'minibuffer-exit-hook)
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">(add-to-list 'gif-screencast-additional-normal-hooks 'pre-redisplay-functions)</span>
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">pre-redisplay-functions &#12399;&#12420;&#12400;&#12356;&#65294;</span>

    <span style="color: #b22222;">;; </span><span style="color: #b22222;">modification-hooks</span>
    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:gif-screencast</span> ()
      (<span style="color: #a020f0;">dolist</span> (hook gif-screencast-additional-normal-hooks)
        (add-hook hook 'gif-screencast-capture)))
    (advice-add 'gif-screencast <span style="color: #483d8b;">:after</span> #'advice:gif-screencast)

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:gif-screencast-stop</span> ()
      (<span style="color: #a020f0;">dolist</span> (hook gif-screencast-additional-normal-hooks)
        (remove-hook hook 'gif-screencast-capture)))
    (advice-add 'gif-screencast-stop <span style="color: #483d8b;">:after</span> #'advice:gif-screencast-stop)

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:gif-screencast-toggle-pause</span> ()
      (<span style="color: #a020f0;">if</span> (memq 'gif-screencast-capture (default-value 'pre-command-hook))
          (<span style="color: #a020f0;">dolist</span> (hook gif-screencast-additional-normal-hooks)
            (remove-hook hook 'gif-screencast-capture))
        (<span style="color: #a020f0;">dolist</span> (hook gif-screencast-additional-normal-hooks)
          (add-hook hook 'gif-screencast-capture))))
    (advice-add 'gif-screencast-toggle-pause
                <span style="color: #483d8b;">:before</span> #'advice:gif-screencast-toggle-pause)

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">advice:gif-screencast-opendir</span> ()
      <span style="color: #8b2252;">"Open the output directory when screencast is finished."</span>
      (<span style="color: #a020f0;">if</span> (not (eq system-type 'darwin))
          (my-gif-screencast-opendir-dired)
        (shell-command-to-string
         (concat <span style="color: #8b2252;">"open "</span> gif-screencast-screenshot-directory))
        (shell-command-to-string
         (concat <span style="color: #8b2252;">"open "</span> gif-screencast-output-directory))))
    (advice-add 'gif-screencast-stop <span style="color: #483d8b;">:before</span> #'advice:gif-screencast-opendir)

    (<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">my-gif-screencast-opendir-dired</span> ()
      <span style="color: #8b2252;">"Open directories for screenshots and generated GIFs by Dired."</span>
      (<span style="color: #a020f0;">interactive</span>)
      (dired gif-screencast-output-directory)
      (dired gif-screencast-screenshot-directory))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgeee9330" class="outline-3">
<h3 id="orgeee9330"><span class="section-number-3">13.13</span> <span class="todo TODO">TODO</span> [manage-minor-mode.el] マイナーモードの視覚的な管理</h3>
<div class="outline-text-3" id="text-13-13">
<ul class="org-ul">
<li><a href="http://fukuyama.co/manage-minor-mode">minor-modeを簡単に切り替える manage-minor-mode.el Emacs Lisp - Web学び</a><br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">when</span> (autoload-if-found
       '(manage-minor-mode)
       <span style="color: #8b2252;">"manage-minor-mode"</span> nil t)

  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"manage-minor-mode"</span>
    (define-key manage-minor-mode-map (kbd <span style="color: #8b2252;">"q"</span>)
      #'(lambda () (<span style="color: #a020f0;">interactive</span>)
          (delete-window (get-buffer-window <span style="color: #8b2252;">"*manage-minor-mode*"</span>))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf6662c5" class="outline-3">
<h3 id="orgf6662c5"><span class="section-number-3">13.14</span> [utility.el] 自作してテスト中の便利関数群</h3>
<div class="outline-text-3" id="text-13-14">
<p>
関数定義を<a href="https://pxaka.tokyo/wiki/doku.php?id=emacs:utility.el">別ファイル</a>に分離して，Emacs起動の高速化を図っています．各関数を autoload の管理下において，必要なときにロードするように設定しています．<br />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defconst</span> <span style="color: #a0522d;">utility-autoloads</span>
  '(my-date
    my-window-resizer my-cycle-bullet-at-heading my-open-file-ring
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">selected</span>
    my-org-list-insert-items
    my-org-list-insert-checkbox-into-items
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">M-x</span>
    eval-org-buffer
    my-org-list-delete-items
    my-org-list-delete-items-with-checkbox
    my-org-list-insert-itms-with-checkbox
    my-org-list-delete-checkbox-from-items
    <span style="color: #b22222;">;; </span><span style="color: #b22222;">others</span>
    kyoko-mad-mode-toggle mac:delete-files-in-trash-bin
    org2dokuwiki-cp-kill-ring open-current-directory
    reload-ical-export show-org-buffer get-random-string init-auto-install
    add-itemize-head add-itemize-head-checkbox insert-formatted-current-date
    insert-formatted-current-time insert-formatted-signature
    export-timeline-business export-timeline-private chomp
    count-words-buffer do-test-applescript
    delete-backup-files recursive-delete-backup-files describe-timer
    my-browse-url-chrome my-list-packages my-setup-cask))

(<span style="color: #a020f0;">when</span> (autoload-if-found
       utility-autoloads
       <span style="color: #8b2252;">"utility"</span> nil t)
  (<span style="color: #a020f0;">with-eval-after-load</span> <span style="color: #8b2252;">"postpone"</span>
    (global-set-key (kbd <span style="color: #8b2252;">"C-M--"</span>) 'my-cycle-bullet-at-heading)
    (global-set-key (kbd <span style="color: #8b2252;">"&lt;f12&gt;"</span>) 'my-open-file-ring)
    (global-set-key (kbd <span style="color: #8b2252;">"C-c t"</span>) 'my-date)
    (global-set-key (kbd <span style="color: #8b2252;">"C-c f 4"</span>) 'my-window-resizer)))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org8bf3075" class="outline-2">
<h2 id="org8bf3075"><span class="section-number-2">14</span> おわりに</h2>
<div class="outline-text-2" id="text-14">
<p>
以上が，私の <code>init.el</code> とその説明です．<br />
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Takaaki Ishikawa</p>
<p class="date">Created: 2018-09-10 Mon 15:04</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
